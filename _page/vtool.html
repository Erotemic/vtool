

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>vtool package &mdash; vtool 1.0.1.dev1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="vtool 1.0.1.dev1 documentation" href="index.html"/>
        <link rel="next" title="vtool.tests package" href="vtool.tests.html"/>
        <link rel="prev" title="Welcome to vtool’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> vtool
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">vtool package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vtool.tests.html">vtool.tests package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.__main__">vtool.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vtool-grave-module">vtool._grave module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.blend">vtool.blend module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.chip">vtool.chip module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.clustering">vtool.clustering module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.clustering2">vtool.clustering2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.confusion">vtool.confusion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.constrained_matching">vtool.constrained_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_grid">vtool.coverage_grid module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_kpts">vtool.coverage_kpts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.depricated">vtool.depricated module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.distance">vtool.distance module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.ellipse">vtool.ellipse module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.exif">vtool.exif module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.features">vtool.features module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.geometry">vtool.geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.histogram">vtool.histogram module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image">vtool.image module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image_filters">vtool.image_filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.keypoint">vtool.keypoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.linalg">vtool.linalg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.matching">vtool.matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.math">vtool.math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.nearest_neighbors">vtool.nearest_neighbors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.other">vtool.other module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.patch">vtool.patch module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.quality_classifier">vtool.quality_classifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.score_normalization">vtool.score_normalization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.segmentation">vtool.segmentation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.spatial_verification">vtool.spatial_verification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.sver_c_wrapper">vtool.sver_c_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.symbolic">vtool.symbolic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.test_constrained_matching">vtool.test_constrained_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.trig">vtool.trig module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">vtool</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>vtool package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/vtool.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vtool-package">
<h1>vtool package<a class="headerlink" href="#vtool-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="vtool.tests.html">vtool.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests._olddep_test_exhaustive_ori_extract">vtool.tests._olddep_test_exhaustive_ori_extract module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.dummy">vtool.tests.dummy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.grabdata">vtool.tests.grabdata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.run_tests">vtool.tests.run_tests module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_akmeans">vtool.tests.test_akmeans module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_coverage_max_reduce">vtool.tests.test_coverage_max_reduce module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_draw_keypoint">vtool.tests.test_draw_keypoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_pyflann">vtool.tests.test_pyflann module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_spatial_verification">vtool.tests.test_spatial_verification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_vtool">vtool.tests.test_vtool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.testdata_nondeterm_sver">vtool.tests.testdata_nondeterm_sver module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.time_cythonized_funcs">vtool.tests.time_cythonized_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool.__main__">
<span id="vtool-main-module"></span><h2>vtool.__main__ module<a class="headerlink" href="#module-vtool.__main__" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.__main__.vtool_main">
<code class="descclassname">vtool.__main__.</code><code class="descname">vtool_main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/__main__.html#vtool_main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.__main__.vtool_main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="vtool-grave-module">
<h2>vtool._grave module<a class="headerlink" href="#vtool-grave-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool.blend">
<span id="vtool-blend-module"></span><h2>vtool.blend module<a class="headerlink" href="#module-vtool.blend" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.blend.blend_images">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>mode='average'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_average">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_average</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_average" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>img2</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>alpha</strong> (<em>float</em>) &#8211; (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.blend --test-blend_images_average:0 --show
python -m vtool.blend --test-blend_images_average:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_mult_average">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_mult_average</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_mult_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_mult_average" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>img2</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>alpha</strong> (<em>float</em>) &#8211; (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.blend --test-blend_images_mult_average:0 --show
python -m vtool.blend --test-blend_images_mult_average:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_mult_average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.blend_images_multiply">
<code class="descclassname">vtool.blend.</code><code class="descname">blend_images_multiply</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#blend_images_multiply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.blend_images_multiply" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>img2</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>alpha</strong> (<em>float</em>) &#8211; (default = 0.5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgB</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Blend_modes">https://en.wikipedia.org/wiki/Blend_modes</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.blend --test-blend_images_multiply:0 --show
python -m vtool.blend --test-blend_images_multiply:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">blend_images_multiply</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">blend_images_multiply</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">testdata_blend</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s">&#39;alpha=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.gamma_adjust">
<code class="descclassname">vtool.blend.</code><code class="descname">gamma_adjust</code><span class="sig-paren">(</span><em>img</em>, <em>gamma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gamma_adjust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.gamma_adjust" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.blend --test-gamma_adjust:0 --show
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_func</span> <span class="o">=</span> <span class="n">gamma_adjust</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rectify_to_float01</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_info</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfoList</span><span class="p">(</span><span class="s">&#39;blend_params&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="n">ut</span><span class="o">.</span><span class="n">ParamInfo</span><span class="p">(</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="s">&#39;gamma=&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">varyvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_image_function</span><span class="p">(</span><span class="n">param_info</span><span class="p">,</span> <span class="n">test_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.gridsearch_addWeighted">
<code class="descclassname">vtool.blend.</code><code class="descname">gridsearch_addWeighted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_addWeighted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.gridsearch_addWeighted" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.blend --test-gridsearch_addWeighted --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.blend</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_addWeighted</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.gridsearch_image_function">
<code class="descclassname">vtool.blend.</code><code class="descname">gridsearch_image_function</code><span class="sig-paren">(</span><em>param_info</em>, <em>test_func</em>, <em>args=()</em>, <em>show_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#gridsearch_image_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.gridsearch_image_function" title="Permalink to this definition">¶</a></dt>
<dd><p>gridsearch for a function that produces a single image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.blend.testdata_blend">
<code class="descclassname">vtool.blend.</code><code class="descname">testdata_blend</code><span class="sig-paren">(</span><em>scale=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/blend.html#testdata_blend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.blend.testdata_blend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.chip">
<span id="vtool-chip-module"></span><h2>vtool.chip module<a class="headerlink" href="#module-vtool.chip" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.chip.apply_filter_funcs">
<code class="descclassname">vtool.chip.</code><code class="descname">apply_filter_funcs</code><span class="sig-paren">(</span><em>chipBGR</em>, <em>filter_funcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#apply_filter_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.apply_filter_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>applies a list of preprocessing filters to a chip</p>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.compute_chip">
<code class="descclassname">vtool.chip.</code><code class="descname">compute_chip</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>filter_list=[]</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#compute_chip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.compute_chip" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a chip and applies filters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gfpath</strong> (<em>str</em>) &#8211; image file path string</li>
<li><strong>bbox</strong> (<em>tuple</em>) &#8211; bounding box in the format (x, y, w, h)</li>
<li><strong>theta</strong> (<em>float</em>) &#8211; angle in radians</li>
<li><strong>new_size</strong> (<em>tuple</em>) &#8211; must maintain the same aspect ratio or else you will get weirdness</li>
<li><strong>filter_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chipBGR -  cropped image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.chip --test-compute_chip --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gfpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TAU</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># gfilt_tool.adapteq_fn]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">compute_chip</span><span class="p">(</span><span class="n">gfpath</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">filter_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">draw_verts</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">gfpath</span><span class="p">),</span> <span class="n">vt</span><span class="o">.</span><span class="n">scaled_verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_from_gpath">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_from_gpath</code><span class="sig-paren">(</span><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_gpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_from_gpath_into_square">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_from_gpath_into_square</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_gpath_into_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_gpath_into_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_from_img">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_from_img</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_from_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_from_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops chip from image ; Rotates and scales;</p>
<p>ibs.show_annot_image(aid)[0].pt_save_and_view()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gfpath</strong> (<em>str</em>) &#8211; </li>
<li><strong>bbox</strong> (<em>tuple</em>) &#8211; xywh</li>
<li><strong>theta</strong> (<em>float</em>) &#8211; </li>
<li><strong>new_size</strong> (<em>tuple</em>) &#8211; wy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chipBGR</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.chip --test-extract_chip_from_img
python -m vtool.chip --test-extract_chip_from_img --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipBGR</span> <span class="o">=</span> <span class="n">extract_chip_from_img</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">chipBGR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_size</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;did not resize correctly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">chipBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.extract_chip_into_square">
<code class="descclassname">vtool.chip.</code><code class="descname">extract_chip_into_square</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>bbox</em>, <em>theta</em>, <em>target_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#extract_chip_into_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.extract_chip_into_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.get_filter_list">
<code class="descclassname">vtool.chip.</code><code class="descname">get_filter_list</code><span class="sig-paren">(</span><em>chipcfg_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_filter_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_filter_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.get_image_to_chip_transform">
<code class="descclassname">vtool.chip.</code><code class="descname">get_image_to_chip_transform</code><span class="sig-paren">(</span><em>bbox</em>, <em>chipsz</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_image_to_chip_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_image_to_chip_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms image space into chipspace</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>- bounding box of chip in image space</strong> (<em>bbox</em>) &#8211; </li>
<li><strong>- size of the chip</strong> (<em>chipsz</em>) &#8211; </li>
<li><strong>- rotation of the bounding box</strong> (<em>theta</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first"># <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
from vtool.patch import *  # NOQA
import sympy
import sympy.abc
theta = sympy.abc.theta</p>
<p>x, y, w, h, target_area  = sympy.symbols(&#8216;x y w h, a&#8217;)
gx, gy  = sympy.symbols(&#8216;gx, gy&#8217;)</p>
<p>round = sympy.floor  # hack</p>
<p>ht = sympy.sqrt(target_area * h / w)
wt = w * ht / h
<a href="#id13"><span class="problematic" id="id14">cw_</span></a>, <a href="#id15"><span class="problematic" id="id16">ch_</span></a> = round(wt), round(ht)</p>
<p>from vtool import ltool
T1 = ltool.translation_mat3x3(tx1, ty1, dtype=None)
S  = ltool.scale_mat3x3(sx, sy, dtype=None)
R  = ltool.rotation_mat3x3(-theta, sympy.sin, sympy.cos)
T2 = ltool.translation_mat3x3(tx2, ty2, dtype=None)</p>
<dl class="docutils">
<dt>def add_matmul_hold_prop(mat):</dt>
<dd><p class="first">#import functools
mat = sympy.Matrix(mat)
def matmul_hold(other, hold=False):</p>
<blockquote>
<div>new = sympy.MatMul(mat, other, hold=hold)
add_matmul_hold_prop(new)
return new</div></blockquote>
<p class="last">setattr(mat, &#8216;matmul_hold&#8217;, matmul_hold)
return mat</p>
</dd>
</dl>
<p>T1 = add_matmul_hold_prop(T1)
T2 = add_matmul_hold_prop(T2)
R = add_matmul_hold_prop(R)
S = add_matmul_hold_prop(S)</p>
<p class="last">C = T2.multiply(R.multiply(S.multiply(T1)))
sympy.simplify(C)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_scaled_size_with_area">
<code class="descclassname">vtool.chip.</code><code class="descname">get_scaled_size_with_area</code><span class="sig-paren">(</span><em>target_area</em>, <em>w</em>, <em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_scaled_size_with_area" title="Permalink to this definition">¶</a></dt>
<dd><p>returns new_size which scales (w, h) as close to target_area as possible and
maintains aspect ratio</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_area</span> <span class="o">=</span> <span class="mi">800</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="mi">400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="n">get_scaled_size_with_area</span><span class="p">(</span><span class="n">target_area</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(980, 653)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_scaled_size_with_width">
<code class="descclassname">vtool.chip.</code><code class="descname">get_scaled_size_with_width</code><span class="sig-paren">(</span><em>target_width</em>, <em>w</em>, <em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_scaled_size_with_width" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_width</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="mi">400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_size</span> <span class="o">=</span> <span class="n">get_scaled_size_with_width</span><span class="p">(</span><span class="n">target_width</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(128, 85)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_scaled_sizes_with_area">
<code class="descclassname">vtool.chip.</code><code class="descname">get_scaled_sizes_with_area</code><span class="sig-paren">(</span><em>target_area</em>, <em>size_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_sizes_with_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_scaled_sizes_with_area" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.gridsearch_chipextract">
<code class="descclassname">vtool.chip.</code><code class="descname">gridsearch_chipextract</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/chip.html#gridsearch_chipextract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.gridsearch_chipextract" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.chip --test-gridsearch_chipextract --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GRIDSEARCH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.chip</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_chipextract</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.clustering">
<span id="vtool-clustering-module"></span><h2>vtool.clustering module<a class="headerlink" href="#module-vtool.clustering" title="Permalink to this headline">¶</a></h2>
<p>DEPRICATED USE clustering2.py</p>
<dl class="function">
<dt id="vtool.clustering.akmeans">
<code class="descclassname">vtool.clustering.</code><code class="descname">akmeans</code><span class="sig-paren">(</span><em>data</em>, <em>num_clusters</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>ave_unchanged_thresh=0</em>, <em>ave_unchanged_iterwin=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximiate K-Means (using FLANN)
Input: data - np.array with rows of data.
Description: Quickly partitions data into K=num_clusters centroids.  Cluster
centers are randomly assigned to datapoints.  Each datapoint is assigned to
its approximate nearest cluster center.  The cluster centers are recomputed.
Repeat until approximate convergence.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.force_quit_akmeans">
<code class="descclassname">vtool.clustering.</code><code class="descname">force_quit_akmeans</code><span class="sig-paren">(</span><em>signal</em>, <em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#force_quit_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.force_quit_akmeans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering.plot_clusters">
<code class="descclassname">vtool.clustering.</code><code class="descname">plot_clusters</code><span class="sig-paren">(</span><em>data</em>, <em>datax2_clusterx</em>, <em>centroids</em>, <em>num_pca_dims=3</em>, <em>whiten=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#plot_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.plot_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.precompute_akmeans">
<code class="descclassname">vtool.clustering.</code><code class="descname">precompute_akmeans</code><span class="sig-paren">(</span><em>data</em>, <em>num_clusters</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir=None</em>, <em>force_recomp=False</em>, <em>use_data_hash=True</em>, <em>cfgstr=''</em>, <em>refine=False</em>, <em>akmeans_cfgstr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#precompute_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.precompute_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>precompute aproximate kmeans with builtin caching</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.refine_akmeans">
<code class="descclassname">vtool.clustering.</code><code class="descname">refine_akmeans</code><span class="sig-paren">(</span><em>data</em>, <em>datax2_clusterx</em>, <em>centroids</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir=None</em>, <em>cfgstr=''</em>, <em>use_data_hash=True</em>, <em>akmeans_cfgstr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#refine_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.refine_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Refines the approximates centroids</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.sparse_multiply_rows">
<code class="descclassname">vtool.clustering.</code><code class="descname">sparse_multiply_rows</code><span class="sig-paren">(</span><em>csr_mat</em>, <em>vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#sparse_multiply_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.sparse_multiply_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Row-wise multiplication of a sparse matrix by a sparse vector</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.sparse_normalize_rows">
<code class="descclassname">vtool.clustering.</code><code class="descname">sparse_normalize_rows</code><span class="sig-paren">(</span><em>csr_mat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering.html#sparse_normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.sparse_normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.clustering2">
<span id="vtool-clustering2-module"></span><h2>vtool.clustering2 module<a class="headerlink" href="#module-vtool.clustering2" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>TODO:</dt>
<dd>Does HDBSCAN work on 128 dim vectors?
<a class="reference external" href="http://nbviewer.jupyter.org/github/lmcinnes/hdbscan/blob/master/notebooks/Comparing%20Clustering%20Algorithms.ipynb">http://nbviewer.jupyter.org/github/lmcinnes/hdbscan/blob/master/notebooks/Comparing%20Clustering%20Algorithms.ipynb</a></dd>
</dl>
<dl class="function">
<dt id="vtool.clustering2.akmeans">
<code class="descclassname">vtool.clustering2.</code><code class="descname">akmeans</code><span class="sig-paren">(</span><em>data</em>, <em>nCentroids</em>, <em>max_iters=5</em>, <em>initmethod=u'akmeans++'</em>, <em>flann_params={}</em>, <em>ave_unchanged_thresh=0</em>, <em>ave_unchanged_iterwin=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximiate K-Means (using FLANN)
Input: data - np.array with rows of data.
Description: Quickly partitions data into K=nCentroids centroids.  Cluster
centers are randomly assigned to datapoints.  Each datapoint is assigned to
its approximate nearest centroid center.  The centroid centers are recomputed.
Repeat until approximate convergence.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.akmeans_iterations">
<code class="descclassname">vtool.clustering2.</code><code class="descname">akmeans_iterations</code><span class="sig-paren">(</span><em>data</em>, <em>centroids</em>, <em>max_iters</em>, <em>flann_params</em>, <em>ave_unchanged_thresh</em>, <em>ave_unchanged_iterwin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#akmeans_iterations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.akmeans_iterations" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function which continues the iterations of akmeans</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCentroids</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_iters</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ave_unchanged_thresh</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ave_unchanged_iterwin</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">initialize_centroids</span><span class="p">(</span><span class="n">nCentroids</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">akmeans_iterations</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">max_iters</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">ave_unchanged_thresh</span><span class="p">,</span> <span class="n">ave_unchanged_iterwin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.akmeans_plusplus_init">
<code class="descclassname">vtool.clustering2.</code><code class="descname">akmeans_plusplus_init</code><span class="sig-paren">(</span><em>data</em>, <em>K</em>, <em>samples_per_iter=None</em>, <em>flann_params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#akmeans_plusplus_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.akmeans_plusplus_init" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Referencs:</dt>
<dd><a class="reference external" href="http://datasciencelab.wordpress.com/2014/01/15/improved-seeding-for-clustering-with-k-means/">http://datasciencelab.wordpress.com/2014/01/15/improved-seeding-for-clustering-with-k-means/</a></dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c"># 64000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nump</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dims</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_iters</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples_per_iter</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="n">nump</span><span class="p">,</span> <span class="n">dims</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_centers</span> <span class="o">=</span> <span class="n">akmeans_plusplus_init</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">samples_per_iter</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = str(initial_centers.sum())</span>
</pre></div>
</div>
<p>130240088</p>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples_per_iter</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c"># 64000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_centers</span> <span class="o">=</span> <span class="n">akmeans_plusplus_init</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">samples_per_iter</span><span class="p">,</span>  <span class="n">flann_params</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>utprof.sh ~/code/vtool/vtool/clustering2.py --test-akmeans_plusplus_init
python ~/code/vtool/vtool/clustering2.py --test-akmeans_plusplus_init
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>items</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>groupxs</strong> (<em>list of ndarrays</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">grouped items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of ndarrays</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>group_indices
invert_apply_grouping</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.clustering2 --test-apply_grouping
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#np.random.seed(42)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#idx2_groupid = np.array(np.random.randint(0, 4, size=size))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#items = np.random.randint(5, 10, size=size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="n">apply_grouping</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([8, 5, 6]), array([1, 5, 8, 7]), array([5, 3, 0, 9])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping_</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_" title="Permalink to this definition">¶</a></dt>
<dd><p>non-optimized version</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_iter">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping_iter</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_iter2">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_grouping_iter2</code><span class="sig-paren">(</span><em>items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_jagged_grouping">
<code class="descclassname">vtool.clustering2.</code><code class="descname">apply_jagged_grouping</code><span class="sig-paren">(</span><em>unflat_items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#apply_jagged_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_jagged_grouping" title="Permalink to this definition">¶</a></dt>
<dd><p>takes unflat_list and flat group indices. Returns the unflat grouping</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.approximate_assignments">
<code class="descclassname">vtool.clustering2.</code><code class="descname">approximate_assignments</code><span class="sig-paren">(</span><em>seachedvecs</em>, <em>queryvecs</em>, <em>K</em>, <em>flann_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#approximate_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.approximate_assignments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.approximate_distances">
<code class="descclassname">vtool.clustering2.</code><code class="descname">approximate_distances</code><span class="sig-paren">(</span><em>centroids</em>, <em>data</em>, <em>K</em>, <em>flann_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#approximate_distances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.approximate_distances" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.assert_centroids">
<code class="descclassname">vtool.clustering2.</code><code class="descname">assert_centroids</code><span class="sig-paren">(</span><em>centroids</em>, <em>data</em>, <em>nCentroids</em>, <em>clip_centroids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#assert_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.assert_centroids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.cached_akmeans">
<code class="descclassname">vtool.clustering2.</code><code class="descname">cached_akmeans</code><span class="sig-paren">(</span><em>data</em>, <em>nCentroids</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir=u'default'</em>, <em>force_recomp=False</em>, <em>use_data_hash=True</em>, <em>cfgstr=u''</em>, <em>refine=False</em>, <em>akmeans_cfgstr=None</em>, <em>use_cache=True</em>, <em>appname=u'vtool'</em>, <em>initmethod=u'akmeans++'</em>, <em>clip_centroids=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#cached_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.cached_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>precompute aproximate kmeans with builtin caching</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nump</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dims</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCentroids</span> <span class="o">=</span> <span class="mi">800</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_iters</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="n">nump</span><span class="p">,</span> <span class="n">dims</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd>import vtool.clustering2 as clustertool
max_iters = 300
flann = p yflann.FLANN()
centroids1 = flann.kmeans(data, nCentroids, max_iterations=max_iters, dtype=np.uint8)
centroids2 = clustertool.akmeans(data, nCentroids, max_iters, {})
%timeit clustertool.akmeans(data, nCentroids, max_iters, {})
%timeit flann.kmeans(data, nCentroids, max_iterations=max_iters)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.compute_centroids">
<code class="descclassname">vtool.clustering2.</code><code class="descname">compute_centroids</code><span class="sig-paren">(</span><em>data</em>, <em>centroids</em>, <em>datax2_centroidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#compute_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.compute_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes centroids given datax assignments
TODO: maybe use the grouping code instad of the LR algorithm</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCentroids</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">initialize_centroids</span><span class="p">(</span><span class="n">nCentroids</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids_</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">datax2_centroidx</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span> <span class="n">yflann</span><span class="o">.</span><span class="n">FLANN</span><span class="p">()</span><span class="o">.</span><span class="n">nn</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">flann_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">compute_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">datax2_centroidx</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.double_group">
<code class="descclassname">vtool.clustering2.</code><code class="descname">double_group</code><span class="sig-paren">(</span><em>inner_key_list</em>, <em>outer_keys_list</em>, <em>items_list</em>, <em>ensure_numpy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#double_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.double_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes corresponding lists as input and builds a double mapping.</p>
<p>DEPRICATE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inner_key_list</strong> (<em>list</em>) &#8211; each value_i is a scalar key.</li>
<li><strong>outer_keys_list</strong> (<em>list</em>) &#8211; each value_i list of scalar keys</li>
<li><strong>items_list</strong> (<em>list</em>) &#8211; value_i is a list that corresponds to outer_keys_i</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">outerkey2_innerkey2_items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">utool.ddict of dicts</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inner_key_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outer_keys_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_numpy</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outerkey2_innerkey2_items</span> <span class="o">=</span> <span class="n">double_group</span><span class="p">(</span><span class="n">inner_key_list</span><span class="p">,</span> <span class="n">outer_keys_list</span><span class="p">,</span> <span class="n">items_list</span><span class="p">,</span> <span class="n">ensure_numpy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outerkey2_innerkey2_items</span><span class="p">))</span>
<span class="go">{</span>
<span class="go">    10: {300: array([6]), 100: array([1])},</span>
<span class="go">    20: {400: array([7]), 100: array([2, 3])},</span>
<span class="go">    30: {200: array([4]), 300: array([5])},</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">len_</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incrementer</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">make_incrementer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nOuterList</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Define big double_group input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inner_key_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">len_</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outer_keys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nOuter_</span><span class="p">)</span> <span class="k">for</span> <span class="n">nOuter_</span> <span class="ow">in</span> <span class="n">nOuterList</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">incrementer</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nOuter_</span><span class="p">)])</span> <span class="k">for</span> <span class="n">nOuter_</span> <span class="ow">in</span> <span class="n">nOuterList</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_numpy</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outerkey2_innerkey2_items</span> <span class="o">=</span> <span class="n">double_group</span><span class="p">(</span><span class="n">inner_key_list</span><span class="p">,</span> <span class="n">outer_keys_list</span><span class="p">,</span> <span class="n">items_list</span><span class="p">,</span> <span class="n">ensure_numpy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outerkey2_innerkey2_items</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outerkey2_innerkey2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd>%timeit double_group(inner_key_list, outer_keys_list, items_list, ensure_numpy)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.find_duplicate_items">
<code class="descclassname">vtool.clustering2.</code><code class="descname">find_duplicate_items</code><span class="sig-paren">(</span><em>item_arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#find_duplicate_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.find_duplicate_items" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>item_arr</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">duplicate_items</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">?</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.clustering2 --test-find_duplicate_items
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicate_items</span> <span class="o">=</span> <span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">duplicate_items</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duplicate_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[9, 67, 87, 88]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.get_akmeans_cfgstr">
<code class="descclassname">vtool.clustering2.</code><code class="descname">get_akmeans_cfgstr</code><span class="sig-paren">(</span><em>data</em>, <em>nCentroids</em>, <em>max_iters=5</em>, <em>initmethod=u'akmeans++'</em>, <em>flann_params={}</em>, <em>use_data_hash=True</em>, <em>cfgstr=u''</em>, <em>akmeans_cfgstr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#get_akmeans_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.get_akmeans_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.group_indices">
<code class="descclassname">vtool.clustering2.</code><code class="descname">group_indices</code><span class="sig-paren">(</span><em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#group_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.group_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx2_groupid</strong> (<em>ndarray</em>) &#8211; numpy array of group ids (must be numeric)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>tuple</strong> &#8211; (keys, groupxs)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray, list of ndarrays</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.clustering2 --test-group_indices
utprof.py -m vtool.clustering2 --test-group_indices:2
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#np.random.seed(42)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#idx2_groupid = np.array(np.random.randint(0, 4, size=size))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([1, 2, 3]), [array([1, 3, 5]), array([0, 2, 4, 6]), array([ 7,  8,  9, 10])])</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">24</span><span class="p">],</span> <span class="p">[</span> <span class="mi">129</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">24</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">822</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># 2d arrays must be flattened before coming into this function so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># information is on the last axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 24, 129, 659, 822]), [array([ 0,  4, 10]), array([1]), array([2, 3, 5, 6, 8, 9]), array([7])])</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># TIMING_TEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">group_indices</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
</pre></div>
</div>
</dd>
<dt>Time:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">extract_timeit_setup</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">group_indices</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;groupxs =&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        [sortx[lx:rx] for lx, rx in ut.itertwo(idxs)]</span>
<span class="go">        #[sortx[lx:rx] for lx, rx in zip(idxs[0:-1], idxs[1:])]</span>
<span class="go">        #[sortx[lx:rx] for lx, rx in ut.iter_window(idxs)]</span>
<span class="go">        #[sortx[slice(*_)] for _ in ut.itertwo(idxs)]</span>
<span class="go">        #[sortx[slice(lr, lx)] for lr, lx in ut.itertwo(idxs)]</span>
<span class="go">        #np.split(sortx, idxs[1:-1])</span>
<span class="go">        #np.hsplit(sortx, idxs[1:-1])</span>
<span class="go">        np.array_split(sortx, idxs[1:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="go">        np.diff(groupids_sorted)</span>
<span class="go">        np.ediff1d(groupids_sorted)</span>
<span class="go">        np.subtract(groupids_sorted[1:], groupids_sorted[:-1])</span>
<span class="go">        &#39;&#39;&#39;).split(&#39;\n&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stmt_list</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">passed</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Timeit:</dt>
<dd>import numba
group_indices_numba = numba.jit(group_indices)
group_indices_numba(idx2_groupid)</dd>
<dt>SeeAlso:</dt>
<dd>apply_grouping</dd>
<dt>TODO:</dt>
<dd>Look into np.split
<a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4651683/numpy-grouping-using-itertools-groupby-performance">http://stackoverflow.com/questions/4651683/numpy-grouping-using-itertools-groupby-performance</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupby</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">idx2_groupid</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby_dict">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupby_dict</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby_gen">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupby_gen</code><span class="sig-paren">(</span><em>items</em>, <em>idx2_groupid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby_gen" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupedzip">
<code class="descclassname">vtool.clustering2.</code><code class="descname">groupedzip</code><span class="sig-paren">(</span><em>id_list</em>, <em>datas_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#groupedzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupedzip" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for grouping multiple lists of data (stored in <code class="docutils literal"><span class="pre">datas_list</span></code>)
using <code class="docutils literal"><span class="pre">id_list</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>id_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>datas_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">_iter</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">iterator</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.clustering2 --test-groupedzip
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datas_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="s">&#39;F&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span><span class="p">,</span> <span class="n">grouped_iter</span> <span class="o">=</span> <span class="n">groupedzip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">datas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grouped_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">groupxs</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">grouped_tuples</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[</span>
<span class="go">    ([&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], [&#39;A&#39;, &#39;C&#39;, &#39;E&#39;]),</span>
<span class="go">    ([&#39;b&#39;, &#39;d&#39;, &#39;f&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;F&#39;]),</span>
<span class="go">    ([&#39;g&#39;], [&#39;G&#39;]),</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.initialize_centroids">
<code class="descclassname">vtool.clustering2.</code><code class="descname">initialize_centroids</code><span class="sig-paren">(</span><em>nCentroids</em>, <em>data</em>, <em>initmethod=u'akmeans++'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#initialize_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.initialize_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes centroids to random datapoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.invert_apply_grouping">
<code class="descclassname">vtool.clustering2.</code><code class="descname">invert_apply_grouping</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grouped_items</strong> (<em>list</em>) &#8211; of lists</li>
<li><strong>groupxs</strong> (<em>list</em>) &#8211; of lists</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.clustering2 --test-invert_apply_grouping
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 8, 5, 5, 8, 6, 7, 5, 3, 0, 9]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.invert_apply_grouping2">
<code class="descclassname">vtool.clustering2.</code><code class="descname">invert_apply_grouping2</code><span class="sig-paren">(</span><em>grouped_items</em>, <em>groupxs</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping2" title="Permalink to this definition">¶</a></dt>
<dd><p>use only when ungrouping will be complete</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.jagged_group">
<code class="descclassname">vtool.clustering2.</code><code class="descname">jagged_group</code><span class="sig-paren">(</span><em>groupids_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#jagged_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.jagged_group" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens and returns group indexes into the flattened list</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.plot_centroids">
<code class="descclassname">vtool.clustering2.</code><code class="descname">plot_centroids</code><span class="sig-paren">(</span><em>data</em>, <em>centroids</em>, <em>num_pca_dims=3</em>, <em>whiten=False</em>, <em>labels=u'centroids'</em>, <em>fnum=1</em>, <em>prefix=u''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#plot_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.plot_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.refine_akmeans">
<code class="descclassname">vtool.clustering2.</code><code class="descname">refine_akmeans</code><span class="sig-paren">(</span><em>data</em>, <em>centroids</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir=u'default'</em>, <em>cfgstr=u''</em>, <em>use_data_hash=True</em>, <em>akmeans_cfgstr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#refine_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.refine_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Refines the approximates centroids</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.sparse_multiply_rows">
<code class="descclassname">vtool.clustering2.</code><code class="descname">sparse_multiply_rows</code><span class="sig-paren">(</span><em>csr_mat</em>, <em>vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#sparse_multiply_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.sparse_multiply_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Row-wise multiplication of a sparse matrix by a sparse vector</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.sparse_normalize_rows">
<code class="descclassname">vtool.clustering2.</code><code class="descname">sparse_normalize_rows</code><span class="sig-paren">(</span><em>csr_mat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#sparse_normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.sparse_normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.tune_flann2">
<code class="descclassname">vtool.clustering2.</code><code class="descname">tune_flann2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#tune_flann2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.tune_flann2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.uniform_sample_hypersphere">
<code class="descclassname">vtool.clustering2.</code><code class="descname">uniform_sample_hypersphere</code><span class="sig-paren">(</span><em>num</em>, <em>ndim=2</em>, <em>only_quadrent_1=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/clustering2.html#uniform_sample_hypersphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.uniform_sample_hypersphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Not quite done yet</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regular_polytope">https://en.wikipedia.org/wiki/Regular_polytope</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions">https://en.wikipedia.org/wiki/Platonic_solid#Higher_dimensions</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Cross-polytope">https://en.wikipedia.org/wiki/Cross-polytope</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num</strong> &#8211; </li>
<li><strong>ndim</strong> (<em>int</em>) &#8211; (default = 2)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.clustering2 --test-uniform_sampe_hypersphere
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pts</span> <span class="o">=</span> <span class="n">uniform_sampe_hypersphere</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;gx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c">#pt.plot_surface3d(pts.T[0], pts.T[1], pts.T[2])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">docla</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df2</span><span class="o">.</span><span class="n">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.confusion">
<span id="vtool-confusion-module"></span><h2>vtool.confusion module<a class="headerlink" href="#module-vtool.confusion" title="Permalink to this headline">¶</a></h2>
<p>Module for &#8211; Confusion matrix, contingency, error matrix,</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Confusion_matrix">http://en.wikipedia.org/wiki/Confusion_matrix</a></p>
<dl class="class">
<dt id="vtool.confusion.ConfusionMetrics">
<em class="property">class </em><code class="descclassname">vtool.confusion.</code><code class="descname">ConfusionMetrics</code><span class="sig-paren">(</span><em>thresholds</em>, <em>tp</em>, <em>fp</em>, <em>fn</em>, <em>tn</em>, <em>fpr</em>, <em>tpr</em>, <em>ppv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<blockquote>
<div><dl class="docutils">
<dt>Ignore:</dt>
<dd>varname_list = &#8216;tp, fp, fn, tn, fpr, tpr, ppv&#8217;.split(&#8216;, &#8216;)
lines = [&#8216;self.{varname} = {varname}&#8217;.format(varname=varname) for varname in varname_list]
print(ut.indent(&#8216;</dd>
</dl>
</div></blockquote>
<p>&#8216;.join(lines)))</p>
<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.auc">
<code class="descname">auc</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.auc" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>The AUC is a standard measure used to evaluate a binary classifier and</dt>
<dd>represents the probability that a random correct case will
receive a higher score than a random incorrect case.</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve">https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve</a></p>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.draw_precision_recall_curve">
<code class="descname">draw_precision_recall_curve</code><span class="sig-paren">(</span><em>nSamples=11</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.draw_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.draw_roc_curve">
<code class="descname">draw_roc_curve</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.draw_roc_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.draw_roc_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="vtool.confusion.ConfusionMetrics.from_scores_and_labels">
<em class="property">classmethod </em><code class="descname">from_scores_and_labels</code><span class="sig-paren">(</span><em>scores</em>, <em>labels</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.from_scores_and_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.from_scores_and_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="vtool.confusion.ConfusionMetrics.from_tp_and_tn_scores">
<em class="property">classmethod </em><code class="descname">from_tp_and_tn_scores</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.from_tp_and_tn_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.from_tp_and_tn_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_ave_precision">
<code class="descname">get_ave_precision</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_ave_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_ave_precision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="vtool.confusion.ConfusionMetrics.get_confusion_metrics">
<em class="property">classmethod </em><code class="descname">get_confusion_metrics</code><span class="sig-paren">(</span><em>scores</em>, <em>labels</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_confusion_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_confusion_metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_fpr_at_95_recall">
<code class="descname">get_fpr_at_95_recall</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_fpr_at_95_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_fpr_at_95_recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_fpr_at_recall">
<code class="descname">get_fpr_at_recall</code><span class="sig-paren">(</span><em>target_recall</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_fpr_at_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_fpr_at_recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_metric_at_threshold">
<code class="descname">get_metric_at_threshold</code><span class="sig-paren">(</span><em>metric</em>, <em>thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_metric_at_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_metric_at_threshold" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) &#8211; </li>
<li><strong>thresh</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --exec-get_metric_at_threshold
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">get_confusion_metrics</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_at_threshold</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;(None, None) = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_recall_at_fpr">
<code class="descname">get_recall_at_fpr</code><span class="sig-paren">(</span><em>target_fpr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_recall_at_fpr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_recall_at_fpr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.get_threshold_at_metric">
<code class="descname">get_threshold_at_metric</code><span class="sig-paren">(</span><em>metric</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#ConfusionMetrics.get_threshold_at_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.get_threshold_at_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a threshold for a binary classifier using a target metric and value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<em>str</em>) &#8211; tpr or fpr</li>
<li><strong>value</strong> (<em>float</em>) &#8211; corresponding numeric value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">thresh</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --exec-get_threshold_at_metric
python -m vtool.confusion --exec-interact_roc_factory --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">get_confusion_metrics</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="s">&#39;tpr&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_threshold_at_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s"> = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;thresh = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thresh</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">thresh = 22.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.precision">
<code class="descname">precision</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.precision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="vtool.confusion.ConfusionMetrics.recall">
<code class="descname">recall</code><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.confusion.ConfusionMetrics.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.confusion.ConfusionMetrics.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.confusion.draw_precision_recall_curve">
<code class="descclassname">vtool.confusion.</code><code class="descname">draw_precision_recall_curve</code><span class="sig-paren">(</span><em>recall_domain</em>, <em>p_interp</em>, <em>title_pref=None</em>, <em>fnum=1</em>, <em>pnum=None</em>, <em>color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.draw_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.confusion.draw_roc_curve">
<code class="descclassname">vtool.confusion.</code><code class="descname">draw_roc_curve</code><span class="sig-paren">(</span><em>fpr</em>, <em>tpr</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>marker='-'</em>, <em>target_tpr=None</em>, <em>target_fpr=None</em>, <em>thresholds=None</em>, <em>color=None</em>, <em>show_operating_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#draw_roc_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.draw_roc_curve" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fpr</strong> &#8211; </li>
<li><strong>tpr</strong> &#8211; </li>
<li><strong>fnum</strong> (<em>int</em>) &#8211; figure number(default = None)</li>
<li><strong>pnum</strong> (<em>tuple</em>) &#8211; plot number(default = None)</li>
<li><strong>marker</strong> (<em>str</em>) &#8211; (default = &#8216;-x&#8217;)</li>
<li><strong>target_tpr</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>target_fpr</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>thresholds</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>color</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>show_operating_point</strong> (<em>bool</em>) &#8211; (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --exec-draw_roc_curve --show --lightbg
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">get_confusion_metrics</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpr</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">marker</span> <span class="o">=</span> <span class="s">&#39;-x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_tpr</span> <span class="o">=</span> <span class="o">.</span><span class="mi">85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_fpr</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_operating_point</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">target_tpr</span><span class="p">,</span> <span class="n">target_fpr</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">thresholds</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.get_confusion_metrics">
<code class="descclassname">vtool.confusion.</code><code class="descname">get_confusion_metrics</code><span class="sig-paren">(</span><em>scores</em>, <em>labels</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#get_confusion_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.get_confusion_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average percision using the PASCAL definition</p>
<p>FIXME: Use only the groundtruth that could have been matched in the
database. (shouldn&#8217;t be an issue until we start using daid subsets)</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a>
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html#sklearn.metrics.roc_curve</a></p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>sklearn.metrics.ranking._binary_clf_curve</dd>
</dl>
<p class="rubric">Notes</p>
<p>From oxford:
Precision is defined as the ratio of retrieved positive images to the</p>
<blockquote>
<div>total number retrieved.</div></blockquote>
<dl class="docutils">
<dt>Recall is defined as the ratio of the number of retrieved positive</dt>
<dd>images to the total number of positive images in the corpus.</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --exec-get_confusion_metrics --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">get_confusion_metrics</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span><span class="o">.</span><span class="n">draw_roc_curve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.interact_roc_factory">
<code class="descclassname">vtool.confusion.</code><code class="descname">interact_roc_factory</code><span class="sig-paren">(</span><em>confusions</em>, <em>target_tpr=None</em>, <em>show_operating_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interact_roc_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.interact_roc_factory" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>confusions</strong> (<em>Confusions</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --exec-interact_roc_factory --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;scores = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">get_confusion_metrics</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">make_csv_table</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="n">confusions</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">tpr</span><span class="p">,</span> <span class="n">confusions</span><span class="o">.</span><span class="n">thresholds</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[</span><span class="s">&#39;fpr&#39;</span><span class="p">,</span> <span class="s">&#39;tpr&#39;</span><span class="p">,</span> <span class="s">&#39;thresh&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ROCInteraction</span> <span class="o">=</span> <span class="n">interact_roc_factory</span><span class="p">(</span><span class="n">confusions</span><span class="p">,</span> <span class="n">target_tpr</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">show_operating_point</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">ROCInteraction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span><span class="o">.</span><span class="n">show_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.interpolate_precision_recall">
<code class="descclassname">vtool.confusion.</code><code class="descname">interpolate_precision_recall</code><span class="sig-paren">(</span><em>precision</em>, <em>recall</em>, <em>nSamples=11</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_precision_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.interpolate_precision_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates precision as a function of recall p_{interp}(r)</p>
<p>Reduce wiggles in average precision curve by taking interpolated values
along a uniform sample.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Average_precision</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision">http://en.wikipedia.org/wiki/Information_retrieval#Mean_Average_precision</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --test-interpolate_precision_recall --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_scores_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nSamples</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confusions</span> <span class="o">=</span> <span class="n">get_confusion_metrics</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">precision</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall</span> <span class="o">=</span> <span class="n">confusions</span><span class="o">.</span><span class="n">recall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span> <span class="o">=</span> <span class="n">interpolate_precision_recall</span><span class="p">(</span><span class="n">confusions</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">nSamples</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">p_interp</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_precision_recall_curve</span><span class="p">(</span><span class="n">recall_domain</span><span class="p">,</span> <span class="n">p_interp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  1. ,  0.9,  0.9,  0.8,  0.6], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.interpolate_replbounds">
<code class="descclassname">vtool.confusion.</code><code class="descname">interpolate_replbounds</code><span class="sig-paren">(</span><em>xdata</em>, <em>ydata</em>, <em>pt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#interpolate_replbounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.interpolate_replbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>xdata = np.array([.1, .2, .3, .4, .5])
ydata = np.array([.1, .2, .3, .4, .5])
pt = .35</p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>if duplicate xdata is given bad things happen.</dd>
<dt>BUG:</dt>
<dd>in scipy.interpolate.interp1d
If there is a duplicate xdata, then assume_sorted=False will
sort ydata by xdata, but xdata should retain its initial ordering
in places of ambuguity. Currently it does not.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xdata</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>ydata</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>pt</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">interp_vals</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.confusion --exec-interpolate_replbounds
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.confusion</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span>    <span class="mi">26</span><span class="p">,</span>   <span class="mi">23</span><span class="p">,</span>   <span class="mi">22</span><span class="p">,</span>   <span class="mi">19</span><span class="p">,</span>  <span class="mi">17</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interpolate_replbounds</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;interp_vals = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">interp_vals = [ 22.5  17.   34. ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.confusion.testdata_scores_labels">
<code class="descclassname">vtool.confusion.</code><code class="descname">testdata_scores_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/confusion.html#testdata_scores_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.confusion.testdata_scores_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.constrained_matching">
<span id="vtool-constrained-matching-module"></span><h2>vtool.constrained_matching module<a class="headerlink" href="#module-vtool.constrained_matching" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.constrained_matching.Annot">
<em class="property">class </em><code class="descclassname">vtool.constrained_matching.</code><code class="descname">Annot</code><span class="sig-paren">(</span><em>annot</em>, <em>fpath</em>, <em>species='zebra_plains'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>fpath1 = ut.grab_test_imgpath(fname1)
fpath2 = ut.grab_test_imgpath(fname2)
annot1 = Annot(fpath1)
annot2 = Annot(fpath2)
annot = annot1</p>
<dl class="method">
<dt id="vtool.constrained_matching.Annot.baseline_match">
<code class="descname">baseline_match</code><span class="sig-paren">(</span><em>annot</em>, <em>annot2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.baseline_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.baseline_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.compute_dstncvs_mask">
<code class="descname">compute_dstncvs_mask</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.compute_dstncvs_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.compute_dstncvs_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.compute_fgweight_mask">
<code class="descname">compute_fgweight_mask</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.compute_fgweight_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.compute_fgweight_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.constrained_match">
<code class="descname">constrained_match</code><span class="sig-paren">(</span><em>annot</em>, <em>match_SV</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.constrained_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.constrained_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.lazy_compute">
<code class="descname">lazy_compute</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.lazy_compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.lazy_compute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.constrained_matching.Annot.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>annot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.show_dstncvs_mask">
<code class="descname">show_dstncvs_mask</code><span class="sig-paren">(</span><em>annot</em>, <em>title='wd'</em>, <em>update=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.show_dstncvs_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.show_dstncvs_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.show_fgweight_mask">
<code class="descname">show_fgweight_mask</code><span class="sig-paren">(</span><em>annot</em>, <em>title='fg'</em>, <em>update=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.show_fgweight_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.show_fgweight_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.constrained_matching.AnnotMatch">
<em class="property">class </em><code class="descclassname">vtool.constrained_matching.</code><code class="descname">AnnotMatch</code><span class="sig-paren">(</span><em>match</em>, <em>annot1</em>, <em>annot2</em>, <em>fm</em>, <em>fs</em>, <em>key=None</em>, <em>fm_norm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span> <span class="o">=</span> <span class="s">&#39;easy1.png&#39;</span><span class="p">,</span> <span class="s">&#39;easy2.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">fname1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">fname2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span> <span class="o">=</span> <span class="n">Annot</span><span class="p">(</span><span class="n">fpath1</span><span class="p">),</span> <span class="n">Annot</span><span class="p">(</span><span class="n">fpath2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_ORIG</span><span class="p">,</span> <span class="n">match_RAT</span><span class="p">,</span> <span class="n">match_SV</span> <span class="o">=</span> <span class="n">annot1</span><span class="o">.</span><span class="n">baseline_match</span><span class="p">(</span><span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match_SV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_SC</span><span class="p">,</span> <span class="n">match_SCR</span><span class="p">,</span> <span class="n">match_SCRSV</span> <span class="o">=</span> <span class="n">annot1</span><span class="o">.</span><span class="n">constrained_match</span><span class="p">(</span><span class="n">match_SV</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match_SCR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ___</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">match_ORIG</span><span class="p">,</span> <span class="n">match_RAT</span><span class="p">,</span> <span class="n">match_SV</span><span class="p">,</span> <span class="n">match_SC</span><span class="p">,</span> <span class="n">match_SCR</span><span class="p">,</span> <span class="n">match_SCRSV</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># false match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname3</span> <span class="o">=</span> <span class="s">&#39;hard3.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath3</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">fname3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot3</span> <span class="o">=</span> <span class="n">Annot</span><span class="p">(</span><span class="n">fpath3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_tn_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_tn_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">annot1</span><span class="o">.</span><span class="n">baseline_match</span><span class="p">(</span><span class="n">annot3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_SV_fn</span> <span class="o">=</span> <span class="n">match_tn_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_tn_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">annot1</span><span class="o">.</span><span class="n">constrained_match</span><span class="p">(</span><span class="n">match_SV_fn</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ___</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;___________&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">match_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">match</span><span class="o">.</span><span class="n">print_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;___________&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match_tn</span> <span class="ow">in</span> <span class="n">match_tn_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">match_tn</span><span class="o">.</span><span class="n">print_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;___________&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match</span><span class="p">,</span> <span class="n">match_tn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">match_list</span><span class="p">,</span> <span class="n">match_tn_list</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">match</span><span class="o">.</span><span class="n">print_score_diffs</span><span class="p">(</span><span class="n">match_tn</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Ignore::</dt>
<dd><p class="first">match.show_matches(fnum=1, update=True)</p>
<p class="last">match.show_normalizers(fnum=2, update=True)</p>
</dd>
</dl>
<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_coverage_mask">
<code class="descname">compute_coverage_mask</code><span class="sig-paren">(</span><em>match</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>compute matching coverage of annot</p>
</dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_scores">
<code class="descname">compute_scores</code><span class="sig-paren">(</span><em>match</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_weighte_average_score">
<code class="descname">compute_weighte_average_score</code><span class="sig-paren">(</span><em>match</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_weighte_average_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_weighte_average_score" title="Permalink to this definition">¶</a></dt>
<dd><p>old scoring measure</p>
</dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_weighted_coverage_score">
<code class="descname">compute_weighted_coverage_score</code><span class="sig-paren">(</span><em>match</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_weighted_coverage_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_weighted_coverage_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.lazy_compute">
<code class="descname">lazy_compute</code><span class="sig-paren">(</span><em>match</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.lazy_compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.lazy_compute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.print_score_diffs">
<code class="descname">print_score_diffs</code><span class="sig-paren">(</span><em>match</em>, <em>match_tn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.print_score_diffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.print_score_diffs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.print_scores">
<code class="descname">print_scores</code><span class="sig-paren">(</span><em>match</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.print_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.print_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.show_matches">
<code class="descname">show_matches</code><span class="sig-paren">(</span><em>match</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>update=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.show_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.show_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.show_normalizers">
<code class="descname">show_normalizers</code><span class="sig-paren">(</span><em>match</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>update=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.show_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.show_normalizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.assign_nearest_neighbors">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">assign_nearest_neighbors</code><span class="sig-paren">(</span><em>vecs1</em>, <em>vecs2</em>, <em>K=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#assign_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.assign_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.baseline_vsone_ratio_matcher">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">baseline_vsone_ratio_matcher</code><span class="sig-paren">(</span><em>testtup</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#baseline_vsone_ratio_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.baseline_vsone_ratio_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>spatially constrained ratio matching</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.constrained_matching --test-spatially_constrianed_matcher
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">testdata_matcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basetup</span><span class="p">,</span> <span class="n">base_meta</span> <span class="o">=</span> <span class="n">baseline_vsone_ratio_matcher</span><span class="p">(</span><span class="n">testtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">basetup</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.baseline_vsone_ratio_matcher_">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">baseline_vsone_ratio_matcher_</code><span class="sig-paren">(</span><em>kpts1</em>, <em>vecs1</em>, <em>kpts2</em>, <em>vecs2</em>, <em>dlen_sqrd2</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#baseline_vsone_ratio_matcher_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.baseline_vsone_ratio_matcher_" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vecs1</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; SIFT descriptors</li>
<li><strong>vecs2</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; SIFT descriptors</li>
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.compute_distinctivness">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">compute_distinctivness</code><span class="sig-paren">(</span><em>vecs_list</em>, <em>species='zebra_plains'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#compute_distinctivness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.compute_distinctivness" title="Permalink to this definition">¶</a></dt>
<dd><p>hack in distinctivness</p>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.compute_forgroundness">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">compute_forgroundness</code><span class="sig-paren">(</span><em>fpath1</em>, <em>kpts1</em>, <em>species='zebra_plains'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#compute_forgroundness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.compute_forgroundness" title="Permalink to this definition">¶</a></dt>
<dd><p>hack in foregroundness</p>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.spatially_constrain_matches">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">spatially_constrain_matches</code><span class="sig-paren">(</span><em>dlen_sqrd2</em>, <em>kpts1</em>, <em>kpts2</em>, <em>H_RAT</em>, <em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>match_xy_thresh</em>, <em>normalizer_mode='far'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#spatially_constrain_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.spatially_constrain_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for spatially_constrianed_matcher
OLD FUNCTION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dlen_sqrd2</strong> &#8211; </li>
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H_RAT</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>fx2_to_dist</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>match_xy_thresh</strong> &#8211; threshold is specified as a fraction of the diagonal chip length</li>
<li><strong>normalizer_mode</strong> (<em>str</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.spatially_constrianed_matcher">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">spatially_constrianed_matcher</code><span class="sig-paren">(</span><em>testtup</em>, <em>basetup</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#spatially_constrianed_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.spatially_constrianed_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>spatially constrained ratio matching</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.constrained_matching --test-spatially_constrianed_matcher
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">testdata_matcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basetup</span><span class="p">,</span> <span class="n">base_meta</span> <span class="o">=</span> <span class="n">baseline_vsone_ratio_matcher</span><span class="p">(</span><span class="n">testtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nexttup</span><span class="p">,</span> <span class="n">next_meta</span> <span class="o">=</span> <span class="n">spatially_constrianed_matcher</span><span class="p">(</span><span class="n">testtup</span><span class="p">,</span> <span class="n">basetup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">nexttup</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.spatially_constrianed_matcher_">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">spatially_constrianed_matcher_</code><span class="sig-paren">(</span><em>kpts1</em>, <em>vecs1</em>, <em>kpts2</em>, <em>vecs2</em>, <em>dlen_sqrd2</em>, <em>H_RAT</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#spatially_constrianed_matcher_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.spatially_constrianed_matcher_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.testdata_matcher">
<code class="descclassname">vtool.constrained_matching.</code><code class="descname">testdata_matcher</code><span class="sig-paren">(</span><em>fname1='easy1.png'</em>, <em>fname2='easy2.png'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/constrained_matching.html#testdata_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.testdata_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8221;
fname1 = &#8216;easy1.png&#8217;
fname2 = &#8216;hard3.png&#8217;</p>
<p>annot1 = Annot(fpath1)
annot2 = Annot(fpath2)</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.coverage_grid">
<span id="vtool-coverage-grid-module"></span><h2>vtool.coverage_grid module<a class="headerlink" href="#module-vtool.coverage_grid" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.coverage_grid.compute_subbin_to_bins_dist">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">compute_subbin_to_bins_dist</code><span class="sig-paren">(</span><em>neighbor_bin_centers</em>, <em>subbin_xy_arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#compute_subbin_to_bins_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.compute_subbin_to_bins_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.get_coverage_grid_gridsearch_configs">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">get_coverage_grid_gridsearch_configs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_coverage_grid_gridsearch_configs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.get_coverage_grid_gridsearch_configs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.get_subbin_xy_neighbors">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">get_subbin_xy_neighbors</code><span class="sig-paren">(</span><em>subbin_index00</em>, <em>grid_steps</em>, <em>num_cols</em>, <em>num_rows</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_subbin_xy_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.get_subbin_xy_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all neighbor of a bin
subbin_index00 = left and up subbin index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.gridsearch_coverage_grid">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">gridsearch_coverage_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_grid --test-gridsearch_coverage_grid --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.gridsearch_coverage_grid_mask">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">gridsearch_coverage_grid_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid_mask" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_grid --test-gridsearch_coverage_grid_mask --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.make_grid_coverage_mask">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">make_grid_coverage_mask</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>weights</em>, <em>pxl_per_bin=4</em>, <em>grid_steps=1</em>, <em>resize=False</em>, <em>out=None</em>, <em>grid_sigma=1.6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#make_grid_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.make_grid_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoint</li>
<li><strong>chipsize</strong> (<em>tuple</em>) &#8211; width, height</li>
<li><strong>weights</strong> (<em>ndarray[float32_t, ndim=1]</em>) &#8211; </li>
<li><strong>pxl_per_bin</strong> (<em>float</em>) &#8211; </li>
<li><strong>grid_steps</strong> (<em>int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weightgrid</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_grid --test-make_grid_coverage_mask
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">(</span><span class="s">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weightgrid</span> <span class="o">=</span> <span class="n">make_grid_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify result</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">weightgrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.show_coverage_grid">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">show_coverage_grid</code><span class="sig-paren">(</span><em>num_rows</em>, <em>num_cols</em>, <em>subbin_xy_arr</em>, <em>neighbor_bin_centers</em>, <em>neighbor_bin_weights</em>, <em>neighbor_bin_indices</em>, <em>fnum=None</em>, <em>pnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#show_coverage_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.show_coverage_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>visualizes the voting scheme on the grid. (not a mask, and no max)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.sparse_grid_coverage">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">sparse_grid_coverage</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>weights</em>, <em>pxl_per_bin=0.3</em>, <em>grid_steps=1</em>, <em>grid_sigma=1.6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#sparse_grid_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.sparse_grid_coverage" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoint</li>
<li><strong>chipsize</strong> (<em>tuple</em>) &#8211; </li>
<li><strong>weights</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_grid --test-sparse_grid_coverage --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">chipsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_sigma</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coverage_gridtup</span> <span class="o">=</span> <span class="n">sparse_grid_coverage</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">,</span> <span class="n">grid_sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">show_coverage_grid</span><span class="p">(</span><span class="o">*</span><span class="n">coverage_gridtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.weighted_gaussian_falloff">
<code class="descclassname">vtool.coverage_grid.</code><code class="descname">weighted_gaussian_falloff</code><span class="sig-paren">(</span><em>neighbor_subbin_sqrddist_arr</em>, <em>weights</em>, <em>grid_sigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_grid.html#weighted_gaussian_falloff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.weighted_gaussian_falloff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.coverage_kpts">
<span id="vtool-coverage-kpts-module"></span><h2>vtool.coverage_kpts module<a class="headerlink" href="#module-vtool.coverage_kpts" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">get_coverage_kpts_gridsearch_configs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_coverage_kpts_gridsearch_configs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.get_gaussian_weight_patch">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">get_gaussian_weight_patch</code><span class="sig-paren">(</span><em>gauss_shape=(19</em>, <em>19)</em>, <em>gauss_sigma_frac=0.3</em>, <em>gauss_norm_01=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.get_gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>2d gaussian image useful for plotting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">patch</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_kpts --test-get_gaussian_weight_patch
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_gaussian_weight_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.gridsearch_kpts_coverage_mask">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">gridsearch_kpts_coverage_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#gridsearch_kpts_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.gridsearch_kpts_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_kpts --test-gridsearch_kpts_coverage_mask --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_kpts_coverage_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.make_kpts_coverage_mask">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">make_kpts_coverage_mask</code><span class="sig-paren">(</span><em>kpts</em>, <em>chipsize</em>, <em>weights=None</em>, <em>return_patch=False</em>, <em>patch=None</em>, <em>resize=False</em>, <em>out=None</em>, <em>cov_blur_on=True</em>, <em>cov_blur_ksize=(17</em>, <em>17)</em>, <em>cov_blur_sigma=5.0</em>, <em>cov_gauss_shape=(19</em>, <em>19)</em>, <em>cov_gauss_sigma_frac=0.3</em>, <em>cov_scale_factor=0.2</em>, <em>cov_agg_mode='max'</em>, <em>cov_remove_shape=False</em>, <em>cov_remove_scale=False</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_kpts_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.make_kpts_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a intensity image denoting which pixels are covered by the input
keypoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</li>
<li><strong>chipsize</strong> (<em>tuple</em>) &#8211; width height of the underlying image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>tuple</strong> &#8211; dstimg, patch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_kpts --test-make_kpts_coverage_mask --show
python -m vtool.coverage_kpts --test-make_kpts_coverage_mask

python -m vtool.patch --test-test_show_gaussian_patches2 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#img_fpath = ut.grab_test_imgpath(&#39;carl.jpg&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_kpts</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span><span class="p">,</span> <span class="n">patch</span> <span class="o">=</span> <span class="n">make_kpts_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_patch</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.show_coverage_map">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">show_coverage_map</code><span class="sig-paren">(</span><em>chip</em>, <em>mask</em>, <em>patch</em>, <em>kpts</em>, <em>fnum=None</em>, <em>ell_alpha=0.6</em>, <em>show_mask_kpts=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#show_coverage_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.show_coverage_map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.testdata_coverage">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">testdata_coverage</code><span class="sig-paren">(</span><em>fname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#testdata_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.testdata_coverage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.warp_patch_onto_kpts">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">warp_patch_onto_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch</em>, <em>chipshape</em>, <em>weights=None</em>, <em>out=None</em>, <em>cov_scale_factor=0.2</em>, <em>cov_agg_mode='max'</em>, <em>cov_remove_shape=False</em>, <em>cov_remove_scale=False</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warp_patch_onto_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.warp_patch_onto_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Overlays the source image onto a destination image in each keypoint location</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>patch</strong> (<em>ndarray</em>) &#8211; patch to warp (like gaussian)</li>
<li><strong>chipshape</strong> (<em>tuple</em>) &#8211; </li>
<li><strong>weights</strong> (<em>ndarray</em>) &#8211; score for every keypoint</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>cov_scale_factor (float):</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.coverage_kpts --test-warp_patch_onto_kpts
python -m vtool.coverage_kpts --test-warp_patch_onto_kpts --show
python -m vtool.coverage_kpts --test-warp_patch_onto_kpts --show --hole
python -m vtool.coverage_kpts --test-warp_patch_onto_kpts --show --square
python -m vtool.coverage_kpts --test-warp_patch_onto_kpts --show --square --hole
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span>    <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_kpts</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipshape</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov_scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srcshape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="n">srcshape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SQUARE</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--square&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HOLE</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--hole&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">SQUARE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">srcshape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">srcshape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> <span class="c">#, norm_01=False)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">patch</span> <span class="o">/</span> <span class="n">patch</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">HOLE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span> <span class="o">=</span> <span class="n">warp_patch_onto_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">chipshape</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cov_scale_factor</span><span class="o">=</span><span class="n">cov_scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;dstimg stats </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;patch stats </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(patch.sum())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">inbounds</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.warped_patch_generator">
<code class="descclassname">vtool.coverage_kpts.</code><code class="descname">warped_patch_generator</code><span class="sig-paren">(</span><em>patch</em>, <em>dsize</em>, <em>affmat_list</em>, <em>weight_list</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warped_patch_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.warped_patch_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>generator that warps the patches (like gaussian) onto an image with dsize using constant memory.</p>
<p>output must be used or copied on every iteration otherwise the next output will clobber the previous</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine">http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool.depricated">
<span id="vtool-depricated-module"></span><h2>vtool.depricated module<a class="headerlink" href="#module-vtool.depricated" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.depricated.ThumbnailCacheContext">
<em class="property">class </em><code class="descclassname">vtool.depricated.</code><code class="descname">ThumbnailCacheContext</code><span class="sig-paren">(</span><em>uuid_list</em>, <em>asrgb=True</em>, <em>thumb_size=64</em>, <em>thumb_dpath=None</em>, <em>appname='vtool'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Lazy computation of of images as thumbnails.</p>
<p>DEPRICATED</p>
<p>Just pass a list of uuids corresponding to the images. Then compute images
flagged as dirty and give them back to the context.  thumbs_list will be
populated on contex exit</p>
<dl class="method">
<dt id="vtool.depricated.ThumbnailCacheContext.filter_dirty_items">
<code class="descname">filter_dirty_items</code><span class="sig-paren">(</span><em>list_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext.filter_dirty_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext.filter_dirty_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns only items marked by the context as dirty</p>
</dd></dl>

<dl class="method">
<dt id="vtool.depricated.ThumbnailCacheContext.save_dirty_thumbs_from_images">
<code class="descname">save_dirty_thumbs_from_images</code><span class="sig-paren">(</span><em>img_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/depricated.html#ThumbnailCacheContext.save_dirty_thumbs_from_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.depricated.ThumbnailCacheContext.save_dirty_thumbs_from_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass in any images marked by the context as dirty here</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-vtool.distance">
<span id="vtool-distance-module"></span><h2>vtool.distance module<a class="headerlink" href="#module-vtool.distance" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.distance.L1">
<code class="descclassname">vtool.distance.</code><code class="descname">L1</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L1 (aka manhatten or grid) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2">
<code class="descclassname">vtool.distance.</code><code class="descname">L2</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L2 (aka euclidean or standard) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">L2_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalized SIFT L2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) &#8211; Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) &#8211; Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">squared euclidean distance between 0-1 normalized sift descriptors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-L2_sift
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">l2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.45,  0.49,  0.51,  0.49,  0.51,  0.48,  0.52,  0.52,  0.49,  0.55], dtype=np.float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_sqrd">
<code class="descclassname">vtool.distance.</code><code class="descname">L2_sqrd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#L2_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the squared L2 distance</p>
<dl class="docutils">
<dt># FIXME:</dt>
<dd>if hist1.shape = (0,) and hist.shape = (0,) then result=0.0</dd>
<dt>SeeAlso:</dt>
<dd>L2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2dist</span> <span class="o">=</span> <span class="n">L2_sqrd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">l2dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.77,  0.27,  0.11, ...,  0.14,  0.3 ,  0.66], dtype=np.float32)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth::</dt>
<dd><p class="first">#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] hist1
np.ndarray[np.float64_t, ndim=2] hist2</div></blockquote>
<p>#if CYTH
cdef:</p>
<blockquote>
<div>size_t cx, rx</div></blockquote>
<p>cdef unsigned int rows = hist1.shape[0]
cdef unsigned int cols = hist1.shape[1]
# Prealloc output
cdef np.ndarray[np.float64_t, ndim=1] out = np.zeros((rows,), dtype=hist1.dtype)
for rx in range(rows):</p>
<blockquote>
<div><dl class="docutils">
<dt>for cx in range(cols):</dt>
<dd>out[rx] += (hist1[rx, cx] - hist2[rx, cx]) ** 2</dd>
</dl>
</div></blockquote>
<p class="last">return out
#else</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.bar_L2_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">bar_L2_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_L2_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.bar_L2_sift" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hist1</strong> (<em>ndarray</em>) &#8211; Nx128 array of uint8 with pseudomax trick</li>
<li><strong>hist2</strong> (<em>ndarray</em>) &#8211; Nx128 array of uint8 with pseudomax trick</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>1 - Normalized SIFT L2</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-bar_L2_sift
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">barl2_dist</span> <span class="o">=</span> <span class="n">bar_L2_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">barl2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.55,  0.51,  0.49,  0.51,  0.49,  0.52,  0.48,  0.48,  0.51,  0.45], dtype=np.float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.bar_cos_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">bar_cos_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#bar_cos_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.bar_cos_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>1 - cos dist</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.closest_point">
<code class="descclassname">vtool.distance.</code><code class="descname">closest_point</code><span class="sig-paren">(</span><em>pt</em>, <em>pt_arr</em>, <em>distfunc=&lt;function L2_sqrd&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#closest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.closest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)
pt = np.array([1])
pt_arr = np.array([1.1, 2, .95, 20])[:, None]
distfunc = vt.L2_sqrd</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.compute_distances">
<code class="descclassname">vtool.distance.</code><code class="descname">compute_distances</code><span class="sig-paren">(</span><em>hist1, hist2, dist_list=['L1', 'L2']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#compute_distances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.compute_distances" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist1</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>hist2</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>dist_list</strong> (<em>list</em>) &#8211; (default = [&#8216;L1&#8217;, &#8216;L2&#8217;])</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dist_dict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-compute_distances
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;L1&#39;</span><span class="p">,</span> <span class="s">&#39;L2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_dict</span> <span class="o">=</span> <span class="n">compute_distances</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">,</span> <span class="n">dist_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">dist_dict</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">{</span>
<span class="go">    &#39;L1&#39;: np.array([ 0.,  1.,  4.], dtype=np.float64),</span>
<span class="go">    &#39;L2&#39;: np.array([ 0.   ,  1.   ,  2.828], dtype=np.float64),</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.cos_sift">
<code class="descclassname">vtool.distance.</code><code class="descname">cos_sift</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cos_sift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.cos_sift" title="Permalink to this definition">¶</a></dt>
<dd><p>cos dist</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-cos_sift
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_dist</span> <span class="o">=</span> <span class="n">cos_sift</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">l2_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.77,  0.74,  0.72,  0.74,  0.72,  0.75,  0.71,  0.72,  0.74,  0.68], dtype=np.float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.cosine_dist">
<code class="descclassname">vtool.distance.</code><code class="descname">cosine_dist</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#cosine_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.cosine_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.det_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">det_distance</code><span class="sig-paren">(</span><em>det1</em>, <em>det2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#det_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.det_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaledist</span> <span class="o">=</span> <span class="n">det_distance</span><span class="p">(</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">scaledist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 1.03,  1.19,  1.21, ...,  1.25,  1.83,  1.43], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth::</dt>
<dd><p class="first">#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=1] det1
np.ndarray[np.float64_t, ndim=1] det2</div></blockquote>
<p>#if CYTH
# TODO: Move to ktool?
cdef unsigned int nDets = det1.shape[0]
# Prealloc output
out = np.zeros((nDets,), dtype=det1.dtype)
cdef size_t ix
for ix in range(nDets):</p>
<blockquote>
<div><p># simple determinant: ad - bc
if det1[ix] &gt; det2[ix]:</p>
<blockquote>
<div>out[ix] = det1[ix] / det2[ix]</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>out[ix] = det2[ix] / det1[ix]</dd>
</dl>
</div></blockquote>
<p class="last">return out
#else</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.emd">
<code class="descclassname">vtool.distance.</code><code class="descname">emd</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em>, <em>cost_matrix='sift'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#emd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.emd" title="Permalink to this definition">¶</a></dt>
<dd><p>earth mover&#8217;s distance by robjects(lpSovle::lp.transport)
require: lpsolve55-5.5.0.9.win32-py2.7.exe</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-emd
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span> <span class="o">=</span> <span class="n">testdata_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emd_dists</span> <span class="o">=</span> <span class="n">emd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">emd_dists</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 2063.99,  2078.02,  2109.03,  2011.99,  2130.99,  2089.01,</span>
<span class="go">           2030.99,  2294.98,  2026.02,  2426.01], dtype=np.float64)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>pip install pyemd
<a class="reference external" href="https://github.com/andreasjansson/python-emd">https://github.com/andreasjansson/python-emd</a>
<a class="reference external" href="http://www.cs.huji.ac.il/~werman/Papers/ECCV2008.pdf">http://www.cs.huji.ac.il/~werman/Papers/ECCV2008.pdf</a>
<a class="reference external" href="http://stackoverflow.com/questions/15706339/how-to-compute-emd-for-2-numpy-arrays-i-e-histogram-using-opencv">http://stackoverflow.com/questions/15706339/how-to-compute-emd-for-2-numpy-arrays-i-e-histogram-using-opencv</a>
<a class="reference external" href="http://www.cs.huji.ac.il/~ofirpele/FastEMD/code/">http://www.cs.huji.ac.il/~ofirpele/FastEMD/code/</a>
<a class="reference external" href="http://www.cs.huji.ac.il/~ofirpele/publications/ECCV2008.pdf">http://www.cs.huji.ac.il/~ofirpele/publications/ECCV2008.pdf</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.hist_isect">
<code class="descclassname">vtool.distance.</code><code class="descname">hist_isect</code><span class="sig-paren">(</span><em>hist1</em>, <em>hist2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#hist_isect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.hist_isect" title="Permalink to this definition">¶</a></dt>
<dd><p>returns histogram intersection distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.nearest_point">
<code class="descclassname">vtool.distance.</code><code class="descname">nearest_point</code><span class="sig-paren">(</span><em>x, y, pts, conflict_mode='next', __next_counter=[0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#nearest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.nearest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
<p>TODO: depricate</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.ori_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">ori_distance</code><span class="sig-paren">(</span><em>ori1</em>, <em>ori2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the unsigned distance between two angles</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles">http://stackoverflow.com/questions/1878907/the-smallest-difference-between-2-angles</a></p>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#if CYTH
#CYTH_INLINE
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray ori1
np.ndarray ori2</div></blockquote>
<p class="last">#endif</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        TAU = np.pi * 2</span>
<span class="go">        np.random.seed(53)</span>
<span class="go">        ori1 = (np.random.rand(100000) * TAU) - np.pi</span>
<span class="go">        ori2 = (np.random.rand(100000) * TAU) - np.pi</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>def func_outvars():</dt>
<dd>ori_dist = np.abs(ori1 - ori2)
np.mod(ori_dist, TAU, out=ori_dist)
np.minimum(ori_dist, np.subtract(TAU, ori_dist), out=ori_dist)
return ori_dist</dd>
<dt>def func_orig():</dt>
<dd>ori_dist = np.abs(ori1 - ori2) % TAU
ori_dist = np.minimum(ori_dist, TAU - ori_dist)
return ori_dist</dd>
</dl>
<p>&#8216;&#8217;&#8216;)</p>
</div></blockquote>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        func_outvars()</span>
<span class="go">        func_orig()</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-ori_distance
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ori2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.3,  1.4,  0.6,  0.3, -0.5,  0.9, -0.4,  2.5,  2.9, -0.7], dtype=np.float64)</span>
<span class="go">np.array([ 1.8,  0.2,  0.4,  2.7, -2.7, -2.6, -3. ,  2.1,  1.7,  2.3], dtype=np.float64)</span>
<span class="go">np.array([ 1.5,  1.2,  0.2,  2.4,  2.2,  2.8,  2.6,  0.4,  1.2,  3.1], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="mf">7.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">3.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">6.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.22,  1.72,  0.  ,  0.08], dtype=np.float64)</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="o">.</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="mf">6.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.float64(0.21681469282041377)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.signed_ori_distance">
<code class="descclassname">vtool.distance.</code><code class="descname">signed_ori_distance</code><span class="sig-paren">(</span><em>ori1</em>, <em>ori2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#signed_ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.signed_ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ori1</strong> &#8211; </li>
<li><strong>ori2</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ori_dist</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><p>?</p>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --exec-signed_ori_distance
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_dist</span> <span class="o">=</span> <span class="n">signed_ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;ori_dist = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ori_dist</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">ori_dist = np.array([ 3.   , -2.283, -3.   ,  2.283, -3.142,  3.042], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.testdata_hist">
<code class="descclassname">vtool.distance.</code><code class="descname">testdata_hist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#testdata_hist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.testdata_hist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.distance.understanding_pseudomax_props">
<code class="descclassname">vtool.distance.</code><code class="descname">understanding_pseudomax_props</code><span class="sig-paren">(</span><em>mode=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/distance.html#understanding_pseudomax_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.understanding_pseudomax_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Function showing some properties of distances between normalized pseudomax vectors</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.distance --test-understanding_pseudomax_props
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.distance</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;+---&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;mode = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">understanding_pseudomax_props</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;L___&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.ellipse">
<span id="vtool-ellipse-module"></span><h2>vtool.ellipse module<a class="headerlink" href="#module-vtool.ellipse" title="Permalink to this headline">¶</a></h2>
<p>OLD MODULE, needs reimplemenetation of select features and deprication</p>
<p>This module should handle all things elliptical</p>
<dl class="function">
<dt id="vtool.ellipse.adaptive_scale">
<code class="descclassname">vtool.ellipse.</code><code class="descname">adaptive_scale</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>kpts</em>, <em>nScales=4</em>, <em>low=-0.5</em>, <em>high=0.5</em>, <em>nSamples=16</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#adaptive_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.adaptive_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.check_kpts_in_bounds">
<code class="descclassname">vtool.ellipse.</code><code class="descname">check_kpts_in_bounds</code><span class="sig-paren">(</span><em>kpts_</em>, <em>width</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#check_kpts_in_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.check_kpts_in_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.circular_distance">
<code class="descclassname">vtool.ellipse.</code><code class="descname">circular_distance</code><span class="sig-paren">(</span><em>arr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#circular_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.circular_distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_kpts">
<code class="descclassname">vtool.ellipse.</code><code class="descname">expand_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>scales</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_scales">
<code class="descclassname">vtool.ellipse.</code><code class="descname">expand_scales</code><span class="sig-paren">(</span><em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_scales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_subscales">
<code class="descclassname">vtool.ellipse.</code><code class="descname">expand_subscales</code><span class="sig-paren">(</span><em>kpts</em>, <em>subscale_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#expand_subscales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_subscales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.extrema_neighbors">
<code class="descclassname">vtool.ellipse.</code><code class="descname">extrema_neighbors</code><span class="sig-paren">(</span><em>extrema_list</em>, <em>nBins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#extrema_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.extrema_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.find_maxima">
<code class="descclassname">vtool.ellipse.</code><code class="descname">find_maxima</code><span class="sig-paren">(</span><em>y_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.find_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.find_maxima_with_neighbors">
<code class="descclassname">vtool.ellipse.</code><code class="descname">find_maxima_with_neighbors</code><span class="sig-paren">(</span><em>scalar_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima_with_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.find_maxima_with_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.gradient_magnitude">
<code class="descclassname">vtool.ellipse.</code><code class="descname">gradient_magnitude</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#gradient_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.homogenous_circle_pts">
<code class="descclassname">vtool.ellipse.</code><code class="descname">homogenous_circle_pts</code><span class="sig-paren">(</span><em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#homogenous_circle_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.homogenous_circle_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a list of homogenous circle points</p>
</dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_between">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_between</code><span class="sig-paren">(</span><em>peak_list</em>, <em>nScales</em>, <em>high</em>, <em>low</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_between"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_between" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_maxima">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_maxima</code><span class="sig-paren">(</span><em>scalar_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_peaks">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_peaks</code><span class="sig-paren">(</span><em>x_data_list</em>, <em>y_data_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_peaks2">
<code class="descclassname">vtool.ellipse.</code><code class="descname">interpolate_peaks2</code><span class="sig-paren">(</span><em>x_data_list</em>, <em>y_data_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.kpts_matrices">
<code class="descclassname">vtool.ellipse.</code><code class="descname">kpts_matrices</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.kpts_matrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_ell_border_pts">
<code class="descclassname">vtool.ellipse.</code><code class="descname">sample_ell_border_pts</code><span class="sig-paren">(</span><em>expanded_kpts</em>, <em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_ell_border_vals">
<code class="descclassname">vtool.ellipse.</code><code class="descname">sample_ell_border_vals</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>expanded_kpts</em>, <em>nKp</em>, <em>nScales</em>, <em>nSamples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_uniform">
<code class="descclassname">vtool.ellipse.</code><code class="descname">sample_uniform</code><span class="sig-paren">(</span><em>kpts</em>, <em>nSamples=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#sample_uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_uniform" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SeeAlso:</dt>
<dd>python -m pyhesaff.tests.test_ellipse &#8211;test-in_depth_ellipse &#8211;show</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.ellipse.subscale_peaks">
<code class="descclassname">vtool.ellipse.</code><code class="descname">subscale_peaks</code><span class="sig-paren">(</span><em>border_vals_sum</em>, <em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/ellipse.html#subscale_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.subscale_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.exif">
<span id="vtool-exif-module"></span><h2>vtool.exif module<a class="headerlink" href="#module-vtool.exif" title="Permalink to this headline">¶</a></h2>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.exiv2.org/tags.html">http://www.exiv2.org/tags.html</a></p>
<dl class="function">
<dt id="vtool.exif.check_exif_keys">
<code class="descclassname">vtool.exif.</code><code class="descname">check_exif_keys</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#check_exif_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.check_exif_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.convert_degrees">
<code class="descclassname">vtool.exif.</code><code class="descname">convert_degrees</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#convert_degrees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.convert_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert the GPS coordinates stored in the EXIF to degress in float format</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Geographic_coordinate_conversion">http://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_dict">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exif_dict</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAGID</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_dict2">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exif_dict2</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_dict2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAG (less efficient)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_tagids">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exif_tagids</code><span class="sig-paren">(</span><em>tag_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exif_tagids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_tagids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exist">
<code class="descclassname">vtool.exif.</code><code class="descname">get_exist</code><span class="sig-paren">(</span><em>data</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_exist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.get_lat_lon">
<code class="descclassname">vtool.exif.</code><code class="descname">get_lat_lon</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=(-1</em>, <em>-1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_lat_lon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided exif_data2 (obtained through exif_data2 above)</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.exif --test-get_lat_lon
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latlon</span> <span class="o">=</span> <span class="n">get_lat_lon</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latlon</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 41.89   12.486]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_unixtime">
<code class="descclassname">vtool.exif.</code><code class="descname">get_unixtime</code><span class="sig-paren">(</span><em>exif_dict</em>, <em>default=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Exif.Image.TimeZoneOffset</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exif_dict</span> <span class="o">=</span> <span class="n">get_exif_dict</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.make_exif_dict_human_readable">
<code class="descclassname">vtool.exif.</code><code class="descname">make_exif_dict_human_readable</code><span class="sig-paren">(</span><em>exif_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#make_exif_dict_human_readable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.make_exif_dict_human_readable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.parse_exif_unixtime">
<code class="descclassname">vtool.exif.</code><code class="descname">parse_exif_unixtime</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.parse_exif_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_fpath</strong> (<em>str</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unixtime</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.exif --test-parse_exif_unixtime
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unixtime</span> <span class="o">=</span> <span class="n">parse_exif_unixtime</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unixtime</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">1325351249</span>
</pre></div>
</div>
<p>1325369249.0</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.read_all_exif_tags">
<code class="descclassname">vtool.exif.</code><code class="descname">read_all_exif_tags</code><span class="sig-paren">(</span><em>pil_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_all_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_all_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_exif">
<code class="descclassname">vtool.exif.</code><code class="descname">read_exif</code><span class="sig-paren">(</span><em>fpath</em>, <em>tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_exif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_exif_tags">
<code class="descclassname">vtool.exif.</code><code class="descname">read_exif_tags</code><span class="sig-paren">(</span><em>pil_img</em>, <em>exif_tagid_list</em>, <em>default_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_one_exif_tag">
<code class="descclassname">vtool.exif.</code><code class="descname">read_one_exif_tag</code><span class="sig-paren">(</span><em>pil_img</em>, <em>tag</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/exif.html#read_one_exif_tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_one_exif_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.features">
<span id="vtool-features-module"></span><h2>vtool.features module<a class="headerlink" href="#module-vtool.features" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.features.detect_opencv_keypoints">
<code class="descclassname">vtool.features.</code><code class="descname">detect_opencv_keypoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#detect_opencv_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.detect_opencv_keypoints" title="Permalink to this definition">¶</a></dt>
<dd><p>import cv2
import vtool as vt
img_fpath = ut.grab_test_imgpath(ut.get_argval(&#8216;&#8211;fname&#8217;, default=&#8217;lena.png&#8217;))
imgBGR = vt.imread(img_fpath)
gray = cv2.cvtColor(imgBGR, cv2.COLOR_BGR2GRAY)
x = cv2.cornerHarris(gray,2,3,0.04)</p>
<p>orb = cv2.ORB()
kp1, des1 = orb.detectAndCompute(gray, None)</p>
<p>[name for name in dir(cv2) if &#8216;detect&#8217; in name.lower()]
[name for name in dir(cv2) if &#8216;extract&#8217; in name.lower()]
[name for name in dir(cv2) if &#8216;ellip&#8217; in name.lower()]</p>
<p>sift = cv2.xfeatures2d.SIFT_create()
cv2_kpts = sift.detect(gray)
desc = sift.compute(gray, cv2_kpts)[1]</p>
<p>freak = cv2.xfeatures2d.FREAK_create()
cv2_kpts = freak.detect(gray)
desc = freak.compute(gray, cv2_kpts)[1]</p>
<p>blober = cv2.SimpleBlobDetector_create()</p>
<dl class="docutils">
<dt>def convert_cv2_keypoint(cv2_kp):</dt>
<dd>kp = (cv2_kp.pt[0], cv2_kp.pt[1], cv2_kp.size, 0, cv2_kp.size, cv2_kp.angle)
return kp</dd>
</dl>
<p>kpts = np.array(map(convert_cv2_keypoint, cv2_kpts))</p>
</dd></dl>

<dl class="function">
<dt id="vtool.features.extract_features">
<code class="descclassname">vtool.features.</code><code class="descname">extract_features</code><span class="sig-paren">(</span><em>img_or_fpath</em>, <em>feat_type='hesaff+sift'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>calls pyhesaff&#8217;s main driver function for detecting hessian affine keypoints.
extra parameters can be passed to the hessian affine detector by using
kwargs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_or_fpath</strong> (<em>str</em>) &#8211; image file path on disk</li>
<li><strong>use_adaptive_scale</strong> (<em>bool</em>) &#8211; </li>
<li><strong>nogravity_hack</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(kpts, vecs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.features --test-extract_features
python -m vtool.features --test-extract_features --show
python -m vtool.features --test-extract_features --feat-type<span class="o">=</span>hesaff+siam128 --show
python -m vtool.features --test-extract_features --feat-type<span class="o">=</span>hesaff+siam128 --show
python -m vtool.features --test-extract_features --feat-type<span class="o">=</span>hesaff+siam128 --show --no-affine-invariance
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--fname&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat_type</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--feat_type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;hesaff+sift&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">parse_dict_from_argv</span><span class="p">(</span><span class="n">pyhesaff</span><span class="o">.</span><span class="n">get_hesaff_default_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#(kpts, vecs) = extract_features(img_fpath)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Show keypoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.figure(fnum=1, doclf=True, docla=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.imshow(imgBGR)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_kpts2(kpts, ori=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">interact_keypoints</span><span class="o">.</span><span class="n">ishow_keypoints</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ell_alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;distinct&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.features.get_extract_features_default_params">
<code class="descclassname">vtool.features.</code><code class="descname">get_extract_features_default_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/features.html#get_extract_features_default_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.get_extract_features_default_params" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.features --test-get_extract_features_default_params
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_dict</span> <span class="o">=</span> <span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.geometry">
<span id="vtool-geometry-module"></span><h2>vtool.geometry module<a class="headerlink" href="#module-vtool.geometry" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.geometry.bbox_center">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_center</code><span class="sig-paren">(</span><em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_center" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.bbox_from_verts">
<code class="descclassname">vtool.geometry.</code><code class="descname">bbox_from_verts</code><span class="sig-paren">(</span><em>verts</em>, <em>castint=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bbox_from_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_from_verts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.bboxes_from_vert_list">
<code class="descclassname">vtool.geometry.</code><code class="descname">bboxes_from_vert_list</code><span class="sig-paren">(</span><em>verts_list</em>, <em>castint=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#bboxes_from_vert_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bboxes_from_vert_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the bounding polygon inside a rectangle</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.draw_border">
<code class="descclassname">vtool.geometry.</code><code class="descname">draw_border</code><span class="sig-paren">(</span><em>img_in</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_border"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.draw_border" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_in</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>color</strong> (<em>tuple</em>) &#8211; in bgr</li>
<li><strong>thickness</strong> (<em>int</em>) &#8211; </li>
<li><strong>out</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.geometry --test-draw_border --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_border</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.draw_verts">
<code class="descclassname">vtool.geometry.</code><code class="descname">draw_verts</code><span class="sig-paren">(</span><em>img_in</em>, <em>verts</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#draw_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.draw_verts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_in</strong> &#8211; </li>
<li><strong>verts</strong> &#8211; </li>
<li><strong>color</strong> (<em>tuple</em>) &#8211; </li>
<li><strong>thickness</strong> (<em>int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">img -  image data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[uint8_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.geometry --test-draw_verts --show
python -m vtool.geometry --test-draw_verts:0 --show
python -m vtool.geometry --test-draw_verts:1 --show
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/drawing_functions.html#line">http://docs.opencv.org/modules/core/doc/drawing_functions.html#line</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.verts_from_bbox">
<code class="descclassname">vtool.geometry.</code><code class="descname">verts_from_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>close=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bbox</strong> (<em>tuple</em>) &#8211; bounding box in the format (x, y, w, h)</li>
<li><strong>close</strong> (<em>bool</em>) &#8211; (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">verts</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.geometry --test-verts_from_bbox
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">close</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="n">verts_from_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">close</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;verts = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">verts</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">verts = ((10, 10), (60, 10), (60, 60), (10, 60))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.verts_list_from_bboxes_list">
<code class="descclassname">vtool.geometry.</code><code class="descname">verts_list_from_bboxes_list</code><span class="sig-paren">(</span><em>bboxes_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/geometry.html#verts_list_from_bboxes_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.verts_list_from_bboxes_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a four-vertex polygon from the bounding rectangle</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.histogram">
<span id="vtool-histogram-module"></span><h2>vtool.histogram module<a class="headerlink" href="#module-vtool.histogram" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.histogram.get_histinfo_str">
<code class="descclassname">vtool.histogram.</code><code class="descname">get_histinfo_str</code><span class="sig-paren">(</span><em>hist</em>, <em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#get_histinfo_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.get_histinfo_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_argmaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">hist_argmaxima</code><span class="sig-paren">(</span><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_argmaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>must take positive only values</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-hist_argmaxima
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 2.75]), array([ 34.62]), array([4]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_edges_to_centers">
<code class="descclassname">vtool.histogram.</code><code class="descname">hist_edges_to_centers</code><span class="sig-paren">(</span><em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_edges_to_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_edges_to_centers" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.71</span><span class="p">,</span> <span class="mf">5.50</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[-0.395  0.395  1.18   1.965  2.75   3.535  4.32   5.105  5.89   6.675]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_interpolated_submaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">hist_interpolated_submaxima</code><span class="sig-paren">(</span><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#hist_interpolated_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_interpolated_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>centers</strong> (<em>list</em>) &#8211; </li>
<li><strong>maxima_thresh</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(submaxima_x, submaxima_y)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-hist_interpolated_submaxima
python -m vtool.histogram --test-hist_interpolated_submaxima --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">hist_interpolated_submaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 3.0318792]), array([ 37.19208239]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="p">[</span><span class="mf">700.413</span><span class="p">,</span> <span class="mf">1680.93</span><span class="p">,</span> <span class="mf">823.31</span><span class="p">,</span> <span class="mf">521.934</span><span class="p">,</span> <span class="mf">721.44</span><span class="p">,</span> <span class="mf">777.964</span><span class="p">,</span> <span class="mf">483.108</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">178.108</span><span class="p">,</span> <span class="mf">243.603</span><span class="p">,</span> <span class="mf">1089.18</span><span class="p">,</span> <span class="mf">2546.99</span><span class="p">,</span> <span class="mf">306.315</span><span class="p">,</span> <span class="mf">210.7</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">277.306</span><span class="p">,</span> <span class="mf">653.927</span><span class="p">,</span> <span class="mf">805.233</span><span class="p">,</span> <span class="mf">537.68</span><span class="p">,</span> <span class="mf">625.399</span><span class="p">,</span> <span class="mf">738.363</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">1572.03</span><span class="p">,</span> <span class="mf">406.922</span><span class="p">,</span> <span class="mf">277.89</span><span class="p">,</span> <span class="mf">172.177</span><span class="p">,</span> <span class="mf">387.935</span><span class="p">,</span> <span class="mf">376.248</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">218.595</span><span class="p">,</span> <span class="mf">195.206</span><span class="p">,</span> <span class="mf">222.028</span><span class="p">,</span> <span class="mf">588.637</span><span class="p">,</span> <span class="mf">376.1</span><span class="p">,</span> <span class="mf">193.714</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">175.754</span><span class="p">,</span> <span class="mf">299.887</span><span class="p">,</span> <span class="mf">446.97</span><span class="p">,</span> <span class="mf">275.423</span><span class="p">,</span> <span class="mf">194.888</span><span class="p">,</span> <span class="mf">700.413</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">1680.93</span><span class="p">,</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.169816</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.169816</span><span class="p">,</span> <span class="mf">0.339631</span><span class="p">,</span> <span class="mf">0.509447</span><span class="p">,</span> <span class="mf">0.679263</span><span class="p">,</span> <span class="mf">0.849078</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">1.01889</span><span class="p">,</span> <span class="mf">1.18871</span><span class="p">,</span> <span class="mf">1.35853</span><span class="p">,</span> <span class="mf">1.52834</span><span class="p">,</span> <span class="mf">1.69816</span><span class="p">,</span> <span class="mf">1.86797</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">2.03779</span><span class="p">,</span> <span class="mf">2.2076</span><span class="p">,</span> <span class="mf">2.37742</span><span class="p">,</span> <span class="mf">2.54724</span><span class="p">,</span> <span class="mf">2.71705</span><span class="p">,</span> <span class="mf">2.88687</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">3.05668</span><span class="p">,</span> <span class="mf">3.2265</span><span class="p">,</span> <span class="mf">3.39631</span><span class="p">,</span> <span class="mf">3.56613</span><span class="p">,</span> <span class="mf">3.73595</span><span class="p">,</span> <span class="mf">3.90576</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">4.07558</span><span class="p">,</span> <span class="mf">4.24539</span><span class="p">,</span> <span class="mf">4.41521</span><span class="p">,</span> <span class="mf">4.58502</span><span class="p">,</span> <span class="mf">4.75484</span><span class="p">,</span> <span class="mf">4.92465</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">5.09447</span><span class="p">,</span> <span class="mf">5.26429</span><span class="p">,</span> <span class="mf">5.4341</span><span class="p">,</span> <span class="mf">5.60392</span><span class="p">,</span> <span class="mf">5.77373</span><span class="p">,</span> <span class="mf">5.94355</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">6.11336</span><span class="p">,</span> <span class="mf">6.28318</span><span class="p">,</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">hist_interpolated_submaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.interpolate_submaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">interpolate_submaxima</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolate_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.interpolate_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-interpolate_submaxima --show
</pre></div>
</div>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>what happens when argmaxima[i] == len(hist)</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span> <span class="o">=</span> <span class="n">interpolate_submaxima</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ensure_fnum</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="s">&#39;-x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(array([ 0.14597723,  3.0318792 ]), array([  9.20251557,  37.19208239]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.interpolated_histogram">
<code class="descclassname">vtool.histogram.</code><code class="descname">interpolated_histogram</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em>, <em>range_</em>, <em>bins</em>, <em>interpolation_wrap=True</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#interpolated_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.interpolated_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Follows np.histogram, but does interpolation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>range</strong> (<em>tuple</em>) &#8211; range from 0 to 1</li>
<li><strong>bins</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-interpolated_histogram
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>#Example2:
#    &gt;&gt;&gt; # ENABLE_DOCTEST
#    &gt;&gt;&gt; from vtool.histogram import *  # NOQA
#    &gt;&gt;&gt; # build test data
#    &gt;&gt;&gt; data    = np.random.rand(10)
#    &gt;&gt;&gt; weights = np.random.rand(10)
#    &gt;&gt;&gt; <a href="#id17"><span class="problematic" id="id18">range_</span></a> = (0, 1)
#    &gt;&gt;&gt; bins = np.random.randint(2) + 1 + np.random.randint(2) * 100
#    &gt;&gt;&gt; interpolation_wrap = True
#    &gt;&gt;&gt; # execute function
#    &gt;&gt;&gt; hist, edges = interpolated_histogram(data, weights, <a href="#id19"><span class="problematic" id="id20">range_</span></a>, bins, interpolation_wrap)
#    &gt;&gt;&gt; assert np.abs(hist.sum() - weights.sum()) &lt; 1E-9
#    &gt;&gt;&gt; assert hist.size == bins
#    &gt;&gt;&gt; assert edges.size == bins + 1
#    &gt;&gt;&gt; result = get_histinfo_str(hist, edges)
#    &gt;&gt;&gt; print(result)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.maxima_neighbors">
<code class="descclassname">vtool.histogram.</code><code class="descname">maxima_neighbors</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maxima_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.maxima_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.maximum_parabola_point">
<code class="descclassname">vtool.histogram.</code><code class="descname">maximum_parabola_point</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#maximum_parabola_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.maximum_parabola_point" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.readable_interpolate_submaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">readable_interpolate_submaxima</code><span class="sig-paren">(</span><em>argmaxima</em>, <em>hist</em>, <em>centers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#readable_interpolate_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.readable_interpolate_submaxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_hist_submaxima">
<code class="descclassname">vtool.histogram.</code><code class="descname">show_hist_submaxima</code><span class="sig-paren">(</span><em>hist_</em>, <em>edges=None</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_hist_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_hist_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>For C++ to show data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hist</strong> &#8211; </li>
<li><strong>edges</strong> (<em>None</em>) &#8211; </li>
<li><strong>centers</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-show_hist_submaxima --show
python -m pyhesaff._pyhesaff --test-test_rot_invar --show
python -m vtool.histogram --test-show_hist_submaxima --dpath figures --save ~/latex/crall-candidacy-2015/figures/show_hist_submaxima.jpg
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--hist&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--maxima_thresh&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_hist_submaxima</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_ori_image">
<code class="descclassname">vtool.histogram.</code><code class="descname">show_ori_image</code><span class="sig-paren">(</span><em>gori</em>, <em>weights</em>, <em>patch</em>, <em>gradx=None</em>, <em>grady=None</em>, <em>gauss=None</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_ori_image" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m pyhesaff._pyhesaff &#8211;test-test_rot_invar &#8211;show &#8211;nocpp</p>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_ori_image_ondisk">
<code class="descclassname">vtool.histogram.</code><code class="descname">show_ori_image_ondisk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_ori_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>ori</strong> &#8211; </li>
<li><strong>gmag</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-show_ori_image_ondisk --show

python -m vtool.histogram --test-show_ori_image_ondisk --show --patch_img_fpath patches/KP_0_PATCH.png --ori_img_fpath patches/KP_0_orientations01.png --weights_img_fpath patches/KP_0_WEIGHTS.png --grady_img_fpath patches/KP_0_ygradient.png --gradx_img_fpath patches/KP_0_xgradient.png --title cpp_show_ori_ondisk

python -m pyhesaff._pyhesaff --test-test_rot_invar --show --rebuild-hesaff --no-rmbuild
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_ori_image_ondisk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.subbin_bounds">
<code class="descclassname">vtool.histogram.</code><code class="descname">subbin_bounds</code><span class="sig-paren">(</span><em>z</em>, <em>radius</em>, <em>low</em>, <em>high</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#subbin_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.subbin_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets quantized bounds of a sub-bin/pixel point and a radius.
Useful for cropping using subpixel points</p>
<dl class="docutils">
<dt>Illustration::</dt>
<dd><p class="first">(the bin edges are pipes)
(the bin centers are pluses)</p>
<p>Input = {&#8216;z&#8217;: 1.5, &#8216;radius&#8217;:5.666, &#8216;low&#8217;:0, &#8216;high&#8217;:7}
Output = {&#8216;z1&#8217;:0, &#8216;z2&#8217;: 7, &#8216;offst&#8217;: 5.66}</p>
<div class="line-block">
<div class="line">|   |   |   |   |   |   |   |</div>
</div>
<dl class="last docutils">
<dt><a href="#id11"><span class="problematic" id="id12">|_+_|_+_|_+_|_+_|_+_|_+_|_+_|_+_|</span></a></dt>
<dd><p class="first">^     ^                     ^
z1    z                     z2</p>
<blockquote>
<div>,.___.___.___.___.___.   &lt; radius (5.333)</div></blockquote>
<dl class="docutils">
<dt>.&#8212;.-,                        &lt; z_offset1 (1.6666)</dt>
<dd>,_.___.___.___.___.___.  &lt; z_offset2 (5.666)</dd>
</dl>
<p class="last">.&#8212;.-,                        &lt; z_offset1 (1.6666)</p>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>float</em>) &#8211; center of a circle a 1d pixel array</li>
<li><strong>radius</strong> (<em>float</em>) &#8211; radius of the circle</li>
<li><strong>low</strong> (<em>int</em>) &#8211; minimum index of 1d pixel array</li>
<li><strong>high</strong> (<em>int</em>) &#8211; maximum index of 1d pixel array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(iz1, iz2, z_offst) - quantized_bounds and subbin_offset
iz1 - low radius endpoint
iz2 - high radius endpoint
z_offst - subpixel offset
#Returns: quantized_bounds=(iz1, iz2), subbin_offset</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-subbin_bounds
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.666</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">)</span> <span class="o">=</span> <span class="n">subbin_bounds</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 7, 1.5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.wrap_histogram">
<code class="descclassname">vtool.histogram.</code><code class="descname">wrap_histogram</code><span class="sig-paren">(</span><em>hist_</em>, <em>edges_</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/histogram.html#wrap_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.wrap_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates the first and last histogram bin being being adjacent to one another
by replicating those bins at the last and first positions respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hist</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>edges</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(hist_wrap, edge_wrap)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.histogram --test-wrap_histogram
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>  <span class="mf">8.</span>  <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">34.32</span><span class="p">,</span>  <span class="mf">29.45</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>   <span class="mf">6.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.78539816</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">2.35619449</span><span class="p">,</span>  <span class="mf">3.14159265</span><span class="p">,</span>  <span class="mf">3.92699081</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">4.71238898</span><span class="p">,</span>  <span class="mf">5.49778714</span><span class="p">,</span>  <span class="mf">6.2831853</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist_wrap</span><span class="p">,</span> <span class="n">edge_wrap</span><span class="p">)</span> <span class="o">=</span> <span class="n">wrap_histogram</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgewrap_str</span> <span class="o">=</span>  <span class="s">&#39;[&#39;</span> <span class="o">+</span>  <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">edge_wrap</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;]&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">histwrap_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">hist_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">histwrap_str</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">NEWLINE</span> <span class="o">+</span> <span class="n">edgewrap_str</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[6.73, 8.0, 0.0, 0.0, 34.32, 29.45, 0.0, 0.0, 6.73, 8.0]</span>
<span class="go">[-0.79, 0.00, 0.79, 1.57, 2.36, 3.14, 3.93, 4.71, 5.50, 6.28, 7.07]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.image">
<span id="vtool-image-module"></span><h2>vtool.image module<a class="headerlink" href="#module-vtool.image" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.image.affine_warp_around_center">
<code class="descclassname">vtool.image.</code><code class="descname">affine_warp_around_center</code><span class="sig-paren">(</span><em>img</em>, <em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em>, <em>dsize=None</em>, <em>borderMode=0</em>, <em>flags=4</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#affine_warp_around_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.affine_warp_around_center" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-affine_warp_around_center --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shear</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ty</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_warped</span> <span class="o">=</span> <span class="n">affine_warp_around_center</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sy</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="o">=</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="o">=</span><span class="n">ty</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="n">dsize</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">borderMode</span><span class="o">=</span><span class="n">borderMode</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">img_warped</span> <span class="o">*</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.clipwhite_ondisk">
<code class="descclassname">vtool.image.</code><code class="descname">clipwhite_ondisk</code><span class="sig-paren">(</span><em>fpath_in</em>, <em>fpath_out=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#clipwhite_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.clipwhite_ondisk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.combine_offset_lists">
<code class="descclassname">vtool.image.</code><code class="descname">combine_offset_lists</code><span class="sig-paren">(</span><em>offsets_list</em>, <em>sfs_list</em>, <em>offset_tups</em>, <em>sf_tups</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#combine_offset_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.combine_offset_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for stacking</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.convert_image_list_colorspace">
<code class="descclassname">vtool.image.</code><code class="descname">convert_image_list_colorspace</code><span class="sig-paren">(</span><em>image_list</em>, <em>colorspace</em>, <em>src_colorspace=u'BGR'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#convert_image_list_colorspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.convert_image_list_colorspace" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a list of images from &lt;src_colorspace&gt; to &lt;colorspace&gt;</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.crop_out_imgfill">
<code class="descclassname">vtool.image.</code><code class="descname">crop_out_imgfill</code><span class="sig-paren">(</span><em>img</em>, <em>fillval=None</em>, <em>thresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#crop_out_imgfill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.crop_out_imgfill" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops image to remove fillval</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>fillval</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>thresh</strong> (<em>int</em>) &#8211; (default = 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cropped_img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --exec-crop_out_imgfill
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_GRAY2RGB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2GRAY</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;cropped_img2 = </span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_stripe_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillval</span> <span class="o">=</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">crop_out_imgfill</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fillval</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;cropped_img = </span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cropped_img</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_BGR2L">
<code class="descclassname">vtool.image.</code><code class="descname">cvt_BGR2L</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2L"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_BGR2L" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_BGR2RGB">
<code class="descclassname">vtool.image.</code><code class="descname">cvt_BGR2RGB</code><span class="sig-paren">(</span><em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2RGB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_BGR2RGB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_bbox_xywh_to_pt1pt2">
<code class="descclassname">vtool.image.</code><code class="descname">cvt_bbox_xywh_to_pt1pt2</code><span class="sig-paren">(</span><em>xywh</em>, <em>sx=1.0</em>, <em>sy=1.0</em>, <em>round_=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#cvt_bbox_xywh_to_pt1pt2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_bbox_xywh_to_pt1pt2" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts bbox to thumb format with a scale factor</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.draw_text">
<code class="descclassname">vtool.image.</code><code class="descname">draw_text</code><span class="sig-paren">(</span><em>img, text, org, textcolor_rgb=[0, 0, 0], fontScale=1, thickness=2, fontFace=0, lineType=16, bottomLeftOrigin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#draw_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.draw_text" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-draw_text:0 --show
python -m vtool.image --test-draw_text:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font_names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cv2</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;FONT_H&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s">&#39;opencv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span> <span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">200</span><span class="p">:,</span> <span class="mi">512</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fontScale</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lineType</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_AA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">font_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">font_names</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span><span class="p">(</span><span class="n">font_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fontFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">font_name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">org</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">text</span> <span class="o">=</span> <span class="s">&#39;opencv - &#39;</span> <span class="o">+</span> <span class="n">font_name</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">fontFace</span><span class="o">=</span><span class="n">fontFace</span><span class="p">,</span> <span class="n">textcolor_rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="n">fontScale</span><span class="o">=</span><span class="n">fontScale</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>where each of the font IDs can be combined with FONT_ITALIC to get the slanted letters.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.embed_in_square_image">
<code class="descclassname">vtool.image.</code><code class="descname">embed_in_square_image</code><span class="sig-paren">(</span><em>img</em>, <em>target_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#embed_in_square_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.embed_in_square_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.ensure_3channel">
<code class="descclassname">vtool.image.</code><code class="descname">ensure_3channel</code><span class="sig-paren">(</span><em>patch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#ensure_3channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.ensure_3channel" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>patch</strong> (<em>ndarray[N, M, ...]</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">[N, M, 3]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --exec-ensure_3channel --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;ada.jpg&#39;</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;jeff.png&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">390</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">ensure_3channel</span><span class="p">(</span><span class="n">patch3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;failed test1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;failed test2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">res3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">patch3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;failed test3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">res2</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">res3</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.filterflags_valid_images">
<code class="descclassname">vtool.image.</code><code class="descname">filterflags_valid_images</code><span class="sig-paren">(</span><em>gpath_list</em>, <em>valid_formats=None</em>, <em>invalid_formats=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#filterflags_valid_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.filterflags_valid_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.find_pixel_value_index">
<code class="descclassname">vtool.image.</code><code class="descname">find_pixel_value_index</code><span class="sig-paren">(</span><em>img</em>, <em>pixel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#find_pixel_value_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.find_pixel_value_index" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>pixel</strong> (<em>ndarray or scalar</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-find_pixel_value_index
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition">http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">find_pixel_value_index</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 3]</span>
<span class="go"> [5 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_gpathlist_sizes">
<code class="descclassname">vtool.image.</code><code class="descname">get_gpathlist_sizes</code><span class="sig-paren">(</span><em>gpath_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_gpathlist_sizes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_gpathlist_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>reads the size of each image in gpath_list</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_num_channels">
<code class="descclassname">vtool.image.</code><code class="descname">get_num_channels</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_num_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_num_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of color channels</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_pixel_dist">
<code class="descclassname">vtool.image.</code><code class="descname">get_pixel_dist</code><span class="sig-paren">(</span><em>img</em>, <em>pixel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_pixel_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_pixel_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.get_round_scaled_dsize">
<code class="descclassname">vtool.image.</code><code class="descname">get_round_scaled_dsize</code><span class="sig-paren">(</span><em>dsize_old</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_round_scaled_dsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_round_scaled_dsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.get_scale_factor">
<code class="descclassname">vtool.image.</code><code class="descname">get_scale_factor</code><span class="sig-paren">(</span><em>src_img</em>, <em>dst_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_scale_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_scale_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>returns scale factor from one image to the next</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_size">
<code class="descclassname">vtool.image.</code><code class="descname">get_size</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image size in (width, height)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imread">
<code class="descclassname">vtool.image.</code><code class="descname">imread</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>delete_if_corrupted=False</em>, <em>grayscale=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imread" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_fpath</strong> &#8211; </li>
<li><strong>delete_if_corrupted</strong> (<em>bool</em>) &#8211; </li>
<li><strong>grayscale</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imgBGR</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-imread
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error">http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error</a>
<a class="reference external" href="http://stackoverflow.com/questions/23572241/cv2-threshold-error-210">http://stackoverflow.com/questions/23572241/cv2-threshold-error-210</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_if_corrupted</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grayscale</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">delete_if_corrupted</span><span class="p">,</span> <span class="n">grayscale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imwrite">
<code class="descclassname">vtool.image.</code><code class="descname">imwrite</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>imgBGR</em>, <em>fallback=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imwrite" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html">http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imwrite_fallback">
<code class="descclassname">vtool.image.</code><code class="descname">imwrite_fallback</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>imgBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#imwrite_fallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imwrite_fallback" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.infer_vert">
<code class="descclassname">vtool.image.</code><code class="descname">infer_vert</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>vert</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#infer_vert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.infer_vert" title="Permalink to this definition">¶</a></dt>
<dd><p>which is the better stack dimension</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.make_channels_comparable">
<code class="descclassname">vtool.image.</code><code class="descname">make_channels_comparable</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#make_channels_comparable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.make_channels_comparable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.open_image_size">
<code class="descclassname">vtool.image.</code><code class="descname">open_image_size</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#open_image_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.open_image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image size from an image on disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_fpath</strong> (<em>str</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">size (width, height)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-open_image_size
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;patsy.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">open_image_size</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;size = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">size = (800, 441)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.open_pil_image">
<code class="descclassname">vtool.image.</code><code class="descname">open_pil_image</code><span class="sig-paren">(</span><em>image_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#open_pil_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.open_pil_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.pad_image_on_disk">
<code class="descclassname">vtool.image.</code><code class="descname">pad_image_on_disk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>pad_</em>, <em>out_fpath=None</em>, <em>value=0</em>, <em>borderType=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#pad_image_on_disk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.pad_image_on_disk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.padded_resize">
<code class="descclassname">vtool.image.</code><code class="descname">padded_resize</code><span class="sig-paren">(</span><em>img</em>, <em>target_size=(64</em>, <em>64)</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#padded_resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.padded_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>makes the image resize to the target size and pads the rest of the area with a fill value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>target_size</strong> (<em>tuple</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-padded_resize --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgA</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgC</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">),</span> <span class="n">grayscale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#target_size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">padded_resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">target_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="p">[</span><span class="n">imgA</span><span class="p">,</span> <span class="n">imgB</span><span class="p">,</span> <span class="n">imgC</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_allsame</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img3</span><span class="p">)</span> <span class="k">for</span> <span class="n">img3</span> <span class="ow">in</span> <span class="n">img3_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnum_</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">make_pnum_nextgen</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum_</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.perlin_noise">
<code class="descclassname">vtool.image.</code><code class="descname">perlin_noise</code><span class="sig-paren">(</span><em>size</em>, <em>scale=32.0</em>, <em>rng=&lt;module 'numpy.random' from '/usr/local/lib/python2.7/dist-packages/numpy/random/__init__.pyc'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#perlin_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.perlin_noise" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.siafoo.net/snippet/229">http://www.siafoo.net/snippet/229</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-perlin_noise --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#size = (64, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#scale = 32.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mf">64.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">perlin_noise</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.print_image_checks">
<code class="descclassname">vtool.image.</code><code class="descname">print_image_checks</code><span class="sig-paren">(</span><em>img_fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#print_image_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.print_image_checks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.rectify_to_float01">
<code class="descclassname">vtool.image.</code><code class="descname">rectify_to_float01</code><span class="sig-paren">(</span><em>img</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_float01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rectify_to_float01" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.rectify_to_uint8">
<code class="descclassname">vtool.image.</code><code class="descname">rectify_to_uint8</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rectify_to_uint8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rectify_to_uint8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize">
<code class="descclassname">vtool.image.</code><code class="descname">resize</code><span class="sig-paren">(</span><em>img</em>, <em>dsize</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_image_by_scale">
<code class="descclassname">vtool.image.</code><code class="descname">resize_image_by_scale</code><span class="sig-paren">(</span><em>img</em>, <em>scale</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_image_by_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_image_by_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_imagelist_generator">
<code class="descclassname">vtool.image.</code><code class="descname">resize_imagelist_generator</code><span class="sig-paren">(</span><em>gpath_list</em>, <em>new_gpath_list</em>, <em>newsize_list</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_imagelist_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_imagelist_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes images and yeilds results asynchronously</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_imagelist_to_sqrtarea">
<code class="descclassname">vtool.image.</code><code class="descname">resize_imagelist_to_sqrtarea</code><span class="sig-paren">(</span><em>gpath_list</em>, <em>new_gpath_list=None</em>, <em>sqrt_area=800</em>, <em>output_dir=None</em>, <em>checkexists=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_imagelist_to_sqrtarea"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_imagelist_to_sqrtarea" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes images and yeilds results asynchronously</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_thumb">
<code class="descclassname">vtool.image.</code><code class="descname">resize_thumb</code><span class="sig-paren">(</span><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_thumb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an image such that its max width or height is:</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-resize_thumb --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_thumb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;img.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;img2.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_to_maxdims">
<code class="descclassname">vtool.image.</code><code class="descname">resize_to_maxdims</code><span class="sig-paren">(</span><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_to_maxdims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_to_maxdims" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>max_dsize</strong> (<em>tuple</em>) &#8211; </li>
<li><strong>interpolation</strong> (<em>long</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-resize_to_maxdims --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_dsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">resize_to_maxdims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">max_dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;img.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;img2.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_worker">
<code class="descclassname">vtool.image.</code><code class="descname">resize_worker</code><span class="sig-paren">(</span><em>tup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resize_worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_worker" title="Permalink to this definition">¶</a></dt>
<dd><p>worker function for parallel generator</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resized_clamped_thumb_dims">
<code class="descclassname">vtool.image.</code><code class="descname">resized_clamped_thumb_dims</code><span class="sig-paren">(</span><em>img_size</em>, <em>max_dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_clamped_thumb_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resized_clamped_thumb_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resized_dims_and_ratio">
<code class="descclassname">vtool.image.</code><code class="descname">resized_dims_and_ratio</code><span class="sig-paren">(</span><em>img_size</em>, <em>max_dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#resized_dims_and_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resized_dims_and_ratio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.rotate_image">
<code class="descclassname">vtool.image.</code><code class="descname">rotate_image</code><span class="sig-paren">(</span><em>img</em>, <em>theta</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rotate_image" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>theta</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-rotate_image
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="s">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">16.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">rotate_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span>  <span class="o">*</span> <span class="mi">255</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.rotate_image_on_disk">
<code class="descclassname">vtool.image.</code><code class="descname">rotate_image_on_disk</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>theta</em>, <em>out_fpath=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#rotate_image_on_disk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rotate_image_on_disk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img_fpath</strong> &#8211; </li>
<li><strong>theta</strong> &#8211; </li>
<li><strong>out_fpath</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-rotate_image_on_disk
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath_</span> <span class="o">=</span> <span class="n">rotate_image_on_disk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.scaled_verts_from_bbox">
<code class="descclassname">vtool.image.</code><code class="descname">scaled_verts_from_bbox</code><span class="sig-paren">(</span><em>bbox</em>, <em>theta</em>, <em>sx</em>, <em>sy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#scaled_verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.scaled_verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.scaled_verts_from_bbox_gen">
<code class="descclassname">vtool.image.</code><code class="descname">scaled_verts_from_bbox_gen</code><span class="sig-paren">(</span><em>bbox_list</em>, <em>theta_list</em>, <em>sx</em>, <em>sy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#scaled_verts_from_bbox_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.scaled_verts_from_bbox_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bbox_list</strong> (<em>list</em>) &#8211; bboxes in x,y,w,h format</li>
<li><strong>theta_list</strong> (<em>list</em>) &#8211; rotation of bounding boxes</li>
<li><strong>sx</strong> (<em>float</em>) &#8211; x scale factor</li>
<li><strong>sy</strong> (<em>float</em>) &#8211; y scale factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Yeilds:</dt>
<dd>new_verts - vertices of scaled bounding box for every input</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-scaled_verts_from_bbox_gen
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_verts_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scaled_verts_from_bbox_gen</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_verts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[5, 5], [55, 5], [55, 55], [5, 55], [5, 5]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.shear">
<code class="descclassname">vtool.image.</code><code class="descname">shear</code><span class="sig-paren">(</span><em>img</em>, <em>x_shear</em>, <em>y_shear</em>, <em>dsize=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#shear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.shear" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>x_shear</strong> &#8211; </li>
<li><strong>y_shear</strong> &#8211; </li>
<li><strong>dsize</strong> (<em>tuple</em>) &#8211; width, height</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-shear --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_shear</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_shear</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgSh</span> <span class="o">=</span> <span class="n">shear</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">x_shear</span><span class="p">,</span> <span class="n">y_shear</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgSh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_image_list">
<code class="descclassname">vtool.image.</code><code class="descname">stack_image_list</code><span class="sig-paren">(</span><em>img_list</em>, <em>return_offset=False</em>, <em>return_sf=False</em>, <em>return_info=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_image_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-stack_image_list --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">modifysize</span><span class="o">=</span><span class="n">modifysize</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">return_offset</span><span class="o">=</span><span class="n">return_offset</span><span class="p">,</span> <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="go">np.array([[   0.  ,   76.96,  141.08,  181.87,  246.  ],</span>
<span class="go">          [   0.  ,    0.  ,    0.  ,    0.  ,    0.  ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_image_list_special">
<code class="descclassname">vtool.image.</code><code class="descname">stack_image_list_special</code><span class="sig-paren">(</span><em>img1</em>, <em>img_list</em>, <em>num=1</em>, <em>vert=True</em>, <em>use_larger=True</em>, <em>initial_sf=None</em>, <em>interpolation=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_list_special"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_image_list_special" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO: add initial scale down factor?</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-stack_image_list_special --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list_</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">img_list_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_offset</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_larger</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_bot</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_sf</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span> <span class="o">=</span> <span class="n">stack_image_list_special</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img_list</span><span class="p">,</span> <span class="n">num_bot</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">use_larger</span><span class="p">,</span> <span class="n">initial_sf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">,</span> <span class="n">img_list</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">sf_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;imgB.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset_list</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_image_recurse">
<code class="descclassname">vtool.image.</code><code class="descname">stack_image_recurse</code><span class="sig-paren">(</span><em>img_list1</em>, <em>img_list2=None</em>, <em>vert=True</em>, <em>modifysize=False</em>, <em>return_offsets=False</em>, <em>interpolation=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_image_recurse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_image_recurse" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: return offsets as well</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img_list1</strong> (<em>list</em>) &#8211; </li>
<li><strong>img_list2</strong> (<em>list</em>) &#8211; </li>
<li><strong>vert</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-stack_image_recurse --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;ada.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;jeff.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img5</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">,</span> <span class="n">img4</span><span class="p">,</span> <span class="n">img5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list2</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">,</span> <span class="n">img_list2</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#wh1 = img1.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#wh2 = img2.shape[0:2][::-1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_bbox((0, 0) + wh1, bbox_color=(1, 0, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_bbox((woff, hoff) + wh2, bbox_color=(0, 1, 0))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_images">
<code class="descclassname">vtool.image.</code><code class="descname">stack_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>vert=None</em>, <em>modifysize=False</em>, <em>return_sf=False</em>, <em>use_larger=True</em>, <em>interpolation=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img1</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>img2</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-stack_images --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modifysize</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_sf</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#(imgB, woff, hoff) = stack_images(img1, img2, vert, modifysize, return_sf=return_sf)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgB</span><span class="p">,</span> <span class="n">offset2</span><span class="p">,</span> <span class="n">sf_tup</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="p">,</span> <span class="n">modifysize</span><span class="p">,</span> <span class="n">return_sf</span><span class="o">=</span><span class="n">return_sf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">offset2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">imgB</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imshow</span><span class="p">(</span><span class="n">imgB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img1</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img2</span><span class="p">),</span> <span class="n">sf_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">,</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">((762, 512, 3), (0.0, 0.0), (0, 250))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_multi_images">
<code class="descclassname">vtool.image.</code><code class="descname">stack_multi_images</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>offset_list1</em>, <em>sf_list1</em>, <em>offset_list2</em>, <em>sf_list2</em>, <em>vert=True</em>, <em>use_larger=False</em>, <em>modifysize=True</em>, <em>interpolation=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_multi_images" title="Permalink to this definition">¶</a></dt>
<dd><p>combines images that are already stacked</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_multi_images2">
<code class="descclassname">vtool.image.</code><code class="descname">stack_multi_images2</code><span class="sig-paren">(</span><em>multiimg_list</em>, <em>offsets_list</em>, <em>sfs_list</em>, <em>vert=True</em>, <em>modifysize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_multi_images2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_multi_images2" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>multiimg_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>offset_lists</strong> &#8211; </li>
<li><strong>sfs_list</strong> &#8211; </li>
<li><strong>vert</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(stacked_img, stacked_img, stacked_sfs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-stack_multi_images2 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">offset_list1</span><span class="p">,</span> <span class="n">sf_list1</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack2</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">sf_list2</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_stack3</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">,</span> <span class="n">sf_list3</span> <span class="o">=</span> <span class="n">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">modifysize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiimg_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">img_stack1</span><span class="p">,</span> <span class="n">img_stack2</span><span class="p">,</span> <span class="n">img_stack3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offsets_list</span>  <span class="o">=</span> <span class="p">[</span><span class="n">offset_list1</span><span class="p">,</span> <span class="n">offset_list2</span><span class="p">,</span> <span class="n">offset_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfs_list</span>      <span class="o">=</span> <span class="p">[</span><span class="n">sf_list1</span><span class="p">,</span> <span class="n">sf_list2</span><span class="p">,</span> <span class="n">sf_list3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vert</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">stack_multi_images2</span><span class="p">(</span><span class="n">multiimg_list</span><span class="p">,</span> <span class="n">offsets_list</span><span class="p">,</span> <span class="n">sfs_list</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">stacked_img</span><span class="p">,</span> <span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">stacked_sfs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">remove_doublspaces</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_line_width</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; ,&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stacked_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">img_list</span> <span class="o">+</span> <span class="n">img_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_list_</span> <span class="o">=</span> <span class="n">wh_list</span> <span class="o">*</span> <span class="n">stacked_sfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">wh</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">wh_list_</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stacked_offsets</span><span class="p">))):</span>
<span class="gp">... </span>   <span class="n">pt</span><span class="o">.</span><span class="n">draw_bbox</span><span class="p">((</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([[ 0., 0., 0., 0., 0., 512., 512., 512., 512., 512., 1024., 1024., 1024., 1024., 1024. ],</span>
<span class="go"> [ 0., 512.12, 1024.25, 1827., 2339., 0., 427., 939., 1742., 2254., 0., 250., 762., 1389., 1789. ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.stack_square_images">
<code class="descclassname">vtool.image.</code><code class="descname">stack_square_images</code><span class="sig-paren">(</span><em>img_list</em>, <em>return_info=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#stack_square_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.stack_square_images" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img_list</strong> (<em>list</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-stack_square_images
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stack_square_images</span><span class="p">(</span><span class="n">img_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.subpixel_values">
<code class="descclassname">vtool.image.</code><code class="descname">subpixel_values</code><span class="sig-paren">(</span><em>img</em>, <em>pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#subpixel_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.subpixel_values" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p>stackoverflow.com/uestions/12729228/simple-efficient-binlinear-interpolation-of-images-in-numpy-and-python</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>cv2.getRectSubPix(image, patchSize, center[, patch[, patchType]])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.testdata_imglist">
<code class="descclassname">vtool.image.</code><code class="descname">testdata_imglist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#testdata_imglist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.testdata_imglist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.warpAffine">
<code class="descclassname">vtool.image.</code><code class="descname">warpAffine</code><span class="sig-paren">(</span><em>img</em>, <em>Aff</em>, <em>dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpAffine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.warpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</li>
<li><strong>Aff</strong> (<em>ndarray</em>) &#8211; affine matrix</li>
<li><strong>dsize</strong> (<em>tuple</em>) &#8211; width, height</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">warped_img</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.image --test-warpAffine --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TAU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsize</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_size</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_img</span> <span class="o">=</span> <span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Aff</span><span class="p">,</span> <span class="n">dsize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd><p class="first">import skimage.transform
%timeit cv2.warpAffine(img, Aff[0:2], tuple(dsize), <a href="#id1"><span class="problematic" id="id2">**</span></a>CV2_WARP_KWARGS)
100 loops, best of 3: 7.95 ms per loop
skimage.transform.AffineTransform
tf = skimage.transform.AffineTransform(rotation=TAU / 8)
<a href="#id21"><span class="problematic" id="id22">Aff_</span></a> = tf.params
out = skimage.transform._warps_cy._warp_fast(img[:, :, 0], <a href="#id23"><span class="problematic" id="id24">Aff_</span></a>, output_shape=dsize, mode=&#8217;constant&#8217;, order=1)
%timeit skimage.transform._warps_cy._warp_fast(img[:, :, 0], <a href="#id25"><span class="problematic" id="id26">Aff_</span></a>, output_shape=dsize, mode=&#8217;constant&#8217;, order=1)
100 loops, best of 3: 5.74 ms per loop
%timeit cv2.warpAffine(img[:, :, 0], Aff[0:2], tuple(dsize), <a href="#id3"><span class="problematic" id="id4">**</span></a>CV2_WARP_KWARGS)
100 loops, best of 3: 5.13 ms per loop</p>
<p class="last">CONCLUSION, cv2 transforms are better</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.warpHomog">
<code class="descclassname">vtool.image.</code><code class="descname">warpHomog</code><span class="sig-paren">(</span><em>img</em>, <em>Homog</em>, <em>dsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image.html#warpHomog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.warpHomog" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.image_filters">
<span id="vtool-image-filters-module"></span><h2>vtool.image_filters module<a class="headerlink" href="#module-vtool.image_filters" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.image_filters.adapteq_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">adapteq_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#adapteq_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.adapteq_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>create a CLAHE object (Arguments are optional).</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.clean_mask">
<code class="descclassname">vtool.image_filters.</code><code class="descname">clean_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>num_dilate=3</em>, <em>num_erode=3</em>, <em>window_frac=0.025</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#clean_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.clean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.grabcut_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">grabcut_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#grabcut_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.grabcut_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>naively segments a chip</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.histeq_fn">
<code class="descclassname">vtool.image_filters.</code><code class="descname">histeq_fn</code><span class="sig-paren">(</span><em>chipBGR</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/image_filters.html#histeq_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.histeq_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram equalization of a grayscale image. from  _tpl/other</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.keypoint">
<span id="vtool-keypoint-module"></span><h2>vtool.keypoint module<a class="headerlink" href="#module-vtool.keypoint" title="Permalink to this headline">¶</a></h2>
<p>python -c &#8220;import vtool, doctest; print(doctest.testmod(vtool.keypoint))&#8221;</p>
<p>Keypoints are stored in the invA format by default.
Unfortunately many places in the code reference this as A instead of invA
because I was confused when I first started writing this.</p>
<p>to rectify this I am changing terminology.</p>
<dl class="docutils">
<dt>Variables:</dt>
<dd><dl class="first last docutils">
<dt>invV <span class="classifier-delimiter">:</span> <span class="classifier">maps from ucircle onto an ellipse (perdoch.invA)</span></dt>
<dd>V : maps from ellipse to ucircle      (perdoch.A)
Z : the conic matrix                  (perdoch.E)</dd>
</dl>
</dd>
<dt>Representation:</dt>
<dd><dl class="first last docutils">
<dt>kpts (ndarray) <span class="classifier-delimiter">:</span> <span class="classifier">[x, y, iv11, iv21, iv22, ori]</span></dt>
<dd>a flat on disk representation of the keypoint</dd>
<dt>invV (ndarray): [(iv11, iv12, x),</dt>
<dd><blockquote class="first">
<div>(iv21, iv22, y),
(   0,    0, 1),]</div></blockquote>
<p class="last">a more conceptually useful representation mapp;ing a
unit circle onto an ellipse (without any rotation)</p>
</dd>
<dt>invVR (ndarray): [(iv11, iv12, x),</dt>
<dd><blockquote class="first">
<div>(iv21, iv22, y),
(   0,    0, 1),].dot(R)</div></blockquote>
<p class="last">same as invV but it is rotated before warping a unit circle
into an ellipse.</p>
</dd>
</dl>
</dd>
<dt>Sympy:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv11</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">patch_size</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x y iv11 iv21 iv22 S&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;sx, sy, w1, w2, tx, ty&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv11</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">ori</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;invV = &#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">invV</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span><span class="n">iv11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">sin</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hypoth</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>     <span class="n">sx</span><span class="p">,</span>    <span class="n">w1</span><span class="p">,</span>   <span class="n">tx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>     <span class="n">w2</span><span class="p">,</span>    <span class="n">sy</span><span class="p">,</span>   <span class="n">ty</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>      <span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_2x2</span> <span class="o">=</span> <span class="n">invV</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hypoth_2x2</span> <span class="o">=</span> <span class="n">Hypoth</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invV</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_2x2_t</span> <span class="o">=</span> <span class="n">Hypoth_2x2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invV_2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212;-&#8216;)</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invV_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;xyz_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invV_2x2_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;-----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212; CHECKING 3x3 &#8212;&#8217;)</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invV_t</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">xyz_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212; CHECKING 2x2 &#8212;&#8217;)</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invV_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">invV_2x2_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># CHeck with rotation component as well (probably ok)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_2x2</span> <span class="o">=</span> <span class="n">invVR</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_2x2_t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Hypoth_2x2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">invVR_2x2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212;-&#8216;)</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invVR_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212;-&#8216;)</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invVR_2x2_t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;-----&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212; CHECKING ROTATION + TRANSLATION 3x3 &#8212;&#8217;)</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invVR_t</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">xyz_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span>
</pre></div>
</div>
</dd>
<dt>&#8212; CHECKING ROTATION 2x2 &#8212;&#8217;)</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">invVR_t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">invVR_2x2_t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">####</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Checking orientation property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">ivr11</span><span class="p">,</span> <span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr13</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr21</span><span class="p">,</span> <span class="n">ivr22</span><span class="p">,</span> <span class="n">ivr23</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr31</span><span class="p">,</span> <span class="n">ivr32</span><span class="p">,</span> <span class="n">ivr33</span><span class="p">],]</span> <span class="o">=</span> <span class="n">invVR</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr11</span><span class="p">)</span>  <span class="c"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">ori</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">iv11</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
</pre></div>
</div>
<p>#_oris = np.arctan2(_iv12s, _iv11s)  # outputs from -TAU/2 to TAU/2
&gt;&gt;&gt; # OLD STUFF
&gt;&gt;&gt; #
&gt;&gt;&gt; print(ut.hz_str(&#8216;V = &#8216;, repr(V)))
V = Matrix([</p>
<blockquote>
<div>[           1/iv11,      0,                 -1.0*x/iv11],
[-iv21/(iv11*iv22), 1/iv22, -1.0*(y - iv21*x/iv11)/iv22],
[                0,      0,                         1.0]])</div></blockquote>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;V = &#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">inv</span><span class="p">()))))</span>
<span class="go">V = Matrix([</span>
<span class="go">    [           1/iv11,      0,                        -1.0*x/iv11],</span>
<span class="go">    [-iv21/(iv11*iv22), 1/iv22, 1.0*(-iv11*y + iv21*x)/(iv11*iv22)],</span>
<span class="go">    [                0,      0,                                1.0]])</span>
</pre></div>
</div>
</dd>
<dt>Efficiency Notes:</dt>
<dd><p class="first">single index indexing is very fast</p>
<p>slicing seems to be very fast.</p>
<p class="last">fancy indexing with __getitem__ is very slow
using np.take is a better idea, but its a bit harder
to use with multidimensional arrays (nope use axis=x)</p>
</dd>
</dl>
<dl class="function">
<dt id="vtool.keypoint.augment_2x2_with_translation">
<code class="descclassname">vtool.keypoint.</code><code class="descname">augment_2x2_with_translation</code><span class="sig-paren">(</span><em>kpts</em>, <em>_mat2x2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#augment_2x2_with_translation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.augment_2x2_with_translation" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to augment shape matrix with a translation component.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.cast_split">
<code class="descclassname">vtool.keypoint.</code><code class="descname">cast_split</code><span class="sig-paren">(</span><em>kpts</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#cast_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.cast_split" title="Permalink to this definition">¶</a></dt>
<dd><p>breakup keypoints into location, shape, and orientation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.flatten_invV_mats_to_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">flatten_invV_mats_to_kpts</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#flatten_invV_mats_to_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.flatten_invV_mats_to_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens invV matrices into kpts format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_RV_mats_3x3">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_RV_mats_3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats_3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_RV_mats_3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>prefered over get_invV_mats</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>V_mats</strong> &#8211; sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_V_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_V_mats</code><span class="sig-paren">(</span><em>kpts</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_V_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_V_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>V_mats</strong> &#8211; sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_Z_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_Z_mats</code><span class="sig-paren">(</span><em>V_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_Z_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_Z_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>transform into conic matrix Z
Z = (V.T).dot(V)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>Z_mats</strong> &#8211; Z is a conic representation of an ellipse</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_even_point_sample">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_even_point_sample</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_even_point_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_even_point_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>gets even points sample along the boundary of the ellipse</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_even_point_sample --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ell_border_pts_list</span> <span class="o">=</span> <span class="n">get_even_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ell_border_pts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;even sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_grid_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_grid_kpts</code><span class="sig-paren">(</span><em>wh=(300</em>, <em>300)</em>, <em>wh_stride=(50</em>, <em>50)</em>, <em>scale=20</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_grid_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_grid_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a regular grid of keypoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape+rotation matrix (from unit circle to ellipse)
Ignores translation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invVR_mats2x2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0.],</span>
<span class="go">        [ 2.,  3.]],</span>
<span class="go">       [[ 0., -1.],</span>
<span class="go">        [ 3., -2.]]])</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">invVR_mats2x2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats3x3">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been rotated, scaled, skewed, and translated. Into
the image keypoint position.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invVR_mats3x3
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats3x3</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[  1.,   0.,  10.],</span>
<span class="go">        [  2.,   3.,  20.],</span>
<span class="go">        [  0.,   0.,   1.]],</span>
<span class="go">       [[  0.,  -1.,  30.],</span>
<span class="go">        [  3.,  -2.,  40.],</span>
<span class="go">        [  0.,   0.,   1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_oris">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_oris</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts orientation from matrix encoding, this is a bit tricker
can use -arctan2 or (0, 0) and (0, 1), but then have to normalize</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invVR_mats_oris
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_oris</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">np.array([ 5.37,  5.29,  5.9 ,  5.26,  4.74,  5.6 ,  4.9 ], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAMS:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<p>#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=1] _oris
np.ndarray[np.float64_t, ndim=1] _iv12s
np.ndarray[np.float64_t, ndim=1] _iv11s</div></blockquote>
<p class="last">_iv11s = invVR_mats[:, 0, 0]
_iv12s = invVR_mats[:, 0, 1]
_oris = np.arctan2(_iv12s, _iv11s)  # outputs from -TAU/2 to TAU/2
_oris[_oris &lt; 0] = _oris[_oris &lt; 0] + TAU  # map to 0 to TAU (keep coords)
_oris = (-_oris) % TAexpr1_reprexpr1_reprU
return _oris
#else</p>
</dd>
<dt>Sympy:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># BEST PROOF SO FAR OF EXTRACTION FROM ARBITRARY COMPOMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#x, y, v21  = sympy.symbols(&#39;x, y, v21&#39;, **symkw)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#v11, v22    = sympy.symbols(&#39;v11, v22&#39;, positive=True, **symkw)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v21</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x, y, c&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span>    <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;a, d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span>       <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symtau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keypoint_terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v11</span><span class="p">,</span> <span class="n">v21</span><span class="p">,</span> <span class="n">v22</span><span class="p">,</span> <span class="n">theta</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Ell to ucircle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span>  <span class="n">v22</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Backwards rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span>  <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>                <span class="mi">0</span><span class="p">,</span>                  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Backwards translation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="o">-</span><span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>   <span class="o">-</span><span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Scale is the inverse square root determinant of the shape matrix.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Inverse of components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invT</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">inv_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">inv_</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">inv_</span><span class="p">()</span>  <span class="c"># TODO: figure out how to make -theta say inside sin and cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># -----------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Build the B matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RVT_held_full</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RVT_full</span> <span class="o">=</span> <span class="n">RVT_held_full</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Build the inv(B) matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invTVR_held_full</span> <span class="o">=</span> <span class="n">invT</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invV</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">invR</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invTVR_full</span> <span class="o">=</span> <span class="n">invTVR_held_full</span><span class="o">.</span><span class="n">as_mutable</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Build the invTVR_full in arbitrary terms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;iv11, iv12, iv13, iv21, iv22, iv23&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">,</span> <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_arb</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="n">iv11</span><span class="p">,</span> <span class="n">iv12</span><span class="p">,</span> <span class="n">iv13</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>   <span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span> <span class="n">iv23</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="p">[</span>    <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Set set terms equal to the construction from the inverse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">invVR_arb</span><span class="p">,</span> <span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arb_assign</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">arb_symbols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Solve for keypoint varibles in terms of the arbitrary invVR_arb mat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solutions</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solutions</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">arb_expr1</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Solutions for scale is not well defined, but can be taken through the determ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#solutions_ad = sympy.solve(arb_expr1, v11, v22)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#solutions_scale = sympy.solve(arb_expr1, scale)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#solutions = sympy.solve(arb_expr1, *keypoint_terms)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Print review info (ell to ucirc)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Keypoint review (RVT):&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indenter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Indenter</span><span class="p">(</span><span class="s">&#39;[RVT] &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Translate keypoint to origin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Warp from ellipse to unit circle shape:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Orientation normalize by -theta radians&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;R&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;These can be combined as such:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;RVT_held_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;This simplifies to a matrix which tranlates, scales, skews, and rotates an ellipse into a unit circle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;(B) = RVT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;RVT_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Print review info (ucirc to ell)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Now backwards:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Unorient&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indenter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Indenter</span><span class="p">(</span><span class="s">&#39;[invTVR] &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Warp from unit circle to ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Translate to point in annot space&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;These can be combined as such:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invTVR_held_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;This simplifies to a matrix which rotates, skews, scales, and translates a unit circle into an ellipse&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;inv(B) = inv(T) inv(V) inv(R)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invTVR_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="o">=</span> <span class="n">indenter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Now we will solve for keypoint componts given an arbitrary shape matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Given an arbitrary invVRT shape matrix&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;invVR_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;The keypoint compoments can be extracte as such&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;The position is easy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Scale is not found through symbolic manipulation but can be taken through linear algebra properites&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Orientation is a bit more involved&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># PROOVE ORIENTATION EQUATION IS CORRECT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ivr11 must be positive for this to work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb_nomod</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">)</span>  <span class="c"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_arb</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">invVR_arb</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s"> CLAIM:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Scale is be computed as:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;scale_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;scale_arb.subs(arb_assign)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;scale_arb.subs(arb_assign)&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s"> CLAIM:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Orientation is be computed as:&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;ori_arb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;ori_arb.subs(arb_assign)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;ori_arb.subs(arb_assign)&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs</span> <span class="o">=</span> <span class="n">ori_arb</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Consider only the arctan2 part&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># hack aroung resolve atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_arb_nomod</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">iv12</span><span class="p">,</span> <span class="n">iv11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.assumptions.refine</span> <span class="kn">import</span> <span class="n">refine_atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># There are 3 cases we need to wory about for atan2(y, x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case where x is positive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case1</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">iv12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">iv11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case where x is negative and y is non-negative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case2</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">iv12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case where x is negative and y is negative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case3</span> <span class="o">=</span> <span class="n">refine_atan2</span><span class="p">(</span><span class="n">ori_arb_nomod</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">iv12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;QI, QIV&#39;</span><span class="p">,</span> <span class="s">&#39;QII&#39;</span><span class="p">,</span> <span class="s">&#39;QIII&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_ranges</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atan2_case_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">atan2_case1</span><span class="p">,</span> <span class="n">atan2_case2</span><span class="p">,</span> <span class="n">atan2_case3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">caseno</span><span class="p">,</span> <span class="n">atan2_case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atan2_case_list</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">----</span><span class="se">\n</span><span class="s">caseno = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">caseno</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Quadrent: </span><span class="si">%r</span><span class="s">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">atan2_case_strs</span><span class="p">[</span><span class="n">caseno</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;theta_ranges: </span><span class="si">%r</span><span class="s">&#39;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">theta_ranges</span><span class="p">[</span><span class="n">caseno</span><span class="p">],))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">atan2_case</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;atan2_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">atan2_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">atan2_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">atan2_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;atan2_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">atan2_case</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">ori_arb_case</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">arb_assign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ori_arb_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ori_arb_case_subs</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">ori_arb_case_subs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;ori_arb_case_subs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
</pre></div>
</div>
<p>nptheta = np.linspace(0, 2 * np.pi, 32, endpoint=False)</p>
<p>mapping = np.arctan(np.tan(nptheta))
print(ut.list_str(zip(nptheta / (2 * np.pi), nptheta, mapping, nptheta == mapping), precision=3))
print(ut.list_str(zip(nptheta / (2 * np.pi), nptheta, mapping  % (np.pi * 2), nptheta == mapping % (np.pi * 2)), precision=3))</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># NUMPY CHECKS</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">nptheta_special</span> <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>  <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nptheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">nptheta_special</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#\modfn{\paren{-\atan{\tan{(-\theta)}}} }{\TAU}           &amp;\text{if } \cos{(-\theta )} &gt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_theta</span>  <span class="o">=</span> <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case1_theta</span><span class="p">))</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case1_theta</span> <span class="o">==</span> <span class="n">case1_result</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case1_theta</span><span class="p">,</span> <span class="n">case1_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case1_theta</span><span class="p">,</span> <span class="n">case1_result</span><span class="p">)</span> <span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#\modfn{\paren{-\atan{\tan{(-\theta)}} - \pi }}{\TAU}     &amp;\text{if } \cos{(-\theta )} &lt; 0 \AND \sin{(-\theta )} \ge 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case2_theta</span> <span class="o">=</span>  <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case2_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case2_theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case2_theta</span><span class="p">,</span> <span class="n">case2_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case2_theta</span><span class="p">,</span> <span class="n">case2_result</span><span class="p">)</span> <span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#\modfn{\paren{-\atan{\tan{(-\theta)}} + \pi }}{\TAU} &amp;\text{if } \cos{(-\theta )} &lt; 0 \AND \sin{(-\theta )} &lt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">nptheta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case3_theta</span> <span class="o">=</span>  <span class="n">nptheta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case3_result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="o">-</span><span class="n">case3_theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">case3_theta</span><span class="p">,</span> <span class="n">case3_result</span><span class="p">,</span> <span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">case3_theta</span><span class="p">,</span> <span class="n">case3_result</span><span class="p">)),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#\modfn{\paren{-\frac{\pi}{2} }}{\TAU}                &amp;\text{if } \cos{(-\theta )} = 0 \AND \sin{(-\theta )} &gt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># There are 2 locations with cos(-theta) = 0 and sing(-theta) &gt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># case4_theta = [ 3 * TAU / 4,    -TAU / 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosine0_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span> <span class="c"># positions with cosine = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case4_theta</span> <span class="o">=</span>  <span class="n">cosine0_theta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;case4_theta = </span><span class="si">%r</span><span class="s"> =? </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">case4_theta</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Case 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># There are 2 locations with cos(-theta) = 0 and sing(-theta) &lt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># case4_theta = [ -3 * TAU / 4,    TAU / 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#\modfn{\paren{\frac{\pi}{2} }}{\TAU}                &amp;\text{if } \cos{(-\theta )} = 0 \AND \sin{(-\theta )} &lt; 0 \\</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">cosine0_theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">case5_theta</span> <span class="o">=</span>  <span class="n">cosine0_theta</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;case5_theta = </span><span class="si">%r</span><span class="s"> =? </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">case5_theta</span><span class="p">,</span> <span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">TAU</span><span class="p">))</span>
</pre></div>
</div>
<p># numpy check</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># LATEX PART</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_held_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">refine</span><span class="p">,</span> <span class="n">atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.assumptions.refine</span> <span class="kn">import</span> <span class="n">refine_atan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">refine_atan2</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="o">.</span><span class="n">negative</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">atan(y/x)</span>
<span class="go">atan(y/x) - pi</span>
<span class="go">atan(y/x) + pi</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">negtheta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;negtheta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">ori_subs</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="o">-</span><span class="n">negtheta</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs4</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">ori_subs3</span><span class="p">)</span>
<span class="go">Out[45]: Mod(-atan2(sin(negtheta)/a, cos(negtheta)/a), 2*pi)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>SimpleError:</dt>
<dd><p class="first">import sympy
from sympy.assumptions.refine import refine_atan2
symkw = dict(real=True, finite=True)
a = sympy.symbols(&#8216;a&#8217;, positive=True, <a href="#id5"><span class="problematic" id="id6">**</span></a>symkw)
theta  = sympy.symbols(&#8216;theta&#8217;, <a href="#id7"><span class="problematic" id="id8">**</span></a>symkw)</p>
<p>iv11, iv12  = sympy.symbols(&#8216;iv11, iv12&#8217;, <a href="#id9"><span class="problematic" id="id10">**</span></a>symkw)
arb_assign = {</p>
<blockquote>
<div>iv12: -sympy.sin(theta)/a,
iv11: sympy.cos(theta)/a,</div></blockquote>
<p>}</p>
<p>ori_subs_nomod = sympy.atan2(-sympy.sin(theta)/a, sympy.cos(theta)/a)
atan2_case1 = refine_atan2(ori_subs_nomod,</p>
<blockquote>
<div>sympy.Q.real(arb_assign[iv12]) &amp; sympy.Q.positive(arb_assign[iv11])</div></blockquote>
<p class="last">)</p>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_subs3</span> <span class="o">=</span> <span class="n">ori_subs2</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">simultanious</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">for sym in ori_subs2.free_symbols:</span>
<span class="go">    print(&#39;%r.assumptions0 = %s&#39; % (sym, ut.dict_str(sym.assumptions0),))</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c">#invTVR = sympy.simplify(RVT_full.inv())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invTVR_full</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Sympy:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># First orient a unit circle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span>       <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv21</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x y iv21&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">v21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;vx, vy, v21&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv22</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;iv11 iv12&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span>    <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;v11 v22&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">symkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>  <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>               <span class="mi">0</span><span class="p">,</span>           <span class="mi">0</span><span class="p">,</span>       <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Warps a unit circle at (0, 0) onto an ellipse at (x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="n">vx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span>  <span class="n">v22</span><span class="p">,</span>  <span class="n">vy</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="go">veq = sympy.Eq(invVR, VR.inv())</span>
<span class="go">print(&#39;iv11 = &#39; + str(sympy.solve(veq, iv11)))</span>
<span class="go">print(&#39;iv21 = &#39; + str(sympy.solve(veq, iv21)))</span>
<span class="go">print(&#39;iv22 = &#39; + str(sympy.solve(veq, iv22)))</span>
<span class="go">print(&#39;x = &#39; + str(sympy.solve(veq, x)))</span>
<span class="go">print(&#39;y = &#39; + str(sympy.solve(veq, y)))</span>
<span class="go">inveq = sympy.Eq(V, invV.inv())</span>
<span class="go">print(&#39;v11 = &#39; + str(sympy.solve(inveq, v11)))</span>
<span class="go">print(&#39;v12 = &#39; + str(sympy.solve(inveq, v21)))</span>
<span class="go">print(&#39;v22 = &#39; + str(sympy.solve(inveq, v22)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">rrrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Sympy:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Show orientation property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># First orient a unit circle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">iv21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x y g&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">v21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;vx, vy, c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv11</span><span class="p">,</span> <span class="n">iv22</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;e h&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v11</span><span class="p">,</span> <span class="n">v22</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;a d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">finite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Forward rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>  <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span>               <span class="mi">0</span><span class="p">,</span>           <span class="mi">0</span><span class="p">,</span>       <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Warps a unit circle at (0, 0) onto an ellipse at (x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="n">x</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">iv21</span><span class="p">,</span> <span class="n">iv22</span><span class="p">,</span>   <span class="n">y</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v11</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="n">vx</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="n">v21</span><span class="p">,</span>  <span class="n">v22</span><span class="p">,</span>  <span class="n">vy</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="go">veq = sympy.Eq(invVR, VR.inv())</span>
<span class="go">print(&#39;iv11 = &#39; + str(sympy.solve(veq, iv11)))</span>
<span class="go">print(&#39;iv21 = &#39; + str(sympy.solve(veq, iv21)))</span>
<span class="go">print(&#39;iv22 = &#39; + str(sympy.solve(veq, iv22)))</span>
<span class="go">print(&#39;x = &#39; + str(sympy.solve(veq, x)))</span>
<span class="go">print(&#39;y = &#39; + str(sympy.solve(veq, y)))</span>
<span class="go">inveq = sympy.Eq(V, invV.inv())</span>
<span class="go">print(&#39;v11 = &#39; + str(sympy.solve(inveq, v11)))</span>
<span class="go">print(&#39;v12 = &#39; + str(sympy.solve(inveq, v21)))</span>
<span class="go">print(&#39;v22 = &#39; + str(sympy.solve(inveq, v22)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR</span> <span class="o">=</span> <span class="n">invV</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">rrrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invV</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">other_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1_repr</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_latex_repr</span><span class="p">(</span><span class="n">invVR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy_text_to_clipboard</span><span class="p">(</span><span class="n">expr1_repr</span><span class="p">)</span>
<span class="go">Matrix([</span>
<span class="go">[                  iv11*cos(theta),                   -iv11*sin(theta),   x],</span>
<span class="go">[iv21*cos(theta) + iv22*sin(theta), -iv21*sin(theta) + iv22*cos(theta),   y],</span>
<span class="go">[                                0,                                  0, 1.0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">invVR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Now extract the orientation from any invVR formated matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="n">ivr11</span><span class="p">,</span> <span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr13</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr21</span><span class="p">,</span> <span class="n">ivr22</span><span class="p">,</span> <span class="n">ivr23</span><span class="p">],</span> <span class="p">[</span><span class="n">ivr31</span><span class="p">,</span> <span class="n">ivr32</span><span class="p">,</span> <span class="n">ivr33</span><span class="p">],]</span> <span class="o">=</span> <span class="n">invVR</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># tan = sin / cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symtau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ivr11 must be positive for this to work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sympy</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">ivr12</span><span class="p">,</span> <span class="n">ivr11</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">symtau</span><span class="p">)</span>  <span class="c"># outputs from -TAU/2 to TAU/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Equality with a domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">ori</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="p">{</span><span class="n">theta</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truth_list</span><span class="p">,</span> <span class="n">results_list</span><span class="p">,</span> <span class="n">input_list</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">symbolic_randcheck</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">truth_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">difference</span> <span class="o">=</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;diff = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">difference</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;ori diff = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">ori_distance</span><span class="p">(</span><span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">results_list</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<p class="last">truth_list, results_list, input_list =
check_random_points(sympy.sin(theta) / sympy.cos(theta),
sympy.tan(theta))
_oris = (-trig.atan2(_iv12s, _iv11s)) % TAU
ori.evalf(subs=dict(iv11=1, theta=3), verbose=True)
sympy.trigsimp(sympy.simplify(sympy.trigsimp(z)))
ori = np.arctan2(_iv12s, _iv11s)
z = ori.subs(dict(iv11=1, theta=1))</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(10000, 2, 2).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0, 1]</span>
<span class="go">        invVR_mats.T[1, 0]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_shape">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_shape</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint shape components</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invVR_mats_shape
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_shape</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">oq9o@yqhtgloy58!</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>TODO
(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
<a class="reference external" href="http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing">http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing</a>
# So, this doesn&#8217;t work
# Try this instead
<a class="reference external" href="http://docs.cython.org/src/userguide/memoryviews.html#memoryviews">http://docs.cython.org/src/userguide/memoryviews.html#memoryviews</a></p>
<dl class="docutils">
<dt>Cyth::</dt>
<dd><p class="first">#CYTH_INLINE
#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=1] _iv11s
np.ndarray[np.float64_t, ndim=1] _iv12s
np.ndarray[np.float64_t, ndim=1] _iv21s
np.ndarray[np.float64_t, ndim=1] _iv22s
#double [:] _iv11s
#double [:] _iv12s
#double [:] _iv21s
#double [:] _iv22s</dd>
</dl>
<p class="last">#endif</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_sqrd_scale">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_sqrd_scale</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_sqrd_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_sqrd_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the squared scale of the invVR keyponts</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invVR_mats_sqrd_scale
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det_arr</span> <span class="o">=</span> <span class="n">get_invVR_mats_sqrd_scale</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">det_arr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([-0.16, -0.09, -0.34,  0.59, -0.2 ,  0.18,  0.06], dtype=np.float64)</span>
</pre></div>
</div>
<p>#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<p>#if CYTH
cdef unsigned int nMats = invVR_mats.shape[0]
# Prealloc output
cdef np.ndarray[np.float64_t, ndim=1] out = np.zeros((nMats,), dtype=np.float64)
#cdef size_t ix
cdef Py_ssize_t ix
for ix in range(nMats):</p>
<blockquote>
<div><p># simple determinant: ad - bc
out[ix] = ((invVR_mats[ix, 0, 0] * invVR_mats[ix, 1, 1]) -</p>
<blockquote>
<div>(invVR_mats[ix, 0, 1] * invVR_mats[ix, 1, 0]))</div></blockquote>
</div></blockquote>
<p>return out
#else</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_xys">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVR_mats_xys</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts locations
extracts xys from matrix encoding, Its just the (0, 2), and (1, 2) components</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invVR_mats</strong> (<em>ndarray</em>) &#8211; list of matrices mapping ucircles to ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the xy location</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=2] _xys</dd>
</dl>
<p class="last">#endif</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(1000, 3, 3).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0:2, 2].T</span>
<span class="go">        invVR_mats.T[2, 0:2]</span>
<span class="go">        invVR_mats.T.take(2, axis=0).take([0, 1], axis=0)</span>
<span class="go">        invVR_mats.T.take(2, axis=0)[0:2]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E5</span><span class="p">))</span>
<span class="go">#&gt;&gt;&gt; ut.util_dev.rrr()</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_mats</code><span class="sig-paren">(</span><em>kpts</em>, <em>with_trans=False</em>, <em>with_ori=False</em>, <em>ashomog=False</em>, <em>ascontiguous=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: DEPRICATE. too many conditionals</p>
<p>packs keypoint shapes into affine invV matrixes
(default is just the 2x2 shape. But translation, orientation,
homogonous, and contiguous flags can be set.)</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_trans</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_ori</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ashomog</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascontiguous</span><span class="o">=</span><span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">innVR_mats</span> <span class="o">=</span> <span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="p">,</span> <span class="n">with_ori</span><span class="p">,</span> <span class="n">ashomog</span><span class="p">,</span> <span class="n">ascontiguous</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">innVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[  1.,   0.,  10.],</span>
<span class="go">        [  2.,   3.,  20.],</span>
<span class="go">        [  0.,   0.,   1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats2x2">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_mats2x2</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape (from unit circle to ellipse)
Ignores translation and rotation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invV_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invV_mats2x2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats2x2</span> <span class="o">=</span> <span class="n">get_invV_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0.],</span>
<span class="go">        [ 2.,  3.]],</span>
<span class="go">       [[ 1.,  0.],</span>
<span class="go">        [ 2.,  3.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats3x3">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_mats3x3</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been scaled, skewed, and translated. Into
the image keypoint position.</p>
<p>DOES NOT INCLUDE ROTATION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats -  keypoint shape and rotations (possibly translation)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_invV_mats3x3
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_arrs3x3</span> <span class="o">=</span> <span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_arrs3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0.,  0.],</span>
<span class="go">        [ 2.,  3.,  0.],</span>
<span class="go">        [ 0.,  0.,  1.]],</span>
<span class="go">       [[ 1.,  0.,  0.],</span>
<span class="go">        [ 2.,  3.,  0.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_xy_axis_extents">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invV_xy_axis_extents</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_xy_axis_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_xy_axis_extents" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the scales of the major and minor elliptical axis.
from invV_mats (faster)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_invVs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint shapes (oriented with the gravity vector)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_dlen_sqrd">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_dlen_sqrd</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns diagonal length squared of keypoint extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dlen_sqrd</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_kpts_dlen_sqrd
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd</span> <span class="o">=</span> <span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dlen_sqrd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">5681.31</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_image_extent">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_image_extent</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_image_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_image_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the width and height of keypoint bounding box
This combines xy and shape information
Does not take into account if keypoint extent goes under (0, 0)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">wh_bound</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_kpts_image_extent
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_bound</span> <span class="o">=</span> <span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wh_bound</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([ 51.79,  54.77])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_kpts_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_match_spatial_squared_error">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_match_spatial_squared_error</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>fx2_to_fx1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_match_spatial_squared_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_match_spatial_squared_error" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms img2 to img2 and finds squared spatial error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix mapping image 1 to image 2 space</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; has shape (nMatch, K)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">fx2_to_xyerr_sqrd has shape (nMatch, K)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_match_spatial_squared_error:0
python -m vtool.keypoint --test-get_match_spatial_squared_error:1
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">129.83</span><span class="p">,</span>   <span class="mf">46.97</span><span class="p">,</span>   <span class="mf">15.84</span><span class="p">,</span>    <span class="mf">4.66</span><span class="p">,</span>    <span class="mf">7.24</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">137.88</span><span class="p">,</span>   <span class="mf">49.87</span><span class="p">,</span>   <span class="mf">20.09</span><span class="p">,</span>    <span class="mf">5.76</span><span class="p">,</span>    <span class="mf">6.2</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">115.95</span><span class="p">,</span>   <span class="mf">53.13</span><span class="p">,</span>   <span class="mf">12.96</span><span class="p">,</span>    <span class="mf">1.73</span><span class="p">,</span>    <span class="mf">8.77</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">324.88</span><span class="p">,</span>  <span class="mf">172.58</span><span class="p">,</span>  <span class="mf">127.69</span><span class="p">,</span>   <span class="mf">41.29</span><span class="p">,</span>   <span class="mf">50.5</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">285.44</span><span class="p">,</span>  <span class="mf">254.61</span><span class="p">,</span>  <span class="mf">136.06</span><span class="p">,</span>   <span class="o">-</span><span class="mf">4.77</span><span class="p">,</span>   <span class="mf">76.69</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">367.72</span><span class="p">,</span>  <span class="mf">140.81</span><span class="p">,</span>  <span class="mf">172.13</span><span class="p">,</span>   <span class="mf">12.99</span><span class="p">,</span>   <span class="mf">96.15</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">318.93</span><span class="p">,</span>   <span class="mf">11.98</span><span class="p">,</span>   <span class="mf">12.11</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>    <span class="mf">8.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">509.47</span><span class="p">,</span>   <span class="mf">12.53</span><span class="p">,</span>   <span class="mf">22.4</span> <span class="p">,</span>    <span class="mf">1.31</span><span class="p">,</span>    <span class="mf">5.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">514.03</span><span class="p">,</span>   <span class="mf">13.04</span><span class="p">,</span>   <span class="mf">19.25</span><span class="p">,</span>    <span class="mf">1.74</span><span class="p">,</span>    <span class="mf">4.72</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">490.19</span><span class="p">,</span>  <span class="mf">185.49</span><span class="p">,</span>   <span class="mf">95.67</span><span class="p">,</span>   <span class="o">-</span><span class="mf">4.84</span><span class="p">,</span>   <span class="mf">88.23</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">316.97</span><span class="p">,</span>  <span class="mf">206.07</span><span class="p">,</span>   <span class="mf">90.87</span><span class="p">,</span>    <span class="mf">0.07</span><span class="p">,</span>   <span class="mf">80.45</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">366.07</span><span class="p">,</span>  <span class="mf">140.05</span><span class="p">,</span>  <span class="mf">161.27</span><span class="p">,</span>  <span class="o">-</span><span class="mf">47.01</span><span class="p">,</span>   <span class="mf">85.62</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">0.70098</span><span class="p">,</span>   <span class="mf">0.12273</span><span class="p">,</span>   <span class="mf">5.18734</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span>  <span class="mf">0.12444</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.63474</span><span class="p">,</span>  <span class="mf">14.13995</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span>  <span class="mf">0.00004</span><span class="p">,</span>   <span class="mf">0.00025</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.64873</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  82.848,  186.238,  183.979,  192.639],</span>
<span class="go">          [ 382.988,  374.356,  122.179,  289.16 ],</span>
<span class="go">          [ 387.563,  378.93 ,  126.389,  292.391],</span>
<span class="go">          [ 419.246,  176.668,  400.175,  167.411],</span>
<span class="go">          [ 174.269,  274.289,  281.03 ,   33.521],</span>
<span class="go">          [  54.083,  269.645,   94.711,  277.706]], dtype=np.float32)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">,</span>   <span class="mf">15.84</span><span class="p">,</span>    <span class="mf">4.66</span><span class="p">,</span>    <span class="mf">7.24</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">9.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">20.09</span><span class="p">,</span>    <span class="mf">5.76</span><span class="p">,</span>    <span class="mf">6.2</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.96</span><span class="p">,</span>    <span class="mf">1.73</span><span class="p">,</span>    <span class="mf">8.77</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.11</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>    <span class="mf">8.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">5.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">22.4</span> <span class="p">,</span>    <span class="mf">1.31</span><span class="p">,</span>    <span class="mf">5.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">19.25</span><span class="p">,</span>    <span class="mf">1.74</span><span class="p">,</span>    <span class="mf">4.72</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  0.   ,  16.125,  10.44 ],</span>
<span class="go">          [  7.616,  13.153,   3.   ],</span>
<span class="go">          [  4.   ,  12.166,   6.708]], dtype=np.float32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_ori_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_ori_mats</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_ori_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns keypoint orientation matrixes</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_ori_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_ori_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_ori_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_oris">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_oris</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint orientations for kpts array</p>
<p>(in isotropic guassian space relative to the gravity vector)
(in simpler words: the orientation is is taken from keypoints warped to the unit circle)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em>) &#8211; (N x 6) [x, y, a, c, d, theta]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(ndarray) theta</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_scales">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_scales</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets average scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_shape_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_shape_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_shape_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_shape_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_sqrd_scales">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_sqrd_scales</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_sqrd_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_sqrd_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average squared scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_transforms_from_patch_image_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_transforms_from_patch_image_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>patch_shape</em>, <em>scale_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_transforms_from_patch_image_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_transforms_from_patch_image_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some patch (like a gaussian patch) transforms a patch to be overlayed
on top of each keypoint in the image (adjusted for a scale factor)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>patch_shape</strong> &#8211; </li>
<li><strong>scale_factor</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a list of 3x3 tranformation matricies for each keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">M_list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_transforms_from_patch_image_kpts
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_list</span> <span class="o">=</span> <span class="n">get_transforms_from_patch_image_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch_shape</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[  1.49,   0.  ,  15.53],</span>
<span class="go">        [ -1.46,   6.9 ,   8.68],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  0.67,   0.  ,  26.98],</span>
<span class="go">        [ -1.46,   6.9 ,   8.68],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  3.49,   0.  ,  19.53],</span>
<span class="go">        [  3.43,   3.01,  10.67],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  3.82,   0.  ,  19.55],</span>
<span class="go">        [  5.04,   4.03,   1.8 ],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  4.59,   0.  ,  18.24],</span>
<span class="go">        [  0.97,   3.35,  18.02],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]]])</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd>%timeit [np.array(((a, 0, x), (c, d, y), (0, 0, 1),)) for (x, y, a, c, d, ori) in kpts]
%timeit vt.get_invVR_mats3x3(kpts)
%timeit vt.get_invV_mats3x3(kpts) &lt;- THIS IS ACTUALLY MUCH FASTER</dd>
<dt>Ignore::</dt>
<dd>%pylab qt4
import plottool as pt
pt.imshow(chip)
pt.draw_kpts2(kpts)
pt.update()</dd>
<dt>Timeit:</dt>
<dd><p class="first">sa_list1 = np.array([S2.dot(A) for A in invVR_aff2Ds])
sa_list2 = matrix_multiply(S2, invVR_aff2Ds)
assert np.all(sa_list1 == sa_list2)
%timeit np.array([S2.dot(A) for A in invVR_aff2Ds])
%timeit matrix_multiply(S2, invVR_aff2Ds)</p>
<p class="last">from six.moves import reduce
perspective_list2 = np.array([S2.dot(A).dot(S1).dot(T1) for A in invVR_aff2Ds])
perspective_list = reduce(matrix_multiply, (S2, invVR_aff2Ds, S1, T1))
assert np.all(perspective_list == perspective_list2)
%timeit np.array([S2.dot(A).dot(S1).dot(T1) for A in invVR_aff2Ds])
%timeit reduce(matrix_multiply, (S2, invVR_aff2Ds, S1, T1))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_uneven_point_sample">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_uneven_point_sample</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_uneven_point_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_uneven_point_sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>for each keypoint returns an uneven sample of points along the ellipical</dt>
<dd>boundries.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_uneven_point_sample --show
</pre></div>
</div>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>pyhesaff.tests.test_ellipse
python -m pyhesaff.tests.test_ellipse &#8211;test-in_depth_ellipse &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ellipse_pts1</span> <span class="o">=</span> <span class="n">get_uneven_point_sample</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">ellipse_pts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;uneven sample points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xy_axis_extents">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_xy_axis_extents</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_axis_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xy_axis_extents" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the scales of the major and minor elliptical axis from kpts
(slower due to conversion to invV_mats)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">xyexnts</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-get_xy_axis_extents
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyexnts</span> <span class="o">=</span> <span class="n">get_xy_axis_extents</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">xyexnts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  6.2212909   24.91645859]</span>
<span class="go"> [  2.79504602  24.7306281 ]</span>
<span class="go"> [ 16.43837149  19.39813418]</span>
<span class="go"> [ 18.23215582  25.76692184]</span>
<span class="go"> [ 19.78704902  16.82756301]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xy_strs">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_xy_strs</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xy_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xys">
<code class="descclassname">vtool.keypoint.</code><code class="descname">get_xys</code><span class="sig-paren">(</span><em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#get_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint locations in chip space</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.invert_invV_mats">
<code class="descclassname">vtool.keypoint.</code><code class="descname">invert_invV_mats</code><span class="sig-paren">(</span><em>invV_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#invert_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.invert_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invV_mats</strong> (<em>ndarray[float32_t, ndim=3]</em>) &#8211; keypoint shapes (possibly translation)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">V_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray[float32_t, ndim=3]</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-invert_invV_mats
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_mats</span> <span class="o">=</span> <span class="n">invert_invV_mats</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">matrix_multiply</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">,</span> <span class="n">V_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># This should give us identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kp_cpp_infostr">
<code class="descclassname">vtool.keypoint.</code><code class="descname">kp_cpp_infostr</code><span class="sig-paren">(</span><em>kp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kp_cpp_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kp_cpp_infostr" title="Permalink to this definition">¶</a></dt>
<dd><p>mirrors c++ debug code</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kpts_docrepr">
<code class="descclassname">vtool.keypoint.</code><code class="descname">kpts_docrepr</code><span class="sig-paren">(</span><em>arr</em>, <em>name='arr'</em>, <em>indent=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_docrepr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kpts_docrepr" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-kpts_docrepr
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_docrepr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kpts_repr">
<code class="descclassname">vtool.keypoint.</code><code class="descname">kpts_repr</code><span class="sig-paren">(</span><em>arr</em>, <em>precision=2</em>, <em>suppress_small=True</em>, <em>linebreak=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kpts_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.offset_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">offset_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>offset=(0.0</em>, <em>0.0)</em>, <em>scale_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#offset_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.offset_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfoms keypoints by a scale factor and a translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>offset</strong> (<em>tuple</em>) &#8211; </li>
<li><strong>scale_factor</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-offset_kpts
python -m vtool.keypoint --test-offset_kpts --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_</span> <span class="o">=</span> <span class="n">offset_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">kpts_</span><span class="p">),</span> <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;orig&#39;</span><span class="p">,</span> <span class="s">&#39;new&#39;</span><span class="p">],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">wh1</span><span class="p">,</span> <span class="n">wh2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wh</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">orig = np.array([[ 20.  ,  25.  ,   5.22,  -5.11,  24.15,   0.  ],</span>
<span class="go">                 [ 29.  ,  25.  ,   2.36,  -5.11,  24.15,   0.  ],</span>
<span class="go">                 [ 30.  ,  30.  ,  12.22,  12.02,  10.53,   0.  ],</span>
<span class="go">                 [ 31.  ,  29.  ,  13.36,  17.63,  14.1 ,   0.  ],</span>
<span class="go">                 [ 32.  ,  31.  ,  16.05,   3.41,  11.74,   0.  ]], dtype=np.float32)</span>
<span class="go">new = np.array([[ 30.  ,  12.5 ,   7.82,  -2.56,  12.07,  -0.  ],</span>
<span class="go">                [ 43.5 ,  12.5 ,   3.53,  -2.56,  12.07,  -0.  ],</span>
<span class="go">                [ 45.  ,  15.  ,  18.32,   6.01,   5.26,  -0.  ],</span>
<span class="go">                [ 46.5 ,  14.5 ,  20.03,   8.82,   7.05,  -0.  ],</span>
<span class="go">                [ 48.  ,  15.5 ,  24.08,   1.7 ,   5.87,  -0.  ]], dtype=np.float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.rectify_invV_mats_are_up">
<code class="descclassname">vtool.keypoint.</code><code class="descname">rectify_invV_mats_are_up</code><span class="sig-paren">(</span><em>invVR_mats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#rectify_invV_mats_are_up"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.rectify_invV_mats_are_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful if invVR_mats is no longer lower triangular
rotates affine shape matrixes into downward (lower triangular) position</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">2wir&amp;6ybcga0bpvz</span>
</pre></div>
</div>
<p>#if CYTH
# TODO: Template this for [float64_t, float32_t]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=3] invV_mats
np.ndarray[np.float64_t, ndim=1] _oris
np.ndarray[np.float64_t, ndim=1] _a
np.ndarray[np.float64_t, ndim=1] _b
np.ndarray[np.float64_t, ndim=1] _c
np.ndarray[np.float64_t, ndim=1] _d
np.ndarray[np.float64_t, ndim=1] <a href="#id27"><span class="problematic" id="id28">det_</span></a>
np.ndarray[np.float64_t, ndim=1] b2a2
np.ndarray[np.float64_t, ndim=1] iv11
np.ndarray[np.float64_t, ndim=1] iv21
np.ndarray[np.float64_t, ndim=1] iv22</dd>
</dl>
<p>#endif</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts">
<code class="descclassname">vtool.keypoint.</code><code class="descname">transform_kpts</code><span class="sig-paren">(</span><em>kpts</em>, <em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>returns M.dot(kpts_mat)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>M</strong> (<em>ndarray</em>) &#8211; transform matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(_iv11s, _iv12s, _iv21s, _iv22s)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-transform_kpts
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">transform_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-0. &#39;</span><span class="p">,</span> <span class="s">&#39; 0. &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 200.   ,  450.   ,   52.166,    1.056,  241.499,    0.   ],</span>
<span class="go">          [ 290.   ,  540.   ,   23.551,  -27.559,  241.499,    0.   ],</span>
<span class="go">          [ 300.   ,  600.   ,  122.166,  242.357,  105.287,    0.   ],</span>
<span class="go">          [ 310.   ,  600.   ,  133.556,  309.899,  141.041,    0.   ],</span>
<span class="go">          [ 320.   ,  630.   ,  160.527,  194.6  ,  117.354,    0.   ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts_to_imgspace">
<code class="descclassname">vtool.keypoint.</code><code class="descname">transform_kpts_to_imgspace</code><span class="sig-paren">(</span><em>kpts</em>, <em>bbox</em>, <em>bbox_theta</em>, <em>chipsz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_to_imgspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_to_imgspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms keypoints so they are plotable in imagespace
kpts   - xyacdo keypoints
bbox   - chip bounding boxes in image space
theta  - chip rotationsinvC
chipsz - chip extent (in keypoint / chip space)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts_xys">
<code class="descclassname">vtool.keypoint.</code><code class="descname">transform_kpts_xys</code><span class="sig-paren">(</span><em>H</em>, <em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_xys" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xy_t</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.keypoint --test-transform_kpts_xys
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">3.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_t</span> <span class="o">=</span> <span class="n">transform_kpts_xys</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">xy_t</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 2.979,  2.982,  2.984,  2.984,  2.985],</span>
<span class="go">          [ 2.574,  2.482,  2.516,  2.5  ,  2.508]], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore::</dt>
<dd>%pylab qt4
import plottool as pt
pt.imshow(chip)
pt.draw_kpts2(kpts)
pt.update()</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.linalg">
<span id="vtool-linalg-module"></span><h2>vtool.linalg module<a class="headerlink" href="#module-vtool.linalg" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>TODO: Look at this file</dt>
<dd><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/code/transformations.py.html">http://www.lfd.uci.edu/~gohlke/code/transformations.py.html</a></dd>
<dt>Sympy:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span>  <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x y a c d, sx, sy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">rotation_mat3x3</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">sin</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;R&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#evalprint(&#39;R.inv()&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;sympy.simplify(R.inv())&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#evalprint(&#39;sympy.simplify(R.inv().subs(theta, 4))&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(&#39;-------&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#invR = sympy_mat(vt.rotation_mat3x3(-theta, sin=sympy.sin, cos=sympy.cos))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#evalprint(&#39;invR&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#evalprint(&#39;invR.inv()&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#evalprint(&#39;sympy.simplify(invR)&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#evalprint(&#39;sympy.simplify(invR.subs(theta, 4))&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;-------&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">translation_mat3x3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;T.inv()&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;-------&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sympy_mat</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">scale_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">evalprint</span><span class="p">(</span><span class="s">&#39;S.inv()&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;-------&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;LaTeX&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span>
</pre></div>
</div>
</dd>
</dl>
<p>&#8216;.join(sympy.latex(R).split(r&#8217;&#8216;)).replace(&#8216;{matrix}&#8217;, &#8216;{matrix}
&#8216;), &#8216;&amp;&#8217;)</p>
<dl class="function">
<dt id="vtool.linalg.OLD_pdf_norm2d">
<code class="descclassname">vtool.linalg.</code><code class="descname">OLD_pdf_norm2d</code><span class="sig-paren">(</span><em>x_</em>, <em>y_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#OLD_pdf_norm2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.OLD_pdf_norm2d" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATED</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.add_homogenous_coordinate">
<code class="descclassname">vtool.linalg.</code><code class="descname">add_homogenous_coordinate</code><span class="sig-paren">(</span><em>_xys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#add_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.add_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.linalg --test-add_homogenous_coordinate
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">add_homogenous_coordinate</span><span class="p">(</span><span class="n">_xys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">_xys</span> <span class="o">==</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 2.,  0.,  0.,  2.],</span>
<span class="go">          [ 2.,  2.,  0.,  0.],</span>
<span class="go">          [ 1.,  1.,  1.,  1.]], dtype=np.float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.affine_around_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">affine_around_mat3x3</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.affine_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.affine_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">affine_mat3x3</code><span class="sig-paren">(</span><em>sx=1</em>, <em>sy=1</em>, <em>theta=0</em>, <em>shear=0</em>, <em>tx=0</em>, <em>ty=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#affine_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.affine_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>is angle in counterclockwise direction</strong> (<a class="reference internal" href="#vtool.image.shear" title="vtool.image.shear"><em>shear</em></a>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py">https://github.com/scikit-image/scikit-image/blob/master/skimage/transform/_geometric.py</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.det_ltri">
<code class="descclassname">vtool.linalg.</code><code class="descname">det_ltri</code><span class="sig-paren">(</span><em>ltri</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#det_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.det_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular determinant</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.dot_ltri">
<code class="descclassname">vtool.linalg.</code><code class="descname">dot_ltri</code><span class="sig-paren">(</span><em>ltri1</em>, <em>ltri2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#dot_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.dot_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular dot product</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.gauss2d_pdf">
<code class="descclassname">vtool.linalg.</code><code class="descname">gauss2d_pdf</code><span class="sig-paren">(</span><em>x_</em>, <em>y_</em>, <em>sigma=None</em>, <em>mu=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#gauss2d_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.gauss2d_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Input: x and y coordinate of a 2D gaussian</dt>
<dd>sigma, mu - covariance and mean vector</dd>
</dl>
<p>Output: The probability density at that point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.inv_ltri">
<code class="descclassname">vtool.linalg.</code><code class="descname">inv_ltri</code><span class="sig-paren">(</span><em>ltri</em>, <em>det</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#inv_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.inv_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular inverse</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.normalize_rows">
<code class="descclassname">vtool.linalg.</code><code class="descname">normalize_rows</code><span class="sig-paren">(</span><em>arr1</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>from vtool.linalg import *</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr1</strong> (<em>ndarray</em>) &#8211; row vectors to normalize</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr1_normed</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.linalg --test-normalize_rows
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1_normed</span> <span class="o">=</span> <span class="n">normalize_rows</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;arr1_normed = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">arr1_normed</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">arr1_normed</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">arr1_normed = np.array([[ 0.13,  0.27,  0.4 ,  0.54,  0.67],</span>
<span class="go">                        [ 0.45,  0.45,  0.45,  0.45,  0.45]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.remove_homogenous_coordinate">
<code class="descclassname">vtool.linalg.</code><code class="descname">remove_homogenous_coordinate</code><span class="sig-paren">(</span><em>_xyzs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#remove_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.remove_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes 3d homogonous coordinates into 2d coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>_xyzs</strong> (<em>ndarray</em>) &#8211; of shape (3, N)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">_xys of shape (2, N)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.linalg --test-remove_homogenous_coordinate
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">1.2</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 1.667,  0.   ,  0.   ,  1.   ],</span>
<span class="go">          [ 1.667,  2.   ,  0.   ,  0.   ]], dtype=np.float32)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">140.</span><span class="p">,</span>  <span class="mf">167.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">194.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">121.</span><span class="p">,</span>  <span class="mf">139.</span><span class="p">,</span>  <span class="mf">156.</span><span class="p">,</span>  <span class="mf">155.</span><span class="p">,</span>  <span class="mf">163.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">47.</span><span class="p">,</span>   <span class="mf">56.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">65.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">remove_homogenous_coordinate</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[ 2.979,  2.982,  2.984,  2.984,  2.985],</span>
<span class="go">       [ 2.574,  2.482,  2.516,  2.5  ,  2.508]])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_around_bbox_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_around_bbox_mat3x3</code><span class="sig-paren">(</span><em>theta</em>, <em>bbox</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_bbox_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_around_bbox_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_around_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_around_mat3x3</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_mat2x2">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_mat2x2</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_mat2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">rotation_mat3x3</code><span class="sig-paren">(</span><em>radians</em>, <em>sin=&lt;ufunc 'sin'&gt;</em>, <em>cos=&lt;ufunc 'cos'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">https://en.wikipedia.org/wiki/Rotation_matrix</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.scale_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">scale_mat3x3</code><span class="sig-paren">(</span><em>sx</em>, <em>sy=None</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#scale_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.scale_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.shear_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">shear_mat3x3</code><span class="sig-paren">(</span><em>shear_x</em>, <em>shear_y</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#shear_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.shear_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.svd">
<code class="descclassname">vtool.linalg.</code><code class="descname">svd</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.svd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<em>ndarray</em>) &#8211; must be either float32 or float64</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(U, s, Vt)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.linalg --test-svd
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.5812</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.615</span><span class="p">,</span> <span class="mf">17.1295</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit::</dt>
<dd>flags = cv2.SVD_FULL_UV
%timeit cv2.SVDecomp(M, flags=flags)
%timeit npl.svd(M)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.transform_points_with_homography">
<code class="descclassname">vtool.linalg.</code><code class="descname">transform_points_with_homography</code><span class="sig-paren">(</span><em>H</em>, <em>_xys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#transform_points_with_homography"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.transform_points_with_homography" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.translation_mat3x3">
<code class="descclassname">vtool.linalg.</code><code class="descname">translation_mat3x3</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#translation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.translation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.whiten_xy_points">
<code class="descclassname">vtool.linalg.</code><code class="descname">whiten_xy_points</code><span class="sig-paren">(</span><em>xy_m</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/linalg.html#whiten_xy_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.whiten_xy_points" title="Permalink to this definition">¶</a></dt>
<dd><p>whitens points to mean=0, stddev=1 and returns transformation</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.tests</span> <span class="kn">import</span> <span class="n">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_m</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">whiten_xy_points</span><span class="p">(</span><span class="n">xy_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_norm</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">wg%mpai0hxvil4p2</span>
</pre></div>
</div>
<p>#CYTH_INLINE
#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] xy_m
np.ndarray[np.float64_t, ndim=1] mu_xy
np.ndarray[np.float64_t, ndim=1] std_xy
np.ndarray[np.float64_t, ndim=2] T
np.float64_t tx, ty, sx, sy
np.ndarray[np.float64_t, ndim=2] xy_norm</div></blockquote>
<p>#endif</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.matching">
<span id="vtool-matching-module"></span><h2>vtool.matching module<a class="headerlink" href="#module-vtool.matching" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.matching.assign_spatially_constrained_matches">
<code class="descclassname">vtool.matching.</code><code class="descname">assign_spatially_constrained_matches</code><span class="sig-paren">(</span><em>chip2_dlen_sqrd</em>, <em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>match_xy_thresh</em>, <em>norm_xy_bounds=(0.0</em>, <em>1.0)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_spatially_constrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.assign_spatially_constrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chip2_dlen_sqrd</strong> (<em>dict</em>) &#8211; </li>
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix that maps image1 space into image2 space</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; image2s nearest feature indices in image1</li>
<li><strong>fx2_to_dist</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>match_xy_thresh</strong> (<em>float</em>) &#8211; </li>
<li><strong>norm_xy_bounds</strong> (<em>tuple</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">assigntup(
fx2_match, - matching feature indices in image 2
fx1_match, - matching feature indices in image 1
fx1_norm,  - normmalizing indices in image 1
match_dist, - descriptor distances between fx2_match and fx1_match
norm_dist, - descriptor distances between fx2_match and fx1_norm
)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.matching --test-assign_spatially_constrained_matches
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">,</span>   <span class="mf">15.84</span><span class="p">,</span>    <span class="mf">4.66</span><span class="p">,</span>    <span class="mf">7.24</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">9.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">20.09</span><span class="p">,</span>    <span class="mf">5.76</span><span class="p">,</span>    <span class="mf">6.2</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.96</span><span class="p">,</span>    <span class="mf">1.73</span><span class="p">,</span>    <span class="mf">8.77</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.11</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>    <span class="mf">8.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">5.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">22.4</span> <span class="p">,</span>    <span class="mf">1.31</span><span class="p">,</span>    <span class="mf">5.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">19.25</span><span class="p">,</span>    <span class="mf">1.74</span><span class="p">,</span>    <span class="mf">4.72</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_xy_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">37</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip2_dlen_sqrd</span> <span class="o">=</span> <span class="mi">1400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_xy_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">40</span><span class="p">,</span> <span class="o">.</span><span class="mi">80</span><span class="p">,</span> <span class="o">.</span><span class="mi">85</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span><span class="o">.</span><span class="mi">30</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">60</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span><span class="o">.</span><span class="mi">80</span><span class="p">,</span> <span class="o">.</span><span class="mi">90</span><span class="p">,</span> <span class="o">.</span><span class="mi">91</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_spatially_constrained_matches</span><span class="p">(</span><span class="n">chip2_dlen_sqrd</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">match_xy_thresh</span><span class="p">,</span> <span class="n">norm_xy_bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_match</span><span class="p">,</span> <span class="n">fx1_match</span><span class="p">,</span> <span class="n">fx1_norm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([0, 1, 2], dtype=np.int32),</span>
<span class="go">    np.array([2, 0, 2], dtype=np.int32),</span>
<span class="go">    np.array([1, 1, 0], dtype=np.int32),</span>
<span class="go">    np.array([ 0.4,  0.3,  0.8], dtype=np.float32),</span>
<span class="go">    np.array([ 0.8,  0.5,  0.9], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Example:</p>
<p>assigns spatially constrained vsone match using results of nearest
neighbors.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.assign_unconstrained_matches">
<code class="descclassname">vtool.matching.</code><code class="descname">assign_unconstrained_matches</code><span class="sig-paren">(</span><em>fx2_to_fx1</em>, <em>fx2_to_dist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#assign_unconstrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.assign_unconstrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>assigns vsone matches using results of nearest neighbors.</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">77</span><span class="p">,</span>   <span class="mi">971</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">116</span><span class="p">,</span>   <span class="mi">120</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">122</span><span class="p">,</span>   <span class="mi">128</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">1075</span><span class="p">,</span>  <span class="mi">692</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">530</span><span class="p">,</span>   <span class="mi">45</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span>  <span class="mi">45</span><span class="p">,</span>  <span class="mi">530</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.05907059</span><span class="p">,</span>  <span class="mf">0.2389698</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.02129555</span><span class="p">,</span>  <span class="mf">0.24083519</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.03901863</span><span class="p">,</span>  <span class="mf">0.24756241</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.14974403</span><span class="p">,</span>  <span class="mf">0.15112305</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.22693443</span><span class="p">,</span>  <span class="mf">0.24428177</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.2155838</span> <span class="p">,</span>  <span class="mf">0.23641014</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_match</span><span class="p">,</span> <span class="n">fx1_match</span><span class="p">,</span> <span class="n">fx1_norm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([0, 1, 2, 3, 4, 5], dtype=np.int32),</span>
<span class="go">    np.array([  77,  116,  122, 1075,  530,   45], dtype=np.int32),</span>
<span class="go">    np.array([971, 120, 128, 692,  45, 530], dtype=np.int32),</span>
<span class="go">    np.array([ 0.059,  0.021,  0.039,  0.15 ,  0.227,  0.216], dtype=np.float64),</span>
<span class="go">    np.array([ 0.239,  0.241,  0.248,  0.151,  0.244,  0.236], dtype=np.float64),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_fsv_list">
<code class="descclassname">vtool.matching.</code><code class="descname">ensure_fsv_list</code><span class="sig-paren">(</span><em>fsv_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ensure_fsv_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_fsv_list" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure fs is at least Nx1</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.marge_matches">
<code class="descclassname">vtool.matching.</code><code class="descname">marge_matches</code><span class="sig-paren">(</span><em>fm_A</em>, <em>fm_B</em>, <em>fsv_A</em>, <em>fsv_B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#marge_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.marge_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>combines feature matches from two matching algorithms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fm_A</strong> (<em>ndarray[ndims=2]</em>) &#8211; type A feature matches</li>
<li><strong>fm_B</strong> (<em>ndarray[ndims=2]</em>) &#8211; type B feature matches</li>
<li><strong>fsv_A</strong> (<em>ndarray[ndims=2]</em>) &#8211; type A feature scores</li>
<li><strong>fsv_B</strong> (<em>ndarray[ndims=2]</em>) &#8211; type B feature scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fm_both, fs_both)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.matching --test-marge_matches
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_A</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">29</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">111</span><span class="p">],</span> <span class="p">[</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">125</span><span class="p">],</span> <span class="p">[</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">125</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_B</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">125</span><span class="p">],</span> <span class="p">[</span> <span class="mi">30</span><span class="p">,</span>  <span class="mi">32</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span>  <span class="o">.</span><span class="mi">2</span><span class="p">],</span>  <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">7</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fm_both</span><span class="p">,</span> <span class="n">fs_both</span><span class="p">)</span> <span class="o">=</span> <span class="n">marge_matches</span><span class="p">(</span><span class="n">fm_A</span><span class="p">,</span> <span class="n">fm_B</span><span class="p">,</span> <span class="n">fsv_A</span><span class="p">,</span> <span class="n">fsv_B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">((</span><span class="n">fm_both</span><span class="p">,</span> <span class="n">fs_both</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[ 15,  17],</span>
<span class="go">              [ 25, 125],</span>
<span class="go">              [ 54,  29],</span>
<span class="go">              [ 95, 111],</span>
<span class="go">              [ 97, 125],</span>
<span class="go">              [ 11,  21],</span>
<span class="go">              [ 30,  32]], dtype=np.int32),</span>
<span class="go">    np.array([[ 0.1 ,  0.2 ,  0.3 ],</span>
<span class="go">              [ 0.1 ,  0.1 ,  0.5 ],</span>
<span class="go">              [ 1.  ,  0.9 ,   nan],</span>
<span class="go">              [ 0.8 ,  0.2 ,   nan],</span>
<span class="go">              [ 1.  ,  0.9 ,   nan],</span>
<span class="go">              [  nan,   nan,  0.12],</span>
<span class="go">              [  nan,   nan,  0.7 ]], dtype=np.float64),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.normalized_nearest_neighbors">
<code class="descclassname">vtool.matching.</code><code class="descname">normalized_nearest_neighbors</code><span class="sig-paren">(</span><em>flann</em>, <em>vecs2</em>, <em>K</em>, <em>checks=800</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#normalized_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.normalized_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>uses flann index to return nearest neighbors with distances normalized
between 0 and 1 using sifts uint8 trick</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.ratio_test">
<code class="descclassname">vtool.matching.</code><code class="descname">ratio_test</code><span class="sig-paren">(</span><em>fx2_match</em>, <em>fx1_match</em>, <em>fx1_norm</em>, <em>match_dist</em>, <em>norm_dist</em>, <em>ratio_thresh=0.625</em>, <em>fm_dtype=&lt;type 'numpy.int32'&gt;</em>, <em>fs_dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#ratio_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ratio_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowes ratio test for one-vs-one feature matches.</p>
<p>Assumes reverse matches (image2 to image1) and returns (image1 to image2)
matches. Generalized to accept any match or normalizer not just K=1 and K=2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; nearest neighbor indices (from flann)</li>
<li><strong>fx2_to_dist</strong> (<em>ndarray</em>) &#8211; nearest neighbor distances (from flann)</li>
<li><strong>ratio_thresh</strong> (<em>float</em>) &#8211; </li>
<li><strong>match_col</strong> (<em>int or ndarray</em>) &#8211; column of matching indices</li>
<li><strong>norm_col</strong> (<em>int or ndarray</em>) &#8211; column of normalizng indices</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fm_RAT, fs_RAT, fm_norm_RAT)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.matching --test-ratio_test
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_match</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_match</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">77</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">1075</span><span class="p">,</span> <span class="mi">530</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_norm</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">971</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">692</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">530</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.059</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">,</span> <span class="mf">0.039</span><span class="p">,</span> <span class="mf">0.15</span> <span class="p">,</span> <span class="mf">0.227</span><span class="p">,</span> <span class="mf">0.216</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_dist</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.239</span><span class="p">,</span> <span class="mf">0.241</span><span class="p">,</span> <span class="mf">0.248</span><span class="p">,</span> <span class="mf">0.151</span><span class="p">,</span> <span class="mf">0.244</span><span class="p">,</span> <span class="mf">0.236</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_tup</span> <span class="o">=</span> <span class="n">ratio_test</span><span class="p">(</span><span class="n">fx2_match</span><span class="p">,</span> <span class="n">fx1_match</span><span class="p">,</span> <span class="n">fx1_norm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_dist</span><span class="p">,</span> <span class="n">ratio_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">fm_norm_RAT</span><span class="p">)</span> <span class="o">=</span> <span class="n">ratio_tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">ratio_tup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[ 77,   0],</span>
<span class="go">              [116,   1],</span>
<span class="go">              [122,   2]], dtype=np.int32),</span>
<span class="go">    np.array([ 0.753,  0.913,  0.843], dtype=np.float32),</span>
<span class="go">    np.array([[971,   0],</span>
<span class="go">              [120,   1],</span>
<span class="go">              [128,   2]], dtype=np.int32),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.show_matching_dict">
<code class="descclassname">vtool.matching.</code><code class="descname">show_matching_dict</code><span class="sig-paren">(</span><em>matches</em>, <em>metadata</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#show_matching_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.show_matching_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.matching.spatially_constrained_ratio_match">
<code class="descclassname">vtool.matching.</code><code class="descname">spatially_constrained_ratio_match</code><span class="sig-paren">(</span><em>flann</em>, <em>vecs2</em>, <em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>chip2_dlen_sqrd</em>, <em>match_xy_thresh=1.0</em>, <em>scr_ratio_thresh=0.625</em>, <em>scr_K=7</em>, <em>norm_xy_bounds=(0.0</em>, <em>1.0)</em>, <em>fm_dtype=&lt;type 'numpy.int32'&gt;</em>, <em>fs_dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#spatially_constrained_ratio_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.spatially_constrained_ratio_match" title="Permalink to this definition">¶</a></dt>
<dd><p>performs nearest neighbors, then assigns based on spatial constraints, the
last step performs a ratio test.</p>
<p>H - a homography H that maps image1 space into image2 space
H should map from query to database chip (1 to 2)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.unconstrained_ratio_match">
<code class="descclassname">vtool.matching.</code><code class="descname">unconstrained_ratio_match</code><span class="sig-paren">(</span><em>flann</em>, <em>vecs2</em>, <em>unc_ratio_thresh=0.625</em>, <em>fm_dtype=&lt;type 'numpy.int32'&gt;</em>, <em>fs_dtype=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#unconstrained_ratio_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.unconstrained_ratio_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowes ratio matching</p>
<p>fs_dtype = kwargs.get(&#8216;fs_dtype&#8217;, np.float32)
fm_dtype = kwargs.get(&#8216;fm_dtype&#8217;, np.int32)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.vsone_feature_matching">
<code class="descclassname">vtool.matching.</code><code class="descname">vsone_feature_matching</code><span class="sig-paren">(</span><em>kpts1</em>, <em>vecs1</em>, <em>kpts2</em>, <em>vecs2</em>, <em>dlen_sqrd2</em>, <em>cfgdict={}</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#vsone_feature_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.vsone_feature_matching" title="Permalink to this definition">¶</a></dt>
<dd><p>Actual logic for matching
:param vecs1: SIFT descriptors
:type vecs1: ndarray[uint8_t, ndim=2]
:param vecs2: SIFT descriptors
:type vecs2: ndarray[uint8_t, ndim=2]
:param kpts1: keypoints
:type kpts1: ndarray[float32_t, ndim=2]
:param kpts2: keypoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.vsone_image_fpath_matching">
<code class="descclassname">vtool.matching.</code><code class="descname">vsone_image_fpath_matching</code><span class="sig-paren">(</span><em>rchip_fpath1</em>, <em>rchip_fpath2</em>, <em>cfgdict={}</em>, <em>metadata_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#vsone_image_fpath_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.vsone_image_fpath_matching" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rchip_fpath1</strong> (<em>str</em>) &#8211; </li>
<li><strong>rchip_fpath2</strong> (<em>str</em>) &#8211; </li>
<li><strong>cfgdict</strong> (<em>dict</em>) &#8211; (default = {})</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool --tf vsone_image_fpath_matching --show
python -m vtool --tf vsone_image_fpath_matching --show --helpx
python -m vtool --tf vsone_image_fpath_matching --show --feat-type<span class="o">=</span>hesaff+siam128
python -m vtool --tf vsone_image_fpath_matching --show --feat-type<span class="o">=</span>hesaff+siam128 --ratio-thresh<span class="o">=</span>.9
python -m vtool --tf vsone_image_fpath_matching --show --feat-type<span class="o">=</span>hesaff+sift --ratio-thresh<span class="o">=</span>.8
python -m vtool --tf vsone_image_fpath_matching --show --feat-type<span class="o">=</span>hesaff+sift --ratio-thresh<span class="o">=</span>.8
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip_fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip_fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metadata_</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s">&#39;hesaff+sift&#39;</span><span class="p">,</span> <span class="n">ratio_thresh</span><span class="o">=.</span><span class="mi">625</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="o">**</span><span class="n">pyhesaff</span><span class="o">.</span><span class="n">get_hesaff_default_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">parse_dict_from_argv</span><span class="p">(</span><span class="n">default_cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">vsone_image_fpath_matching</span><span class="p">(</span><span class="n">rchip_fpath1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                               <span class="n">rchip_fpath2</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_matching_dict</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.vsone_matching">
<code class="descclassname">vtool.matching.</code><code class="descname">vsone_matching</code><span class="sig-paren">(</span><em>metadata</em>, <em>cfgdict={}</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/matching.html#vsone_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.vsone_matching" title="Permalink to this definition">¶</a></dt>
<dd><p>Metadata is a dictionary that contains either computed information
necessary for matching or the dependenceis of those computations.</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.math">
<span id="vtool-math-module"></span><h2>vtool.math module<a class="headerlink" href="#module-vtool.math" title="Permalink to this headline">¶</a></h2>
<p># LICENCE Apache 2 or whatever</p>
<p>FIXME: monotization functions need more hueristics</p>
<dl class="function">
<dt id="vtool.math.breakup_equal_streak">
<code class="descclassname">vtool.math.</code><code class="descname">breakup_equal_streak</code><span class="sig-paren">(</span><em>arr_in</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#breakup_equal_streak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.breakup_equal_streak" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks up streaks of equal values by interpolating between the next lowest and next highest value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr_in</strong> &#8211; </li>
<li><strong>left_endpoint</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>right_endpoint</strong> (<em>None</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr -</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --exec-breakup_equal_streak
python -m vtool.math --test-ensure_monotone_strictly_increasing --show --offset<span class="o">=</span>0
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.20488135</span><span class="p">,</span>  <span class="mf">1.2529297</span> <span class="p">,</span>  <span class="mf">1.27306686</span><span class="p">,</span>  <span class="mf">1.29859663</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="mf">1.31769871</span><span class="p">,</span> <span class="mf">1.37102388</span><span class="p">,</span>  <span class="mf">1.38114004</span><span class="p">,</span>  <span class="mf">1.45732054</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>  <span class="mf">1.48119571</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.5381895</span> <span class="p">,</span>  <span class="mf">1.54162741</span><span class="p">,</span>  <span class="mf">1.57492901</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>  <span class="mf">1.61129523</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.61270343</span><span class="p">,</span>  <span class="mf">1.63377551</span><span class="p">,</span>  <span class="mf">1.7423034</span> <span class="p">,</span>  <span class="mf">1.76364247</span><span class="p">,</span>  <span class="mf">1.79908459</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.83564709</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.83819742</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>  <span class="mf">1.86786967</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.90720142</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span>  <span class="mf">1.92293973</span><span class="p">,</span> <span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">breakup_equal_streak</span><span class="p">(</span><span class="n">arr_in</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;arr = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.ensure_monotone_decreasing">
<code class="descclassname">vtool.math.</code><code class="descname">ensure_monotone_decreasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>fromleft=True</em>, <em>fromright=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-ensure_monotone_decreasing --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.ensure_monotone_increasing">
<code class="descclassname">vtool.math.</code><code class="descname">ensure_monotone_increasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>fromright=True</em>, <em>fromleft=True</em>, <em>newmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_increasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-ensure_monotone_increasing --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">fromleft</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fromright</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;after monotonization (increasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.ensure_monotone_strictly_decreasing">
<code class="descclassname">vtool.math.</code><code class="descname">ensure_monotone_strictly_decreasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>left_endpoint</strong> (<em>None</em>) &#8211; </li>
<li><strong>right_endpoint</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">arr</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-ensure_monotone_strictly_decreasing --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">75</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mo">05</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#arr_ = vt.tests.dummy.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s">&#39;ensure strict monotonic failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_decreasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.ensure_monotone_strictly_increasing">
<code class="descclassname">vtool.math.</code><code class="descname">ensure_monotone_strictly_increasing</code><span class="sig-paren">(</span><em>arr_</em>, <em>left_endpoint=None</em>, <em>right_endpoint=None</em>, <em>zerohack=False</em>, <em>onehack=False</em>, <em>newmode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr</strong> (<em>ndarray</em>) &#8211; sequence to monotonize</li>
<li><strong>zerohack</strong> (<em>bool</em>) &#8211; default False, if True sets the first element to be zero and linearlly interpolates to the first nonzero item</li>
<li><strong>onehack</strong> (<em>bool</em>) &#8211; default False, if True one will not be in the resulting array (replaced with number very close to one)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone">http://mathoverflow.net/questions/17464/making-a-non-monotone-function-monotone</a>
<a class="reference external" href="http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop">http://stackoverflow.com/questions/28563711/make-a-numpy-array-monotonic-without-a-python-loop</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Isotonic_regression">https://en.wikipedia.org/wiki/Isotonic_regression</a>
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html">http://scikit-learn.org/stable/auto_examples/plot_isotonic_regression.html</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-ensure_monotone_strictly_increasing --show
python -m vtool.math --test-ensure_monotone_strictly_increasing --show --offset<span class="o">=</span>0
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s">&#39;ensure strict monotonic failed1&#39;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_endpoint</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_endpoint</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--offset&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">domain</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#arr_ = vt.tests.dummy.testdata_nonmonotonic()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#domain = np.arange(len(arr_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">left_endpoint</span><span class="p">,</span> <span class="n">right_endpoint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;arr = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arr</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;arr = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">non_decreasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s">&#39;ensure nondecreasing failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s">&#39;ensure strict monotonic failed2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr_</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;before&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">ensure_monotone_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;after monotonization (decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;after monotonization (strictly decreasing)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.math.gauss_func1d">
<code class="descclassname">vtool.math.</code><code class="descname">gauss_func1d</code><span class="sig-paren">(</span><em>x</em>, <em>mu=0.0</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#gauss_func1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.gauss_func1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; </li>
<li><strong>mu</strong> (<em>float</em>) &#8211; </li>
<li><strong>sigma</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-gauss_func1d
</pre></div>
</div>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-gauss_func1d --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.gauss_func1d_unnormalized">
<code class="descclassname">vtool.math.</code><code class="descname">gauss_func1d_unnormalized</code><span class="sig-paren">(</span><em>x</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#gauss_func1d_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.gauss_func1d_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd><p>faster version of gauss_func1d with no normalization. So the maximum point
will have a value of 1.0</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-gauss_func1d_unnormalized --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d_unnormalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.group_consecutive">
<code class="descclassname">vtool.math.</code><code class="descname">group_consecutive</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#group_consecutive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.group_consecutive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lists of consecutive values</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy">http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) &#8211; must be integral and unique</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">arr -</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --exec-group_consecutive
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">group_consecutive</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;groups = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">groups</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">groups = [array([1, 2, 3]), array([ 5,  6,  7,  8,  9, 10]), array([15]), array([ 99, 100, 101])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.iceil">
<code class="descclassname">vtool.math.</code><code class="descname">iceil</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;type 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#iceil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.iceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer ceiling. (because numpy doesn&#8217;t seem to have it!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num</strong> (<em>ndarray or scalar</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray or scalar</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.math --test-iceil
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">utool.util_alg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">utool.util_alg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([2, 3], dtype=np.int32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.math.iround">
<code class="descclassname">vtool.math.</code><code class="descname">iround</code><span class="sig-paren">(</span><em>num</em>, <em>dtype=&lt;type 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#iround"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.iround" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer round. (because numpy doesn&#8217;t seem to have it!)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.non_decreasing">
<code class="descclassname">vtool.math.</code><code class="descname">non_decreasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#non_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.non_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.non_increasing">
<code class="descclassname">vtool.math.</code><code class="descname">non_increasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#non_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.non_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.strictly_decreasing">
<code class="descclassname">vtool.math.</code><code class="descname">strictly_decreasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.strictly_increasing">
<code class="descclassname">vtool.math.</code><code class="descname">strictly_increasing</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.test_language_modulus">
<code class="descclassname">vtool.math.</code><code class="descname">test_language_modulus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/math.html#test_language_modulus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.test_language_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Modulo_operation">http://en.wikipedia.org/wiki/Modulo_operation</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool.nearest_neighbors">
<span id="vtool-nearest-neighbors-module"></span><h2>vtool.nearest_neighbors module<a class="headerlink" href="#module-vtool.nearest_neighbors" title="Permalink to this headline">¶</a></h2>
<p>Wrapper around flann (with caching)</p>
<p>python -c &#8220;import vtool, doctest; print(doctest.testmod(vtool.nearest_neighbors))&#8221;</p>
<dl class="function">
<dt id="vtool.nearest_neighbors.ann_flann_once">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">ann_flann_once</code><span class="sig-paren">(</span><em>dpts</em>, <em>qpts</em>, <em>num_neighbors</em>, <em>flann_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#ann_flann_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.ann_flann_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the approximate nearest neighbors of qpts in dpts</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.nearest_neighbors --test-ann_flann_once:0
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">list_str</span><span class="p">((</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[3, 3, 3, 3, 0],</span>
<span class="go">              [2, 0, 1, 4, 4]], dtype=np.int32),</span>
<span class="go">    np.array([[ 1037329.,  1235876.,  1168550.,  1286435.,  1075507.],</span>
<span class="go">              [ 1038324.,  1243690.,  1304896.,  1320598.,  1369036.]], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test upper bounds on sift descriptors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># SeeAlso distance.understanding_pseudomax_props</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get points on unit sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nDpts</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nQpts</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nDpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nQpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># cast to uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_max</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_min</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">100</span> <span class="c"># 2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">qpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts8</span><span class="p">,</span> <span class="n">qpts8</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biggest_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">qx2_dist</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;biggest_dist = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">biggest_dist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Get actual distance by hand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hand_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts8</span> <span class="o">-</span> <span class="n">dpts8</span><span class="p">[</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Seems like flann returns squared distance. makes sense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">hashstr27</span><span class="p">(</span><span class="nb">repr</span><span class="p">((</span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">8zdwd&amp;q0mu+ez4gp</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Build theoretically maximally distant vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># FIX TO ACTUALLY BE AT THE RIGHT NORM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">dpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">qpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts</span> <span class="o">-</span> <span class="n">dpts</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Because of norm condition another maximally disant pair of vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># is [1, 0, 0, ... 0] and [0, 1, .. 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verifythat this gives you same dist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.assign_to_centroids">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">assign_to_centroids</code><span class="sig-paren">(</span><em>dpts</em>, <em>qpts</em>, <em>num_neighbors=1</em>, <em>flann_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#assign_to_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.assign_to_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for akmeans</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.build_flann_index">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">build_flann_index</code><span class="sig-paren">(</span><em>dpts</em>, <em>flann_params</em>, <em>quiet=False</em>, <em>verbose=True</em>, <em>flann=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#build_flann_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.build_flann_index" title="Permalink to this definition">¶</a></dt>
<dd><p>build flann with some verbosity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dpts</strong> (<em>ndarray</em>) &#8211; database vectors</li>
<li><strong>flann_params</strong> (<em>dict</em>) &#8211; </li>
<li><strong>quiet</strong> (<em>bool</em>) &#8211; </li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; verbosity flag</li>
<li><strong>flann</strong> (<em>None</em>) &#8211; outvar</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">flann</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyflann.FLANN</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.nearest_neighbors --test-build_flann_index
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann</span> <span class="o">=</span> <span class="n">build_flann_index</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">flann</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flann</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_augment">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">flann_augment</code><span class="sig-paren">(</span><em>dpts</em>, <em>new_dpts</em>, <em>cache_dir</em>, <em>cfgstr</em>, <em>new_cfgstr</em>, <em>flann_params</em>, <em>use_cache=True</em>, <em>save=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_augment" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dpts</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s">&#39;vtool&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s">&#39;_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cfgstr</span> <span class="o">=</span> <span class="s">&#39;_new_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_cache">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">flann_cache</code><span class="sig-paren">(</span><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_cache=True</em>, <em>save=True</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=True</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to load a cached flann index before doing anything
from vtool.nn</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_index_time_experiment">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">flann_index_time_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_index_time_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_index_time_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a plot of how long it takes to build a flann index for a given number of KD-trees</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.nearest_neighbors --test-flann_index_time_experiment
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">flann_index_time_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_cfgstr">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_cfgstr</code><span class="sig-paren">(</span><em>dpts</em>, <em>flann_params</em>, <em>cfgstr=''</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.nearest_neighbors --test-get_flann_cfgstr
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="s">&#39;.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s">&#39;_FEAT(alg=heshes)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_flann_cfgstr</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_FEAT(alg=heshes)_FLANN(4kdtree)_DPTS((10,128)xxaotseonmfjkzcr)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_fpath">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_fpath</code><span class="sig-paren">(</span><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_fpath" title="Permalink to this definition">¶</a></dt>
<dd><p>returns filepath for flann index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_params">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_params</code><span class="sig-paren">(</span><em>algorithm='kdtree'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flann params that are relvant tothe algorithm</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>algorithm</strong> (<em>str</em>) &#8211; (default = &#8216;kdtree&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">flann_params</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">?</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.nearest_neighbors --test-get_flann_params --algo<span class="o">=</span>kdtree
python -m vtool.nearest_neighbors --test-get_flann_params --algo<span class="o">=</span>kmeans
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--algo&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;kdtree&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_flann_params</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;flann_params = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">flann_params</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_params_cfgstr">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_flann_params_cfgstr</code><span class="sig-paren">(</span><em>flann_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_kdtree_flann_params">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">get_kdtree_flann_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_kdtree_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_kdtree_flann_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.invertible_stack">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">invertible_stack</code><span class="sig-paren">(</span><em>vecs_list</em>, <em>label_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#invertible_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.invertible_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks descriptors into a flat structure and returns inverse mapping from
flat database descriptor indexes (dx) to annotation ids (label) and feature
indexes (fx). Feature indexes are w.r.t. annotation indexes.</p>
<dl class="docutils">
<dt>Output:</dt>
<dd>idx2_desc - flat descriptor stack
idx2_label  - inverted index into annotations
idx2_fx   - inverted index into features</dd>
</dl>
<p># Example with 2D Descriptors</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DESC_TYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_label</span><span class="p">,</span> <span class="n">idx2_fx</span> <span class="o">=</span> <span class="n">invertible_stack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_vec</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="go">array([[ 0,  0,  5,  2,  1,  5,  2,  1,  3, 42,  2],</span>
<span class="go">       [ 0,  1,  3, 30,  1,  3, 30,  1,  3, 42,  6]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_label</span><span class="p">))</span>
<span class="go">array([1, 1, 2, 2, 2, 4, 4, 4, 5, 5, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_fx</span><span class="p">))</span>
<span class="go">array([0, 1, 0, 1, 2, 0, 1, 2, 0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.test_cv2_flann">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">test_cv2_flann</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#test_cv2_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.test_cv2_flann" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.tune_flann">
<code class="descclassname">vtool.nearest_neighbors.</code><code class="descname">tune_flann</code><span class="sig-paren">(</span><em>dpts</em>, <em>target_precision=0.9</em>, <em>build_weight=0.5</em>, <em>memory_weight=0.0</em>, <em>sample_fraction=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#tune_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.tune_flann" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a>
<a class="reference external" href="http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html">http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html</a></p>
<dl class="docutils">
<dt>Math::</dt>
<dd><p class="first">cost of an algorithm is:</p>
<dl class="last docutils">
<dt>LaTeX:</dt>
<dd><dl class="first last docutils">
<dt>cost = frac</dt>
<dd>{search + build_weight * build }
{ minoverparams( search + build_weight build)} +
memory_weight * memory</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dpts</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>target_precision</strong> (<em>float</em>) &#8211; number between 0 and 1 representing desired
accuracy. Higher values are more accurate.</li>
<li><strong>build_weight</strong> (<em>float</em>) &#8211; importance weight given to minimizing build time
relative to search time. This number can range from 0 to infinity.
typically because building is a more complex computation you want
to keep the number relatively low, (less than 1) otherwise you&#8217;ll
end up getting a linear search (no build time).</li>
<li><strong>memory_weight</strong> (<em>float</em>) &#8211; Importance of memory relative to total speed.
A value less than 1 gives more importance to the time spent and a
value greater than 1 gives more importance to the memory usage.</li>
<li><strong>sample_fraction</strong> (<em>float</em>) &#8211; number between 0 and 1 representing the
fraction of the input data to use in the optimization. A higher
number uses more data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuned_params</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.nearest_neighbors --test-tune_flann
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.other">
<span id="vtool-other-module"></span><h2>vtool.other module<a class="headerlink" href="#module-vtool.other" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.other.and_3lists">
<code class="descclassname">vtool.other.</code><code class="descname">and_3lists</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>arr3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#and_3lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.and_3lists" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">and_3lists</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">prxuyy1w%ht57jaf</span>
</pre></div>
</div>
<p>#if CYTH
#CYTH_INLINE
cdef:</p>
<blockquote>
<div>np.ndarray arr1
np.ndarray arr2
np.ndarray arr3</div></blockquote>
<p>#endif</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.and_lists">
<code class="descclassname">vtool.other.</code><code class="descname">and_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#and_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.and_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-and_lists
</pre></div>
</div>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>or_lists</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[False  True False  True]</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ensure equal division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">flags</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">endx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">segments</span> <span class="o">*</span> <span class="p">(</span><span class="n">validx</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="p">(</span><span class="n">segments</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">validx</span><span class="p">[:</span><span class="n">endx</span><span class="p">],</span> <span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">parts</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[243734, 714397, 1204989, 1729375, 2235191]</span>
</pre></div>
</div>
</dd>
</dl>
<p>%timeit reduce(np.logical_and, args)
%timeit np.logical_and.reduce(args)  # wins with more data</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.argsort_groups">
<code class="descclassname">vtool.other.</code><code class="descname">argsort_groups</code><span class="sig-paren">(</span><em>scores_list</em>, <em>reverse=False</em>, <em>rng=&lt;module 'numpy.random' from '/usr/local/lib/python2.7/dist-packages/numpy/random/__init__.pyc'&gt;</em>, <em>randomize_levels=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.argsort_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts each group normally, but randomizes order of level values.</p>
<p>TODO: move to vtool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scores_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>reverse</strong> (<em>bool</em>) &#8211; (default = True)</li>
<li><strong>rng</strong> (<em>module</em>) &#8211; random number generator(default = numpy.random)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.init.filter_annots --exec-argsort_groups
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.init.filter_annots</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idxs_list</span> <span class="o">=</span> <span class="n">argsort_groups</span><span class="p">(</span><span class="n">scores_list</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#import vtool as vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#sorted_scores = vt.ziptake(scores_list, idxs_list)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = &#39;sorted_scores = %s&#39; % (ut.list_str(sorted_scores),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;idxs_list = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">idxs_list</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">idxs_list = [</span>
<span class="go">    np.array([1, 0], dtype=np.int64),</span>
<span class="go">    np.array([1, 0], dtype=np.int64),</span>
<span class="go">    np.array([0, 1, 2], dtype=np.int64),</span>
<span class="go">    np.array([4, 7, 0, 5, 6, 1, 2, 3], dtype=np.int64),</span>
<span class="go">    np.array([1, 0], dtype=np.int64),</span>
<span class="go">    np.array([5, 3, 1, 2, 0, 4], dtype=np.int64),</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.argsort_multiarray">
<code class="descclassname">vtool.other.</code><code class="descname">argsort_multiarray</code><span class="sig-paren">(</span><em>arrays</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#argsort_multiarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.argsort_multiarray" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.assert_zipcompress">
<code class="descclassname">vtool.other.</code><code class="descname">assert_zipcompress</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#assert_zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.assert_zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.axiswise_operation2">
<code class="descclassname">vtool.other.</code><code class="descname">axiswise_operation2</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#axiswise_operation2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.axiswise_operation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply opperation to each row</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">vecs</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>performs an operation between an
(N x A x B ... x Z) array with an
(N x 1) array</p>
<p>%timeit op(arr1, arr2[np.newaxis, :])
%timeit op(arr1, arr2[None, :])
%timeit op(arr1, arr2.reshape(1, arr2.shape[0]))
arr2.shape = (1, arr2.shape[0])
%timeit op(arr1, arr2)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.check_sift_validity">
<code class="descclassname">vtool.other.</code><code class="descname">check_sift_validity</code><span class="sig-paren">(</span><em>sift_uint8</em>, <em>lbl=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#check_sift_validity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.check_sift_validity" title="Permalink to this definition">¶</a></dt>
<dd><p>checks if a SIFT descriptor is valid</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.clipnorm">
<code class="descclassname">vtool.other.</code><code class="descname">clipnorm</code><span class="sig-paren">(</span><em>arr</em>, <em>min_</em>, <em>max_</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#clipnorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.clipnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes arr to the range 0 to 1 using <a href="#id29"><span class="problematic" id="id30">min_</span></a> and <a href="#id31"><span class="problematic" id="id32">max_</span></a> as clipping bounds</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.colwise_operation">
<code class="descclassname">vtool.other.</code><code class="descname">colwise_operation</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#colwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.colwise_operation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compare_matrix_columns">
<code class="descclassname">vtool.other.</code><code class="descname">compare_matrix_columns</code><span class="sig-paren">(</span><em>matrix</em>, <em>columns</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_matrix_columns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compare_matrix_to_rows">
<code class="descclassname">vtool.other.</code><code class="descname">compare_matrix_to_rows</code><span class="sig-paren">(</span><em>row_matrix</em>, <em>row_list</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_to_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_matrix_to_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares each row in row_list to each row in row matrix using comp_op
Both must have the same number of columns.
Performs logic_op on the results of each individual row</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>ibeis.model.hots.nn_weights.mark_name_valid_normalizers</dd>
</dl>
<p>compop   = np.equal
logic_op = np.logical_or</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.componentwise_dot">
<code class="descclassname">vtool.other.</code><code class="descname">componentwise_dot</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#componentwise_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.componentwise_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr1</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>arr2</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cosangle</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">arr1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosangle</span> <span class="o">=</span> <span class="n">componentwise_dot</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cosangle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 1.  1.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_arr_dataids">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_arr_dataids</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_arr_dataids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_arr_dataids" title="Permalink to this definition">¶</a></dt>
<dd><p>specialized version for speed when arr is an ndarray</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_data_ids">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_data_ids</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_data_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually faster than compute_unique_integer_data_ids it seems</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-compute_unique_data_ids
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataid_list</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;dataid_list = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">dataid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">dataid_list = np.array([0, 1, 2, 3, 0, 4, 4, 2, 1], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_data_ids_">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_data_ids_</code><span class="sig-paren">(</span><em>hashable_rows</em>, <em>iddict_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_data_ids_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_data_ids_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compute_unique_integer_data_ids">
<code class="descclassname">vtool.other.</code><code class="descname">compute_unique_integer_data_ids</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#compute_unique_integer_data_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compute_unique_integer_data_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>This is actually slower than compute_unique_data_ids it seems</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">compute_unique_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">compute_unique_integer_data_ids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>%timeit compute_unique_data_ids(data)
%timeit compute_unique_integer_data_ids(data)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_best_undirected_edge_indexes">
<code class="descclassname">vtool.other.</code><code class="descname">find_best_undirected_edge_indexes</code><span class="sig-paren">(</span><em>directed_edges</em>, <em>score_arr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_best_undirected_edge_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_best_undirected_edge_indexes" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>directed_edges</strong> &#8211; </li>
<li><strong>score_arr</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">unique_edge_xs</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><p>?</p>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-find_best_undirected_edge_indexes
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 3 4 6]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_arr</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_edge_xs</span> <span class="o">=</span> <span class="n">find_best_undirected_edge_indexes</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">,</span> <span class="n">score_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_edge_xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0 2 3 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_first_true_indices">
<code class="descclassname">vtool.other.</code><code class="descname">find_first_true_indices</code><span class="sig-paren">(</span><em>flags_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_first_true_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_first_true_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: move to vtool</p>
<p>returns a list of indexes where the index is the first True position
in the corresponding sublist or None if it does not exist</p>
<p>in other words: for each row finds the smallest True column number or None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) &#8211; list of lists of booleans</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m utool.util_list --test-find_first_true_indices
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">utool.util_list</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[0, None, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.find_next_true_indices">
<code class="descclassname">vtool.other.</code><code class="descname">find_next_true_indices</code><span class="sig-paren">(</span><em>flags_list</em>, <em>offset_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#find_next_true_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.find_next_true_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: move to vtool</p>
<p>Uses output of either this function or find_first_true_indices
to find the next index of true flags</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flags_list</strong> (<em>list</em>) &#8211; list of lists of booleans</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m utool.util_list --test-find_next_true_indices
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">utool.util_list</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_list</span> <span class="o">=</span> <span class="n">find_first_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">find_next_true_indices</span><span class="p">(</span><span class="n">flags_list</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2, None, 2, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.flag_intersection">
<code class="descclassname">vtool.other.</code><code class="descname">flag_intersection</code><span class="sig-paren">(</span><em>X_</em>, <em>C_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#flag_intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.flag_intersection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_consec_endpoint">
<code class="descclassname">vtool.other.</code><code class="descname">get_consec_endpoint</code><span class="sig-paren">(</span><em>consec_index_list</em>, <em>endpoint</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_consec_endpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_consec_endpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>consec_index_list = consec_cols_list
endpoint = 0</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.get_covered_mask">
<code class="descclassname">vtool.other.</code><code class="descname">get_covered_mask</code><span class="sig-paren">(</span><em>covered_array</em>, <em>covering_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_covered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_covered_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_crop_slices">
<code class="descclassname">vtool.other.</code><code class="descname">get_crop_slices</code><span class="sig-paren">(</span><em>isfill</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_crop_slices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_crop_slices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_uncovered_mask">
<code class="descclassname">vtool.other.</code><code class="descname">get_uncovered_mask</code><span class="sig-paren">(</span><em>covered_array</em>, <em>covering_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_uncovered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_uncovered_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>covered_array</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>covering_array</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">flags</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-get_uncovered_mask
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True False  True False False]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True  True  True  True  True]</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ True, False,  True],</span>
<span class="go">          [False, False,  True],</span>
<span class="go">          [ True,  True,  True]], dtype=bool)</span>
</pre></div>
</div>
</dd>
<dt>Ignore::</dt>
<dd>covering_array = [1, 2, 3, 4, 5, 6, 7]
%timeit get_uncovered_mask(covered_array, covering_array)
100000 loops, best of 3: 18.6 µs per loop
%timeit get_uncovered_mask2(covered_array, covering_array)
100000 loops, best of 3: 16.9 µs per loop</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.get_undirected_edge_ids">
<code class="descclassname">vtool.other.</code><code class="descname">get_undirected_edge_ids</code><span class="sig-paren">(</span><em>directed_edges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#get_undirected_edge_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_undirected_edge_ids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>directed_edges</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">edgeid_list</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --exec-get_undirected_edge_ids
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directed_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgeid_list</span> <span class="o">=</span> <span class="n">get_undirected_edge_ids</span><span class="p">(</span><span class="n">directed_edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;edgeid_list = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">edgeid_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">edgeid_list = [0 0 1 2 3 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.grab_webcam_image">
<code class="descclassname">vtool.other.</code><code class="descname">grab_webcam_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#grab_webcam_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.grab_webcam_image" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_gui/py_video_display/py_video_display.html</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-grab_webcam_image --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">grab_webcam_image</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#vt.imwrite(&#39;webcap.jpg&#39;, img)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.index_partition">
<code class="descclassname">vtool.other.</code><code class="descname">index_partition</code><span class="sig-paren">(</span><em>item_list</em>, <em>part1_items</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#index_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.index_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>returns two lists. The first are the indecies of items in item_list that
are in part1_items. the second is the indices in item_list that are not
in part1_items. items in part1_items that are not in item_list are
ignored</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;dist&#39;</span><span class="p">,</span> <span class="s">&#39;fg&#39;</span><span class="p">,</span> <span class="s">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;fg&#39;</span><span class="p">,</span> <span class="s">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part1_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part2_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.index_to_boolmask">
<code class="descclassname">vtool.other.</code><code class="descname">index_to_boolmask</code><span class="sig-paren">(</span><em>index_list</em>, <em>maxval=None</em>, <em>hack=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#index_to_boolmask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.index_to_boolmask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index_list</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>maxval</strong> (<em>None</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>maxval</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --exec-index_to_boolmask
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">hack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;mask =</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[1 0 0]</span>
<span class="go"> [0 1 0]</span>
<span class="go"> [0 1 0]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxval</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">hack</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;mask = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">mask = [1 1 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect1d_reduce">
<code class="descclassname">vtool.other.</code><code class="descname">intersect1d_reduce</code><span class="sig-paren">(</span><em>arr_list</em>, <em>assume_unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect1d_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect1d_reduce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_flags">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_flags</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_flags" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray[ndims=2]</em>) &#8211; </li>
<li><strong>B</strong> (<em>ndarray[ndims=2]</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(flag_list1, flag_list2)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-intersect2d_flags
</pre></div>
</div>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>np.in1d - the one dimensional version</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_flags</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([False, False, False], dtype=bool), array([False, False, False, False, False], dtype=bool))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_indices">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_indices</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray[ndims=2]</em>) &#8211; </li>
<li><strong>B</strong> (<em>ndarray[ndims=2]</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(ax_list, bx_list)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-intersect2d_indices
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">542</span><span class="p">,</span>  <span class="mi">297</span><span class="p">],</span> <span class="p">[</span> <span class="mi">955</span><span class="p">,</span> <span class="mi">1113</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">],</span> <span class="p">[</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1265</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">117</span><span class="p">,</span>  <span class="mi">211</span><span class="p">],</span> <span class="p">[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">309</span><span class="p">,</span>  <span class="mi">328</span><span class="p">],</span> <span class="p">[</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span>  <span class="mi">357</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_indices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([0, 3, 4]), array([1, 2, 6]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_numpy">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_numpy</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>assume_unique=False</em>, <em>return_indices=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_numpy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>References::</dt>
<dd><a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155</a></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray[ndims=2]</em>) &#8211; </li>
<li><strong>B</strong> (<em>ndarray[ndims=2]</em>) &#8211; </li>
<li><strong>assume_unique</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">C</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[ndims=2]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-intersect2d_numpy
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">535</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">152</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">387</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span> <span class="mi">261</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">403</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">815</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mi">22</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">254</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assume_unique</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[ 85, 403, 412],</span>
<span class="go">       [ 32,  22, 103]]), array([2, 6, 7]), array([0, 1, 2]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[1, 2, 3]]), array([0]), array([0]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_structured_numpy">
<code class="descclassname">vtool.other.</code><code class="descname">intersect2d_structured_numpy</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>assume_unique=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#intersect2d_structured_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_structured_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a>
<a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.iter_reduce_ufunc">
<code class="descclassname">vtool.other.</code><code class="descname">iter_reduce_ufunc</code><span class="sig-paren">(</span><em>ufunc</em>, <em>arr_iter</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#iter_reduce_ufunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.iter_reduce_ufunc" title="Permalink to this definition">¶</a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;memory = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;gen_memory = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;res1       = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;res2       = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;res3       = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;memory     = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;gen_memory = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.list_compress_">
<code class="descclassname">vtool.other.</code><code class="descname">list_compress_</code><span class="sig-paren">(</span><em>list_</em>, <em>flag_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_compress_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.list_compress_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.list_take_">
<code class="descclassname">vtool.other.</code><code class="descname">list_take_</code><span class="sig-paren">(</span><em>list_</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#list_take_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.list_take_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.mult_lists">
<code class="descclassname">vtool.other.</code><code class="descname">mult_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#mult_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.mult_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.nearest_point">
<code class="descclassname">vtool.other.</code><code class="descname">nearest_point</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>pts</em>, <em>mode=u'random'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nearest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.nonunique_row_flags">
<code class="descclassname">vtool.other.</code><code class="descname">nonunique_row_flags</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nonunique_row_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.nonunique_row_indexes">
<code class="descclassname">vtool.other.</code><code class="descname">nonunique_row_indexes</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#nonunique_row_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nonunique_row_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>rows that are not unique (does not include the first instance of each pattern)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) &#8211; 2d array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">nonunique_rowx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>unique_row_indexes
nonunique_row_flags</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-unique_row_indexes
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonunique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;nonunique_rowx = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">nonunique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nonunique_rowx = np.array([4, 6, 7, 8], dtype=np.int64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.norm01">
<code class="descclassname">vtool.other.</code><code class="descname">norm01</code><span class="sig-paren">(</span><em>array</em>, <em>dim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#norm01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.norm01" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes a numpy array from 0 to 1 based in its extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>dim</strong> (<em>int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-norm01
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_norm</span> <span class="o">=</span> <span class="n">norm01</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">array_norm</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 0.512  0.     0.049  0.024  0.22   1.   ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.or_lists">
<code class="descclassname">vtool.other.</code><code class="descname">or_lists</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#or_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.or_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>and_lists</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.pdist_argsort">
<code class="descclassname">vtool.other.</code><code class="descname">pdist_argsort</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#pdist_argsort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.pdist_argsort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts 2d indicies by their distnace matrix output from scipy.spatial.distance</p>
<p>x = np.array([  3.05555556e-03,   1.47619797e+04,   1.47619828e+04])</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">sortx_2d</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">?</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-pdist_argsort
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">21695.78</span><span class="p">,</span> <span class="mf">10943.76</span><span class="p">,</span> <span class="mf">10941.44</span><span class="p">,</span> <span class="mf">25867.64</span><span class="p">,</span> <span class="mf">10752.03</span><span class="p">,</span> <span class="mf">10754.35</span><span class="p">,</span> <span class="mf">4171.86</span><span class="p">,</span> <span class="mf">2.32</span><span class="p">,</span> <span class="mf">14923.89</span><span class="p">,</span> <span class="mf">14926.2</span> <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#[ 21025.45583333,    670.60055556,  54936.59111111,  21696.05638889, 33911.13527778,  55607.19166667]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sortx_2d</span> <span class="o">=</span> <span class="n">pdist_argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;sortx_2d = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sortx_2d</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">sortx_2d = [(2, 3), (1, 4), (1, 2), (1, 3), (0, 3), (0, 2), (2, 4), (3, 4), (0, 1), (0, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.rebuild_partition">
<code class="descclassname">vtool.other.</code><code class="descname">rebuild_partition</code><span class="sig-paren">(</span><em>part1_vals</em>, <em>part2_vals</em>, <em>part1_indexes</em>, <em>part2_indexes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rebuild_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.rebuild_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts work done by index_partition</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>part1_vals</strong> &#8211; </li>
<li><strong>part2_vals</strong> (<em>dict</em>) &#8211; </li>
<li><strong>part1_indexes</strong> &#8211; </li>
<li><strong>part2_indexes</strong> (<em>dict</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-rebuild_partition
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;dist&#39;</span><span class="p">,</span> <span class="s">&#39;fg&#39;</span><span class="p">,</span> <span class="s">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;fg&#39;</span><span class="p">,</span> <span class="s">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part2_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_take</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val_list</span> <span class="o">=</span> <span class="n">rebuild_partition</span><span class="p">(</span><span class="n">part1_vals</span><span class="p">,</span> <span class="n">part2_vals</span><span class="p">,</span> <span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">val_list</span> <span class="o">==</span> <span class="n">item_list</span><span class="p">,</span> <span class="s">&#39;incorrect inversin&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.rowwise_operation">
<code class="descclassname">vtool.other.</code><code class="descname">rowwise_operation</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em>, <em>op</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#rowwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.rowwise_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE THIS IS POSSIBLE WITH STRICTLY BROADCASTING AND
USING np.newaxis</p>
<p>DEPRICATE, numpy has better ways of doing this.
Is the rowwise name correct? Should it be colwise?</p>
<p>performs an operation between an
(N x A x B ... x Z) array with an
(N x 1) array</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.safe_vstack">
<code class="descclassname">vtool.other.</code><code class="descname">safe_vstack</code><span class="sig-paren">(</span><em>tup</em>, <em>default_shape=(0</em>, <em>)</em>, <em>default_dtype=&lt;type 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#safe_vstack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.safe_vstack" title="Permalink to this definition">¶</a></dt>
<dd><p>stacks a tuple even if it is empty</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.trytake">
<code class="descclassname">vtool.other.</code><code class="descname">trytake</code><span class="sig-paren">(</span><em>list_</em>, <em>index_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#trytake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.trytake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.unique_row_indexes">
<code class="descclassname">vtool.other.</code><code class="descname">unique_row_indexes</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unique_row_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.unique_row_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>np.unique on rows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arr</strong> (<em>ndarray</em>) &#8211; 2d array</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unique_rowx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array">http://stackoverflow.com/questions/16970982/find-unique-rows-in-numpy-array</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-unique_row_indexes
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">534</span><span class="p">,</span> <span class="o">.</span><span class="mi">432</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_rowx</span> <span class="o">=</span> <span class="n">unique_row_indexes</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;unique_rowx = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">unique_rowx</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">unique_rowx = np.array([0, 1, 2, 3, 5], dtype=np.int64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.unique_rows">
<code class="descclassname">vtool.other.</code><code class="descname">unique_rows</code><span class="sig-paren">(</span><em>arr</em>, <em>directed=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#unique_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.unique_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Order or columns does not matter if directed = False</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_average_scoring">
<code class="descclassname">vtool.other.</code><code class="descname">weighted_average_scoring</code><span class="sig-paren">(</span><em>fsv</em>, <em>weight_filtxs</em>, <em>nonweight_filtxs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_average_scoring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_average_scoring" title="Permalink to this definition">¶</a></dt>
<dd><p>does frac{sum_i w^f_i * w^d_i * r_i}{sum_i w^f_i, w^d_i}
to get a weighed average of ratio scores</p>
<p>If we normalize the weight part to add to 1 then we can get per-feature
scores.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Weighted_arithmetic_mean">http://en.wikipedia.org/wiki/Weighted_arithmetic_mean</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.82992172</span><span class="p">,</span>  <span class="mf">1.56136119</span><span class="p">,</span>  <span class="mf">0.66465378</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8000412</span> <span class="p">,</span>  <span class="mf">2.14719748</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.80848503</span><span class="p">,</span>  <span class="mf">2.6816361</span> <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.86761665</span><span class="p">,</span>  <span class="mf">2.70189977</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8004055</span> <span class="p">,</span>  <span class="mf">1.58753884</span><span class="p">,</span>  <span class="mf">0.92178345</span><span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonweight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_fs</span> <span class="o">=</span> <span class="n">weighted_average_scoring</span><span class="p">(</span><span class="n">fsv</span><span class="p">,</span> <span class="n">weight_filtxs</span><span class="p">,</span> <span class="n">nonweight_filtxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">new_fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 0.08585277  0.17123899  0.21611761  0.23367671  0.11675666]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_geometic_mean">
<code class="descclassname">vtool.other.</code><code class="descname">weighted_geometic_mean</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_geometic_mean" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list of ndarrays</em>) &#8211; </li>
<li><strong>weights</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a href="#id33"><span class="problematic" id="id34">gmean_</span></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.other --test-weighted_geometic_mean
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Weighted_geometric_mean">https://en.wikipedia.org/wiki/Weighted_geometric_mean</a></p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>scipy.stats.mstats.gmean</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;gmean_ = </span><span class="si">%.3f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gmean_</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">gmean_ = 0.740</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmean_</span> <span class="o">=</span> <span class="n">weighted_geometic_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;gmean_ = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">gmean_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">gmean_ = np.array([[ 0.11,  0.77,  0.68,  0.69],</span>
<span class="go">                   [ 0.64,  0.72,  0.45,  0.83],</span>
<span class="go">                   [ 0.34,  0.5 ,  0.34,  0.71],</span>
<span class="go">                   [ 0.54,  0.62,  0.14,  0.26]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_geometic_mean_unnormalized">
<code class="descclassname">vtool.other.</code><code class="descname">weighted_geometic_mean_unnormalized</code><span class="sig-paren">(</span><em>data</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#weighted_geometic_mean_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_geometic_mean_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.zipcompress">
<code class="descclassname">vtool.other.</code><code class="descname">zipcompress</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.zipcompress_safe">
<code class="descclassname">vtool.other.</code><code class="descname">zipcompress_safe</code><span class="sig-paren">(</span><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#zipcompress_safe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zipcompress_safe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.ziptake">
<code class="descclassname">vtool.other.</code><code class="descname">ziptake</code><span class="sig-paren">(</span><em>arr_list</em>, <em>indices_list</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/other.html#ziptake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.ziptake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.patch">
<span id="vtool-patch-module"></span><h2>vtool.patch module<a class="headerlink" href="#module-vtool.patch" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.patch.GaussianBlurInplace">
<code class="descclassname">vtool.patch.</code><code class="descname">GaussianBlurInplace</code><span class="sig-paren">(</span><em>img</em>, <em>sigma</em>, <em>size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#GaussianBlurInplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.GaussianBlurInplace" title="Permalink to this definition">¶</a></dt>
<dd><p>simulates code from helpers.cpp in hesaff</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>sigma</strong> (<em>flaot</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-GaussianBlurInplace:0 --show
python -m vtool.patch --test-GaussianBlurInplace:1 --show
</pre></div>
</div>
<dl class="docutils">
<dt>References;</dt>
<dd><a class="reference external" href="http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf">http://www.cse.usf.edu/~r1k/MachineVisionBook/MachineVision.files/MachineVision_Chapter4.pdf</a>
<a class="reference external" href="http://en.wikipedia.org/wiki/Scale_space_implementation">http://en.wikipedia.org/wiki/Scale_space_implementation</a>
<a class="reference external" href="http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf">http://www.cse.psu.edu/~rtc12/CSE486/lecture10_6pp.pdf</a></dd>
</dl>
<p class="rubric">Notes</p>
<p>The product of the convolution of two Gaussian functions with spread
sigma is a Gaussian function with spread sqrt(2)*sigma scaled by the
area of the Gaussian filter</p>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">size</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># check if even</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># demonstrate cascading smoothing property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># THIS ISNT WORKING WHY???</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img3</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img4</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma1</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma2</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma3</span> <span class="o">=</span> <span class="n">sigma1</span> <span class="o">+</span> <span class="n">sigma2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># compoments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># all in one shot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># addative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img4</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">((</span><span class="n">img4</span> <span class="o">-</span> <span class="n">img3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#fig.add_subplot(1, 3, 1, projection=&#39;3d&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">,</span> <span class="n">sigma3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img4</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%r</span><span class="s"> + </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_dominant_kp_orientations">
<code class="descclassname">vtool.patch.</code><code class="descname">find_dominant_kp_orientations</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_dominant_kp_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_dominant_kp_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a>
page 219</p>
<p><a class="reference external" href="http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf">http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf</a>
page 13.</p>
<p>Lowe uses a 36-bin histogram of edge orientations weigted by a gaussian
distance to the center and gradient magintude. He finds all peaks within
80% of the global maximum. Then he fine tunes the orientation using a
3-binned parabolic fit. Multiple orientations (and hence multiple
keypoints) can be returned, but empirically only about 15% will have
these and they do tend to be important.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ori_offset - offset of current orientation to dominant orientation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-find_dominant_kp_orientations
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#imgBGR = get_test_patch(&#39;cross&#39;, jitter=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;kp = </span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">kp_cpp_infostr</span><span class="p">(</span><span class="n">kp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_oris</span> <span class="o">=</span> <span class="n">find_dominant_kp_orientations</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">,</span> <span class="n">DEBUG_ROTINVAR</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;new_oris = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_oris</span><span class="p">,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_kpts_direction">
<code class="descclassname">vtool.patch.</code><code class="descname">find_kpts_direction</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kpts</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_kpts_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_kpts_direction" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imgBGR</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data in opencv format (blue, green, red)</li>
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">kpts -  keypoints</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-find_kpts_direction
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_patch_dominant_orientations">
<code class="descclassname">vtool.patch.</code><code class="descname">find_patch_dominant_orientations</code><span class="sig-paren">(</span><em>patch</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#find_patch_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_patch_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_average_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">gaussian_average_patch</code><span class="sig-paren">(</span><em>patch</em>, <em>sigma=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_average_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_average_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patch</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>sigma</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-gaussian_average_patch
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_star_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_average_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.414210641527</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">gaussian_patch</code><span class="sig-paren">(</span><em>shape=(7</em>, <em>7)</em>, <em>sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>another version of the guassian_patch function. hopefully better</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> (<em>tuple</em>) &#8211; array dimensions</li>
<li><strong>sigma</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-gaussian_patch2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gausspatch</span> <span class="o">=</span> <span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gausspatch</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_weight_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">gaussian_weight_patch</code><span class="sig-paren">(</span><em>patch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.get_cross_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_cross_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_cross_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_cross_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_no_symbol">
<code class="descclassname">vtool.patch.</code><code class="descname">get_no_symbol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_no_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_no_symbol" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">errorimg</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-get_no_symbol --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errorimg</span> <span class="o">=</span> <span class="n">get_no_symbol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">errorimg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_orientation_histogram">
<code class="descclassname">vtool.patch.</code><code class="descname">get_orientation_histogram</code><span class="sig-paren">(</span><em>gori</em>, <em>gori_weights</em>, <em>bins=36</em>, <em>DEBUG_ROTINVAR=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_orientation_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_orientation_histogram" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gori</strong> &#8211; </li>
<li><strong>gori_weights</strong> &#8211; </li>
<li><strong>bins</strong> (<em>int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(hist, centers)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-get_orientation_histogram
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">6.15</span><span class="p">,</span>  <span class="mf">3.13</span><span class="p">,</span>  <span class="mf">3.24</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">4.61</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.57</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">1.57</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_orientation_histogram</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gori_weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_star2_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_star2_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star2_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_star2_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_star_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_star_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_star_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_star_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_stripe_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_stripe_patch</code><span class="sig-paren">(</span><em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_stripe_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_stripe_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_test_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_test_patch</code><span class="sig-paren">(</span><em>key='star'</em>, <em>jitter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_test_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_test_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<em>str</em>) &#8211; </li>
<li><strong>jitter</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">patch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-get_test_patch --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s">&#39;star2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jitter</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jitter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_unwarped_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_unwarped_patch</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unwarped warped patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) &#8211; keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_unwarped_patches">
<code class="descclassname">vtool.patch.</code><code class="descname">get_unwarped_patches</code><span class="sig-paren">(</span><em>img</em>, <em>kpts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cropped unwarped (keypoint is still elliptical) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpts</strong> (<em>ndarrays</em>) &#8211; keypoint ndarrays in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(patches, subkpts) - the unnormalized patches from the img
corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_warped_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">get_warped_patch</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em>, <em>flags=4</em>, <em>borderMode=1</em>, <em>patch_size=41</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_warped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) &#8211; keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_warped_patches">
<code class="descclassname">vtool.patch.</code><code class="descname">get_warped_patches</code><span class="sig-paren">(</span><em>img</em>, <em>kpts</em>, <em>flags=4</em>, <em>borderMode=1</em>, <em>patch_size=41</em>, <em>use_cpp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_warped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<dl class="docutils">
<dt>FIXME:</dt>
<dd>there is a slight translation difference in the way Python extracts
patches and the way C++ extracts patches. C++ should be correct.
TODO: have C++ able to extract color.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; array representing an image</li>
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoint ndarrays in [x, y, a, c, d, theta] format</li>
<li><strong>img</strong> &#8211; image data</li>
<li><strong>kpts</strong> &#8211; keypoints</li>
<li><strong>flags</strong> (<em>long</em>) &#8211; cv2 interpolation flags</li>
<li><strong>borderMode</strong> (<em>long</em>) &#8211; cv2 border flags</li>
<li><strong>patch_size</strong> (<em>int</em>) &#8211; resolution of resulting image patch</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(warped_patches, warped_subkpts) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">tuple</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(warped_patches, warped_subkpts)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-get_warped_patches --show --use_cpp
python -m vtool.patch --test-get_warped_patches --show --use_python
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cpp</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--use_cpp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LANCZOS4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">borderMode</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_REPLICATE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">warped_patches</span><span class="p">,</span> <span class="n">warped_subkpts</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_warped_patches</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">borderMode</span><span class="p">,</span> <span class="n">use_cpp</span><span class="o">=</span><span class="n">use_cpp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">warped_subkpts</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">warped_patches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_kpts2(warped_subkpts, pts=True, rect=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;use_cpp = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">use_cpp</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.intern_warp_single_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">intern_warp_single_patch</code><span class="sig-paren">(</span><em>img</em>, <em>x</em>, <em>y</em>, <em>ori</em>, <em>V</em>, <em>patch_size</em>, <em>flags=2</em>, <em>borderMode=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#intern_warp_single_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.intern_warp_single_patch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first"># <a class="reference external" href="https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA">https://groups.google.com/forum/#!topic/sympy/k1HnZK_bNNA</a>
from vtool.patch import *  # NOQA
import sympy
from sympy.abc import theta
ori = theta
x, y, a, c, d, patch_size = sympy.symbols(&#8216;x y a c d S&#8217;)
half_patch_size = patch_size / 2</p>
<dl class="docutils">
<dt>def sympy_rotation_mat3x3(radians):</dt>
<dd><p class="first"># TODO: handle array impouts
<a href="#id35"><span class="problematic" id="id36">sin_</span></a> = sympy.sin(radians)
<a href="#id37"><span class="problematic" id="id38">cos_</span></a> = sympy.cos(radians)
R = np.array(((<a href="#id39"><span class="problematic" id="id40">cos_</span></a>, -<a href="#id41"><span class="problematic" id="id42">sin_</span></a>,  0),</p>
<blockquote>
<div>(<a href="#id43"><span class="problematic" id="id44">sin_</span></a>,  <a href="#id45"><span class="problematic" id="id46">cos_</span></a>,  0),
(   0,     0,  1),))</div></blockquote>
<p class="last">return sympy.Matrix(R)</p>
</dd>
</dl>
<p>kpts = np.array([[x, y, a, c, d, ori]])
kp = ktool.get_invV_mats(kpts, with_trans=True)[0]
invV = sympy.Matrix(kp)
V = invV.inv()
ss = sympy.sqrt(patch_size) * 3.0
T = sympy.Matrix(ltool.translation_mat3x3(-x, -y, None))  # Center the patch
R = sympy_rotation_mat3x3(-ori)  # Rotate the centered unit circle patch
S = sympy.Matrix(ltool.scale_mat3x3(ss, dtype=None))  # scale from unit circle to the patch size
X = sympy.Matrix(ltool.translation_mat3x3(half_patch_size, half_patch_size, None))  # Translate back to patch-image coordinates</p>
<p>sympy.MatMul(X, S, hold=True)</p>
<dl class="docutils">
<dt>def add_matmul_hold_prop(mat):</dt>
<dd><p class="first">#import functools
def matmul_hold(other, hold=True):</p>
<blockquote>
<div>new = sympy.MatMul(mat, other, hold=hold)
add_matmul_hold_prop(new)
return new</div></blockquote>
<p class="last">#matmul_hold = functools.partial(sympy.MatMul, mat, hold=True)
setattr(mat, &#8216;matmul_hold&#8217;, matmul_hold)</p>
</dd>
</dl>
<p>add_matmul_hold_prop(X)
add_matmul_hold_prop(S)
add_matmul_hold_prop(R)
add_matmul_hold_prop(V)
add_matmul_hold_prop(T)</p>
<p>M = X.matmul_hold(S).matmul_hold(R).matmul_hold(V).matmul_hold(T)
#M = X.multiply(S).multiply(R).multiply(V).multiply(T)</p>
<p class="last">V_full = R.multiply(V).multiply(T)
sympy.latex(V_full)
print(sympy.latex(R.multiply(V).multiply(T)))
print(sympy.latex(X))
print(sympy.latex(S))
print(sympy.latex(R))
print(sympy.latex(invV) + &#8216;^{-1}&#8217;)
print(sympy.latex(T))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.make_test_image_keypoints">
<code class="descclassname">vtool.patch.</code><code class="descname">make_test_image_keypoints</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>scale=1.0</em>, <em>skew=0</em>, <em>theta=0</em>, <em>shift=(0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#make_test_image_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.make_test_image_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_gradient">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_gradient</code><span class="sig-paren">(</span><em>patch</em>, <em>ksize=1</em>, <em>gaussian_weighted=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_mag">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_mag</code><span class="sig-paren">(</span><em>gradx</em>, <em>grady</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_mag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_ori">
<code class="descclassname">vtool.patch.</code><code class="descname">patch_ori</code><span class="sig-paren">(</span><em>gradx</em>, <em>grady</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#patch_ori"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_ori" title="Permalink to this definition">¶</a></dt>
<dd><p>returns patch orientation relative to the x-axis</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.show_gaussian_patch">
<code class="descclassname">vtool.patch.</code><code class="descname">show_gaussian_patch</code><span class="sig-paren">(</span><em>shape</em>, <em>sigma1</em>, <em>sigma2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.show_gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.show_patch_orientation_estimation">
<code class="descclassname">vtool.patch.</code><code class="descname">show_patch_orientation_estimation</code><span class="sig-paren">(</span><em>imgBGR</em>, <em>kpts</em>, <em>patch</em>, <em>gradx</em>, <em>grady</em>, <em>gmag</em>, <em>gori</em>, <em>hist</em>, <em>centers</em>, <em>gori_weights</em>, <em>fx=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#show_patch_orientation_estimation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.show_patch_orientation_estimation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.test_find_kp_direction">
<code class="descclassname">vtool.patch.</code><code class="descname">test_find_kp_direction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_find_kp_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_find_kp_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows steps in orientation estimation</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-test_find_kp_direction --show --diskshow
python -m vtool.patch --test-test_find_kp_direction --show --interact
python -m vtool.patch --test-test_find_kp_direction --save ~/latex/crall-candidacy-2015/figures/test_fint_kp_direction.jpg --dpath figures <span class="s1">&#39;--caption=visualization of the steps in the computation of the dominant gradient orientations.&#39;</span> --figsize<span class="o">=</span>14,9 --dpi<span class="o">=</span><span class="m">160</span> --height<span class="o">=</span>2.65  --left<span class="o">=</span>.04 --right<span class="o">=</span>.96 --top<span class="o">=</span>.95 --bottom<span class="o">=</span>.05 --wspace<span class="o">=</span>.1 --hspace<span class="o">=</span>.1

python -m vtool.patch --test-test_find_kp_direction --dpath ~/latex/crall-candidacy-2015/ --save figures/test_find_kp_direction.jpg  --figsize<span class="o">=</span>14,9 --dpi<span class="o">=</span><span class="m">180</span> --height<span class="o">=</span>2.65 --left<span class="o">=</span>.04 --right<span class="o">=</span>.96 --top<span class="o">=</span>.95 --bottom<span class="o">=</span>.05 --wspace<span class="o">=</span>.1 --hspace<span class="o">=</span>.1 --diskshow

python -m vtool.patch --test-test_find_kp_direction --dpath ~/latex/crall-candidacy-2015/ --save figures/test_find_kp_direction.jpg  --figsize<span class="o">=</span>14,9 --dpi<span class="o">=</span><span class="m">180</span>  --djust<span class="o">=</span>.04,.05,.1 --diskshow --fname<span class="o">=</span>zebra.png --fx<span class="o">=</span>121
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_find_kp_direction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations">
<code class="descclassname">vtool.patch.</code><code class="descname">test_ondisk_find_patch_fpath_dominant_orientations</code><span class="sig-paren">(</span><em>patch_fpath</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_ondisk_find_patch_fpath_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patch_fpath</strong> &#8211; </li>
<li><strong>bins</strong> (<em>int</em>) &#8211; </li>
<li><strong>maxima_thresh</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-test_ondisk_find_patch_fpath_dominant_orientations
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--patch-fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_ondisk_find_patch_fpath_dominant_orientations</span><span class="p">(</span><span class="n">patch_fpath</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_show_gaussian_patches">
<code class="descclassname">vtool.patch.</code><code class="descname">test_show_gaussian_patches</code><span class="sig-paren">(</span><em>shape=(19</em>, <em>19)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-test_show_gaussian_patches --show
python -m vtool.patch --test-test_show_gaussian_patches --show --shape<span class="o">=</span>7,7
python -m vtool.patch --test-test_show_gaussian_patches --show --shape<span class="o">=</span>17,17
python -m vtool.patch --test-test_show_gaussian_patches --show --shape<span class="o">=</span>41,41
python -m vtool.patch --test-test_show_gaussian_patches --show --shape<span class="o">=</span>41,7
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_show_gaussian_patches2">
<code class="descclassname">vtool.patch.</code><code class="descname">test_show_gaussian_patches2</code><span class="sig-paren">(</span><em>shape=(19</em>, <em>19)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches2" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.patch --test-test_show_gaussian_patches2 --show
python -m vtool.patch --test-test_show_gaussian_patches2 --show --shape<span class="o">=</span>7,7
python -m vtool.patch --test-test_show_gaussian_patches2 --show --shape<span class="o">=</span>19,19
python -m vtool.patch --test-test_show_gaussian_patches2 --show --shape<span class="o">=</span>41,41
python -m vtool.patch --test-test_show_gaussian_patches2 --show --shape<span class="o">=</span>41,7
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches2</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.quality_classifier">
<span id="vtool-quality-classifier-module"></span><h2>vtool.quality_classifier module<a class="headerlink" href="#module-vtool.quality_classifier" title="Permalink to this headline">¶</a></h2>
<p class="rubric">References</p>
<p>% Single-image noise level estimation for blind denoising.
% <a class="reference external" href="http://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdfhttp://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdf">http://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdfhttp://www.ok.ctrl.titech.ac.jp/res/NLE/TIP2013-noise-level-estimation06607209.pdf</a></p>
<dl class="function">
<dt id="vtool.quality_classifier.compute_average_contrast">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">compute_average_contrast</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#compute_average_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.compute_average_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">average_contrast</span> <span class="o">=</span> <span class="n">compute_average_contrast</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">average_contrast</span><span class="p">,</span> <span class="o">.</span><span class="mo">0075</span><span class="p">,</span> <span class="o">.</span><span class="mo">00</span><span class="mi">85</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.fourier_devtest">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">fourier_devtest</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#fourier_devtest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.fourier_devtest" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.quality_classifier --test-fourier_devtest --show
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html</a>
<a class="reference external" href="http://cns-alumni.bu.edu/~slehar/fourier/fourier.html">http://cns-alumni.bu.edu/~slehar/fourier/fourier.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magnitude_spectrum</span> <span class="o">=</span> <span class="n">fourier_devtest</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.test_average_contrast">
<code class="descclassname">vtool.quality_classifier.</code><code class="descname">test_average_contrast</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/quality_classifier.html#test_average_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.test_average_contrast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.score_normalization">
<span id="vtool-score-normalization-module"></span><h2>vtool.score_normalization module<a class="headerlink" href="#module-vtool.score_normalization" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.score_normalization.ScoreNormalizer">
<em class="property">class </em><code class="descclassname">vtool.score_normalization.</code><code class="descname">ScoreNormalizer</code><span class="sig-paren">(</span><em>encoder</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Conforms to scikit-learn Estimator interface</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-ScoreNormalizer --show
</pre></div>
</div>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>tpr (float): target true positive rate (default .90)
fpr (float): target false positive rate (default None)
gridsize=1024,
adjust=8,
monotonize=False, if True ensures infered probability curves are monotonic
clip_factor=None,
reverse (bool): True if lower scores are better, False if higher scores are better (default=None)</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;index&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em>, <em>y</em>, <em>attrs=None</em>, <em>verbose=False</em>, <em>finite_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits estimator to data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>ndarray</em>) &#8211; 1 dimensional scores</li>
<li><strong>y</strong> (<em>ndarray</em>) &#8211; True or False labels</li>
<li><strong>attrs</strong> (<em>dict</em>) &#8211; dictionary of data attributes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.fit_partitioned">
<code class="descname">fit_partitioned</code><span class="sig-paren">(</span><em>encoder</em>, <em>tp_scores</em>, <em>tn_scores</em>, <em>part_attrs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.fit_partitioned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.fit_partitioned" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience func to fit only scores that have been separated
instead of labeled</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_accuracy">
<code class="descname">get_accuracy</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_accuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_confusion_indicies">
<code class="descname">get_confusion_indicies</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_confusion_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_confusion_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>combination of get_correct_indices and get_error_indicies</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_correct_indices">
<code class="descname">get_correct_indices</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_correct_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_correct_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ndarray</em>) &#8211; data</li>
<li><strong>y</strong> (<em>ndarray</em>) &#8211; labels</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fp_indicies, fn_indicies)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-get_correct_indices
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">,</span> <span class="n">tn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_correct_indices</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">tn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s">&#39;tp_X = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str2</span><span class="p">(</span><span class="n">tp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">tn_X = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str2</span><span class="p">(</span><span class="n">tn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_X = np.array([ 8.883,  8.77 ,  8.759])</span>
<span class="go">tn_X = np.array([ 0.727,  0.76 ,  0.841])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_error_indicies">
<code class="descname">get_error_indicies</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_error_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_error_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indicies of the most difficult type I and type II errors.</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">testdata_score_normalier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">,</span> <span class="n">fn_indicies</span><span class="p">)</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_error_indicies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fp_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">fn_indicies</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span>    <span class="s">&#39;fp_X = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str2</span><span class="p">(</span><span class="n">fp_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">fn_X = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str2</span><span class="p">(</span><span class="n">fn_X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">fp_X = np.array([ 6.196,  5.912,  5.804])</span>
<span class="go">fn_X = np.array([ 3.947,  4.277,  4.43 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_partitioned_support">
<code class="descname">get_partitioned_support</code><span class="sig-paren">(</span><em>encoder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_partitioned_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_partitioned_support" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience get prepartitioned data</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.get_support">
<code class="descname">get_support</code><span class="sig-paren">(</span><em>encoder</em>, <em>finite_only=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.get_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.get_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.inverse_normalize">
<code class="descname">inverse_normalize</code><span class="sig-paren">(</span><em>encoder</em>, <em>probs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.inverse_normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.inverse_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.learn_probabilities">
<code class="descname">learn_probabilities</code><span class="sig-paren">(</span><em>encoder</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel density estimation</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.learn_threshold">
<code class="descname">learn_threshold</code><span class="sig-paren">(</span><em>encoder</em>, <em>verbose=False</em>, <em>**thresh_kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Learns cutoff threshold that achieves the target confusion metric
Typically a desired false positive rate (recall) is specified</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.learn_threshold2">
<code class="descname">learn_threshold2</code><span class="sig-paren">(</span><em>encoder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.learn_threshold2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.learn_threshold2" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a cutoff where the probability of a truepos stats becoming
greater than probability of trueneg</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.normalize_scores">
<code class="descname">normalize_scores</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.normalize_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.normalize_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>encoder</em>, <em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict true or false of <code class="docutils literal"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.score_normalization.ScoreNormalizer.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>encoder</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.ScoreNormalizer.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>shows details about the score normalizer</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>fnum
figtitle
interactive
with_scores
with_roc
with_precision_recall</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --exec-ScoreNormalizer.visualize:0 --show
python -m vtool.score_normalization --exec-ScoreNormalizer.visualize:1 --show
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_hist</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">testdata_binary_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_pr</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_roc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_hist</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">with_scores</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">with_prebayes</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">with_postbayes</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">target_tpr</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.check_unused_kwargs">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">check_unused_kwargs</code><span class="sig-paren">(</span><em>kwargs</em>, <em>expected_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#check_unused_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.check_unused_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.estimate_pdf">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">estimate_pdf</code><span class="sig-paren">(</span><em>data</em>, <em>gridsize=1024</em>, <em>adjust=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#estimate_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.estimate_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>References;</dt>
<dd><a class="reference external" href="http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html">http://statsmodels.sourceforge.net/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html</a>
<a class="reference external" href="https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/">https://jakevdp.github.io/blog/2013/12/01/kernel-density-estimation/</a></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>ndarray</em>) &#8211; 1 dimensional data of float64</li>
<li><strong>gridsize</strong> (<em>int</em>) &#8211; domain size</li>
<li><strong>adjust</strong> (<em>int</em>) &#8211; smoothing factor</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data_pdf</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --exec-estimate_pdf --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_pdf</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">estimate_pdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_pdf</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.find_clip_range">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">find_clip_range</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>clip_factor=2.6180339887499997</em>, <em>reverse=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#find_clip_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.find_clip_range" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: generalize to arbitrary domains (not just 0-&gt;inf)</p>
<p>Finds score to clip true positives past. This is useful when the highest
true positive scores can be much larger than the highest true negative
score.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_support</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>tn_support</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>clip_factor</strong> (<em>float</em>) &#8211; factor of the true negative domain to search for true positives</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">min_score, max_score</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-find_clip_range
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">PHI</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span> <span class="o">=</span> <span class="n">find_clip_range</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span>  <span class="n">clip_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%.4f</span><span class="s">, </span><span class="si">%.4f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">min_score</span><span class="p">,</span> <span class="n">max_score</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">10.0000, 287.9837</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.flatten_scores">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">flatten_scores</code><span class="sig-paren">(</span><em>tp_scores</em>, <em>tn_scores</em>, <em>part_attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#flatten_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.flatten_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_scores</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>tn_scores</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>part_attrs</strong> (<em>dict</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(scores, labels, attrs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-flatten_scores
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part_attrs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;qaid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]},</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">flatten_scores</span><span class="p">(</span>
<span class="gp">... </span><span class="n">tp_scores</span><span class="p">,</span> <span class="n">tn_scores</span><span class="p">,</span> <span class="n">part_attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s">&#39;X&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;attrs&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">X=np.array([5, 6, 6, 7, 1, 2, 2]),</span>
<span class="go">y=np.array([1, 1, 1, 1, 0, 0, 0]),</span>
<span class="go">attrs={&#39;qaid&#39;: np.array([21, 24, 25, 26, 11, 14, 15])},</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.inspect_pdfs">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">inspect_pdfs</code><span class="sig-paren">(</span><em>tn_support</em>, <em>tp_support</em>, <em>score_domain</em>, <em>p_tp_given_score</em>, <em>p_tn_given_score</em>, <em>p_score_given_tp</em>, <em>p_score_given_tn</em>, <em>p_score</em>, <em>prob_thresh=None</em>, <em>score_thresh=None</em>, <em>with_scores=False</em>, <em>with_roc=False</em>, <em>with_precision_recall=False</em>, <em>with_hist=False</em>, <em>fnum=None</em>, <em>figtitle=None</em>, <em>interactive=None</em>, <em>use_stems=None</em>, <em>part_attrs=None</em>, <em>thresh_kw=None</em>, <em>attr_callback=None</em>, <em>with_prebayes=True</em>, <em>with_postbayes=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#inspect_pdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.inspect_pdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows plots of learned thresholds</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-ScoreNormalizer --show
python -m vtool.score_normalization --exec-ScoreNormalizer.visualize --show
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.learn_score_normalization">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">learn_score_normalization</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>gridsize=1024</em>, <em>adjust=8</em>, <em>return_all=False</em>, <em>monotonize=True</em>, <em>clip_factor=2.6180339887499997</em>, <em>verbose=False</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#learn_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.learn_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<p>#True positive scores must be larger than true negative scores.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_support</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>tn_support</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>gridsize</strong> (<em>int</em>) &#8211; default 512</li>
<li><strong>adjust</strong> (<em>int</em>) &#8211; default 8</li>
<li><strong>return_all</strong> (<em>bool</em>) &#8211; default False</li>
<li><strong>monotonize</strong> (<em>bool</em>) &#8211; default True</li>
<li><strong>clip_factor</strong> (<em>float</em>) &#8211; default phi ** 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-learn_score_normalization
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsize</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adjust</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">return_all</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monotonize</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_factor</span> <span class="o">=</span> <span class="mf">2.6180339887499997</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">92</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.normalize_scores">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">normalize_scores</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_tp_given_score</em>, <em>scores</em>, <em>interp_fn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#normalize_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.normalize_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjusts a raw scores to a probabilities based on a learned normalizer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>score_domain</strong> (<em>ndarray</em>) &#8211; input score domain</li>
<li><strong>p_tp_given_score</strong> (<em>ndarray</em>) &#8211; learned probability mapping</li>
<li><strong>scores</strong> (<em>ndarray</em>) &#8211; raw scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">probabilities</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-normalize_scores
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_tp_given_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">score_domain</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">score_domain</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.99</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#np.set_printoptions(suppress=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="s">&#39;r-x&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;learned probability&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s">&#39;yo&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Normalized scores&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;query points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">np.array([ 0.  ,  0.  ,  0.  ,  0.05,  0.64,  1.  ,  1.  ,  1.  ,  1.  ], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.partition_scores">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">partition_scores</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>attrs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#partition_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.partition_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience helper to translate partitioned to unpartitioned data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tp_scores</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>tn_scores</strong> (<em>ndarray</em>) &#8211; </li>
<li><strong>attrs</strong> (<em>dict</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(scores, labels, attrs)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-partition_scores
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;qaid&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">partition_scores</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resdict</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="s">&#39;tp_scores&#39;</span><span class="p">,</span> <span class="s">&#39;tn_scores&#39;</span><span class="p">,</span> <span class="s">&#39;part_attrs&#39;</span><span class="p">],</span> <span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">resdict</span><span class="p">,</span> <span class="n">nobraces</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">explicit</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tp_scores=np.array([5, 6, 6, 7]),</span>
<span class="go">tn_scores=np.array([1, 2, 2]),</span>
<span class="go">part_attrs={</span>
<span class="go">    False: {&#39;qaid&#39;: np.array([11, 14, 15])},</span>
<span class="go">    True: {&#39;qaid&#39;: np.array([21, 24, 25, 26])},</span>
<span class="go">},</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.plot_postbayes_pdf">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">plot_postbayes_pdf</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_tn_given_score</em>, <em>p_tp_given_score</em>, <em>score_thresh=None</em>, <em>prob_thresh=None</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_postbayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.plot_postbayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.plot_prebayes_pdf">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">plot_prebayes_pdf</code><span class="sig-paren">(</span><em>score_domain</em>, <em>p_score_given_tn</em>, <em>p_score_given_tp</em>, <em>p_score</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#plot_prebayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.plot_prebayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.test_score_normalization">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">test_score_normalization</code><span class="sig-paren">(</span><em>tp_support</em>, <em>tn_support</em>, <em>with_scores=True</em>, <em>verbose=True</em>, <em>with_roc=True</em>, <em>with_precision_recall=False</em>, <em>figtitle=None</em>, <em>normkw_varydict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#test_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.test_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives an overview of how well threshold can be learned from raw scores.</p>
<p>DEPRICATE</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.score_normalization --test-test_score_normalization --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GUI_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Shows how score normalization works with gaussian noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Get a training sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">randstate</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.score_normalization.testdata_score_normalier">
<code class="descclassname">vtool.score_normalization.</code><code class="descname">testdata_score_normalier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/score_normalization.html#testdata_score_normalier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.score_normalization.testdata_score_normalier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.segmentation">
<span id="vtool-segmentation-module"></span><h2>vtool.segmentation module<a class="headerlink" href="#module-vtool.segmentation" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.segmentation.clean_mask">
<code class="descclassname">vtool.segmentation.</code><code class="descname">clean_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>num_dilate=3</em>, <em>num_erode=3</em>, <em>window_frac=0.025</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#clean_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.clean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.demo_grabcut">
<code class="descclassname">vtool.segmentation.</code><code class="descname">demo_grabcut</code><span class="sig-paren">(</span><em>bgr_img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#demo_grabcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.demo_grabcut" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.segmentation --test-demo_grabcut --show
</pre></div>
</div>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>python -m ibeis.model.preproc.preproc_probchip &#8211;test-postprocess_dev</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.segmentation</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bgr_img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">bgr_img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_grabcut</span><span class="p">(</span><span class="n">bgr_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ut.quit_if_noshow()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.fill_holes">
<code class="descclassname">vtool.segmentation.</code><code class="descname">fill_holes</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#fill_holes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.fill_holes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.grabcut">
<code class="descclassname">vtool.segmentation.</code><code class="descname">grabcut</code><span class="sig-paren">(</span><em>bgr_img</em>, <em>prior_mask</em>, <em>binary=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.grabcut" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Referencs:</dt>
<dd><a class="reference external" href="http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html">http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.grabcut2">
<code class="descclassname">vtool.segmentation.</code><code class="descname">grabcut2</code><span class="sig-paren">(</span><em>rgb_chip</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.grabcut2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.mask_colored_img">
<code class="descclassname">vtool.segmentation.</code><code class="descname">mask_colored_img</code><span class="sig-paren">(</span><em>img_rgb</em>, <em>mask</em>, <em>encoding='bgr'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#mask_colored_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.mask_colored_img" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.printDBG">
<code class="descclassname">vtool.segmentation.</code><code class="descname">printDBG</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#printDBG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.printDBG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.resize_img_and_bbox">
<code class="descclassname">vtool.segmentation.</code><code class="descname">resize_img_and_bbox</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>bbox_</em>, <em>new_size=None</em>, <em>sqrt_area=400.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#resize_img_and_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.resize_img_and_bbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.segment">
<code class="descclassname">vtool.segmentation.</code><code class="descname">segment</code><span class="sig-paren">(</span><em>img_fpath</em>, <em>bbox_</em>, <em>new_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/segmentation.html#segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs grabcut</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.spatial_verification">
<span id="vtool-spatial-verification-module"></span><h2>vtool.spatial_verification module<a class="headerlink" href="#module-vtool.spatial_verification" title="Permalink to this headline">¶</a></h2>
<p>Spatial verification of keypoint matches</p>
<dl class="docutils">
<dt>Notation::</dt>
<dd>1_m = img1_matches; 2_m = img2_matches
x and y are locations, invV is the elliptical shapes.
fx are the original feature indexes (used for making sure 1 keypoint isn&#8217;t assigned to 2)</dd>
<dt>Look Into::</dt>
<dd>Standard
skimage.transform
<a class="reference external" href="http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy">http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy</a>
skimage.transform.fast_homography(im, H)</dd>
<dt>FIXME:</dt>
<dd>is it scaled_thresh or scaled_thresh_sqrd</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://ags.cs.uni-kl.de/fileadmin/inf_ags/3dcv-ws11-12/3DCV_WS11-12_lec04.pdf">http://ags.cs.uni-kl.de/fileadmin/inf_ags/3dcv-ws11-12/3DCV_WS11-12_lec04.pdf</a>
<a class="reference external" href="http://www.imgfsr.com/CVPR2011/Tutorial6/RANSAC_CVPR2011.pdf">http://www.imgfsr.com/CVPR2011/Tutorial6/RANSAC_CVPR2011.pdf</a></p>
<p class="rubric">Notes</p>
<p>Invariants of affine transforms - parallel lines, ratios of parallel lengths, ratios of areas
Invariants of homographies - cross‐ratio of four points on a line (ratio of ratio)</p>
<dl class="function">
<dt id="vtool.spatial_verification.build_affine_lstsqrs_Mx6">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">build_affine_lstsqrs_Mx6</code><span class="sig-paren">(</span><em>xy1_man</em>, <em>xy2_man</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_affine_lstsqrs_Mx6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.build_affine_lstsqrs_Mx6" title="Permalink to this definition">¶</a></dt>
<dd><p>CURRENTLY NOT WORKING</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-build_affine_lstsqrs_Mx6
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_man</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx6</span> <span class="o">=</span> <span class="n">build_affine_lstsqrs_Mx6</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">Mx6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><p class="first">import sympy as sym
x1, y1, x2, y2 = sym.symbols(&#8216;x1, y1, x2, y2&#8217;)
A = sym.Matrix([</p>
<blockquote>
<div>[x1, y1,  0,  0, 1, 0],
[ 0,  0, x1, y1, 0, 1],</div></blockquote>
<p class="last">])
b = sym.Matrix([[x2], [y2]])
x = (A.T.multiply(A)).inv().multiply(A.T.multiply(b))
x = (A.T.multiply(A)).pinv().multiply(A.T.multiply(b))</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf">https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf</a> page 22</p>
<dl class="docutils">
<dt>Ignore;</dt>
<dd>(U, S, V) = npl.svd(Mx6, full_matrices=True, compute_uv=True)
a = V[-6]  # Hack for Cython.wraparound(False)
a.reshape(2, 3)
A = np.vstack((a[0:3], a[3:6], (0, 0, 1)))</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.build_lstsqrs_Mx9">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">build_lstsqrs_Mx9</code><span class="sig-paren">(</span><em>xy1_mn</em>, <em>xy2_mn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_lstsqrs_Mx9"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.build_lstsqrs_Mx9" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the M x 9 least squares matrix</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-build_lstsqrs_Mx9
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx9</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">Mx9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">f@2l62+2!ppow8yw</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd>import numba
build_lstsqrs_Mx9_numba = numba.jit(build_lstsqrs_Mx9)
out1 = build_lstsqrs_Mx9_numba(xy1_mn, xy2_mn)
out2 = build_lstsqrs_Mx9(xy1_mn, xy2_mn)
assert np.all(out1 == out2)
%timeit build_lstsqrs_Mx9_numba(xy1_mn, xy2_mn)
%timeit build_lstsqrs_Mx9(xy1_mn, xy2_mn)</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf">http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317
<a class="reference external" href="http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf">http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf</a> page 53</p>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#CYTH_RETURNS np.ndarray[np.float64_t, ndim=2]
#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] xy1_mn
np.ndarray[np.float64_t, ndim=2] xy2_mn
np.ndarray[np.float64_t, ndim=1] x1_mn, y1_mn,  x2_mn, y2_mn
np.ndarray[np.float64_t, ndim=2] Mx9</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>Py_ssize_t num_pts
Py_ssize_t ix</dd>
</dl>
<p class="last">#endif</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.compute_affine">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">compute_affine</code><span class="sig-paren">(</span><em>xy1_man</em>, <em>xy2_man</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.compute_affine" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ndarray[shape=</strong> &#8211; A - affine matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">3,3</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-compute_affine:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy1_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_prime</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">A_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">/=</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendA</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  1.19e+00  -1.06e-02  -4.49e+01]</span>
<span class="go"> [ -2.22e-01   1.12e+00  -2.78e+01]</span>
<span class="go"> [  0.00e+00   0.00e+00   1.00e+00]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.compute_homog">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">compute_homog</code><span class="sig-paren">(</span><em>xy1_mn</em>, <em>xy2_mn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_homog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.compute_homog" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 6 degrees of freedom homography transformation
Computes homography from normalized (0 to 1) point correspondences
from 2 &#8211;&gt; 1
(database-&gt;query)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ndarray[shape=</strong> &#8211; H - homography matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">3,3</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-compute_homog:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = ut.hashstr(H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  1.83e-03   2.85e-03  -7.11e-01]</span>
<span class="go"> [  2.82e-03   1.80e-03  -7.03e-01]</span>
<span class="go"> [  1.67e-05   1.68e-05  -5.53e-03]]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers_normalized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H_prime</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_man</span><span class="p">,</span> <span class="n">xy2_man</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">H_prime</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">/=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2_blendH</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">get_blended_chip</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rchip2_blendH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">[[  9.22e-01  -2.50e-01   2.75e+01]</span>
<span class="go"> [ -2.04e-01   8.79e-01  -7.94e+00]</span>
<span class="go"> [ -1.82e-04  -5.99e-04   1.00e+00]]</span>
</pre></div>
</div>
</dd>
<dt>Cyth:</dt>
<dd><p class="first">#CYTH_RETURNS np.ndarray[np.float64_t, ndim=2]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] xy1_mn
np.ndarray[np.float64_t, ndim=2] xy2_mn</div></blockquote>
<p>#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] Mx9</div></blockquote>
<p class="last">#endif</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.estimate_refined_transform">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">estimate_refined_transform</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#estimate_refined_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.estimate_refined_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>estimates final transformation using normalized affine inliers</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates inliers deterministically using elliptical shapes</p>
<p>Compute all transforms from kpts1 to kpts2 (enumerate all hypothesis)
We transform from chip1 -&gt; chip2
The determinants are squared keypoint scales</p>
<dl class="docutils">
<dt>FROM PERDOCH 2009::</dt>
<dd>H = inv(Aj).dot(Rj.T).dot(Ri).dot(Ai)
H = inv(Aj).dot(Ai)
The input invVs = perdoch.invA&#8217;s</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-get_affine_inliers
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="o">.</span><span class="mo">00</span><span class="mi">9</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_affine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh_sqrd</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">89kz8nh6p+66t!+u</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] kpts1
np.ndarray[np.float64_t, ndim=2] kpts2
np.ndarray[np.int32_t, ndim=2] fm
np.float64_t xy_thresh_sqrd
np.float64_t scale_thresh_sqrd
np.float64_t ori_thresh</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=2] kpts1_m
np.ndarray[np.float64_t, ndim=2] kpts2_m
np.ndarray[np.float64_t, ndim=3] invVR1s_m
np.ndarray[np.float64_t, ndim=3] V1s_m
np.ndarray[np.float64_t, ndim=3] invVR2s_m
np.ndarray[np.float64_t, ndim=3] Aff_mats
np.ndarray[np.float64_t, ndim=2] xy2_m
np.ndarray[np.float64_t, ndim=1] det2_m
np.ndarray[np.float64_t, ndim=1] ori2_m
np.ndarray[np.float64_t, ndim=2] Aff
tuple tup
list inliers_and_errors_list
list errors_list</dd>
</dl>
<p class="last">#endif</p>
</dd>
<dt>Ignore::</dt>
<dd><p class="first">from vtool.spatial_verification import *  # NOQA
import vtool.tests.dummy as dummy
import vtool.keypoint as ktool
kpts1, kpts2 = dummy.get_dummy_kpts_pair((100, 100))
a = kpts1[fm.T[0]]
b = kpts1.take(fm.T[0])</p>
<p>align = fm.dtype.itemsize * fm.shape[1]
align2 = [fm.dtype.itemsize, fm.dtype.itemsize]
viewtype1 = np.dtype(np.void, align)
viewtype2 = np.dtype(np.int32, align2)
c = np.ascontiguousarray(fm).view(viewtype1)
fm_view = np.ascontiguousarray(fm).view(viewtype1)
qfx = fm.view(np.dtype(np.int32 np.int32.itemsize))
dfx = fm.view(np.dtype(np.int32, np.int32.itemsize))
d = np.ascontiguousarray(c).view(viewtype2)</p>
<p class="last">fm.view(np.dtype(np.void, align))
np.ascontiguousarray(fm).view(np.dtype((np.void, Z.dtype.itemsize * Z.shape[1])))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_best_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_best_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em>, <em>forcepy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests each hypothesis and returns only the best transformation and inliers</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_best_affine_inliers_">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_best_affine_inliers_</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_normalized_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">get_normalized_affine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_normalized_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_normalized_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>returns xy-inliers that are normalized to have a mean of 0 and std of 1 as
well as the transformations so the inverse can be taken</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.refine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">refine_inliers</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.57</em>, <em>full_homog_checks=True</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#refine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.refine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of hypothesis inliers, computes a homography and refines inliers
returned homography maps image1 space into image2 space</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-refine_inliers
python -m vtool.spatial_verification --test-refine_inliers:0
python -m vtool.spatial_verification --test-refine_inliers:1 --show
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="o">.</span><span class="mo">01</span> <span class="o">*</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homogtup</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">homogtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">homogtup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">suppress_small</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;refined_inliers&#39;</span><span class="p">,</span> <span class="s">&#39;refined_errors&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">refined_inliers = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=np.int32)</span>
<span class="go">refined_errors = (</span>
<span class="go">                     np.array([   4.36,    5.28,    3.29,   13.05,  114.46,   48.97,   17.66,</span>
<span class="go">                                 25.83,    3.82], dtype=np.float32),</span>
<span class="go">                     np.array([ 0.1 ,  0.02,  0.44,  0.36,  0.18,  0.25,  0.04,  0.33,  0.47], dtype=np.float64),</span>
<span class="go">                     np.array([ 1.13,  1.11,  1.68,  1.89,  1.13,  1.42,  1.08,  1.01,  1.43], dtype=np.float64),</span>
<span class="go">                 )</span>
<span class="go">H = np.array([[ 0.92, -0.05,  7.21],</span>
<span class="go">              [-0.01,  0.91,  4.13],</span>
<span class="go">              [-0.  , -0.  ,  1.  ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">refine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.spatially_verify_kpts">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">spatially_verify_kpts</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh=0.01</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.5707963267948966</em>, <em>dlen_sqrd2=None</em>, <em>min_nInliers=4</em>, <em>match_weights=None</em>, <em>returnAff=False</em>, <em>full_homog_checks=True</em>, <em>refine_method='homog'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#spatially_verify_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.spatially_verify_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver function
Spatially validates feature matches</p>
<p>FIXME: there is a non-determenism here</p>
<p>Returned homography maps image1 space into image2 space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray[ndim=2]</em>) &#8211; all keypoints in image 1</li>
<li><strong>kpts2</strong> (<em>ndarray[ndim=2]</em>) &#8211; all keypoints in image 2</li>
<li><strong>fm</strong> (<em>ndarray[ndim=2]</em>) &#8211; matching keypoint indexes [..., (kp1x, kp2x), ...]</li>
<li><strong>xy_thresh</strong> (<em>float</em>) &#8211; spatial distance threshold under affine transform to
be considered a match</li>
<li><strong>scale_thresh</strong> (<em>float</em>) &#8211; </li>
<li><strong>ori_thresh</strong> (<em>float</em>) &#8211; </li>
<li><strong>dlen_sqrd2</strong> (<em>float</em>) &#8211; diagonal length squared of image/chip 2</li>
<li><strong>min_nInliers</strong> (<em>int</em>) &#8211; default=4</li>
<li><strong>returnAff</strong> (<em>bool</em>) &#8211; returns best affine hypothesis as well</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(refined_inliers, refined_errors, H, aff_inliers, aff_errors, Aff) if success else None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-spatially_verify_kpts --show
python -m vtool.spatial_verification --test-spatially_verify_kpts --show --refine-method<span class="o">=</span><span class="s1">&#39;affine&#39;</span>
python -m vtool.spatial_verification --test-spatially_verify_kpts --dpath figures --show --save ~/latex/crall-candidacy-2015/figures/sver_kpts.jpg  <span class="c"># NOQA</span>
python -m vtool.spatial_verification --test-spatially_verify_kpts
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--fname1&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--fname2&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;easy2.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span><span class="p">[</span><span class="s">&#39;ratio_thresh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">testdata_ratio_matches</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mo">01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd2</span> <span class="o">=</span> <span class="mf">447271.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_nInliers</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returnAff</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine_method</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--refine-method&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;homog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">spatially_verify_kpts</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">dlen_sqrd2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">min_nInliers</span><span class="p">,</span> <span class="n">match_weights</span><span class="p">,</span> <span class="n">returnAff</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;sver failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(&#39;aff_errors = %r&#39; % (aff_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;aff_inliers = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;refined_inliers = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(&#39;refined_errors = %r&#39; % (refined_errors,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = ut.list_str(svtup, precision=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">,</span> <span class="n">refine_method</span><span class="o">=</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">tuple(numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray, numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.test_affine_errors">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">test_affine_errors</code><span class="sig-paren">(</span><em>H</em>, <em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_affine_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.test_affine_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>used for refinement as opposed to initial estimation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.test_homog_errors">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">test_homog_errors</code><span class="sig-paren">(</span><em>H</em>, <em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em>, <em>full_homog_checks=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#test_homog_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.test_homog_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Test to see which keypoints the homography correctly maps</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix</li>
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>fm</strong> (<em>list</em>) &#8211; list of feature matches as tuples (qfx, dfx)</li>
<li><strong>xy_thresh_sqrd</strong> (<em>float</em>) &#8211; </li>
<li><strong>scale_thresh</strong> (<em>float</em>) &#8211; </li>
<li><strong>ori_thresh</strong> (<em>float</em>) &#8211; angle in radians</li>
<li><strong>full_homog_checks</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">homog_tup1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.spatial_verification --test-test_homog_errors:0 --show
python -m vtool.spatial_verification --test-test_homog_errors:0 --show --rotation_invariance
python -m vtool.spatial_verification --test-test_homog_errors:0 --show --rotation_invariance --no-affine-invariance --xy-thresh<span class="o">=</span>.001
python -m vtool.spatial_verification --test-test_homog_errors:0 --show --rotation_invariance --no-affine-invariance --xy-thresh<span class="o">=</span>.001 --no-full-homog-checks
python -m vtool.spatial_verification --test-test_homog_errors:0 --show --no-full-homog-checks
<span class="c"># --------------</span>
<span class="c"># Shows (sorta) how inliers are computed</span>
python -m vtool.spatial_verification --test-test_homog_errors:1 --show
python -m vtool.spatial_verification --test-test_homog_errors:1 --show --rotation_invariance
python -m vtool.spatial_verification --test-test_homog_errors:1 --show --rotation_invariance --no-affine-invariance --xy-thresh<span class="o">=</span>.001
python -m vtool.spatial_verification --test-test_homog_errors:1 --show --rotation_invariance --xy-thresh<span class="o">=</span>.001
python -m vtool.spatial_verification --test-test_homog_errors:0 --show --rotation_invariance --xy-thresh<span class="o">=</span>.001
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup1</span> <span class="o">=</span> <span class="n">test_homog_errors</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">full_homog_checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_tup1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">homog_tup1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">testdata_matching_affine_inliers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">estimate_refined_transform</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm_</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_homog_checks</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--no-full-homog-checks&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ----------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Take subset of feature matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_sourcecode</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s">&#39;scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># we only care about checking out scale and orientation here. ignore bad xy points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_inliers_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">xy_err</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_err</span><span class="p">[</span><span class="o">~</span><span class="n">xy_inliers_flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scale_err</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Exec sourcecode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1_m</span><span class="p">,</span> <span class="n">kpts2_m</span><span class="p">,</span> <span class="n">off_xy1_m</span><span class="p">,</span> <span class="n">off_xy1_mt</span><span class="p">,</span> <span class="n">dxy1_m</span><span class="p">,</span> <span class="n">dxy1_mt</span><span class="p">,</span> <span class="n">xy2_m</span><span class="p">,</span> <span class="n">xy1_m</span><span class="p">,</span> <span class="n">xy1_mt</span><span class="p">,</span> <span class="n">scale_err</span><span class="p">,</span> <span class="n">xy_err</span><span class="p">,</span> <span class="n">ori_err</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_sourcecode</span><span class="p">(</span><span class="n">test_homog_errors</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="s">&#39;kpts1_m, kpts2_m, off_xy1_m, off_xy1_mt, dxy1_m, dxy1_mt, xy2_m, xy1_m, xy1_mt, scale_err, xy_err, ori_err&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;, &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;orig points and offset point&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;transformed points and matching points&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># first have to make corresponding offset points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Use reference point for scale and orientation tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oris2_m</span>   <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_oris</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales2_m</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_scales</span><span class="p">(</span><span class="n">kpts2_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxy2_m</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">oris2_m</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_dxy2_m</span> <span class="o">=</span> <span class="n">dxy2_m</span> <span class="o">*</span> <span class="n">scales2_m</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">off_xy2_m</span> <span class="o">=</span> <span class="n">xy2_m</span> <span class="o">+</span> <span class="n">scaled_dxy2_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Draw transformed semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Draw corresponding matches semgents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">off_xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Draw matches between correspondences</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments_list4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy1_mt</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">xy2_m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_line_segments</span><span class="p">(</span><span class="n">segments_list4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#vt.get_xy_axis_extents(kpts1_m)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_sv.show_sv(rchip1, rchip2, kpts1, kpts2, fm, homog_tup=homog_tup)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.testdata_matching_affine_inliers">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">testdata_matching_affine_inliers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.testdata_matching_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.testdata_matching_affine_inliers_normalized">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">testdata_matching_affine_inliers_normalized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#testdata_matching_affine_inliers_normalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.testdata_matching_affine_inliers_normalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.try_svd">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">try_svd</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#try_svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.try_svd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.unnormalize_transform">
<code class="descclassname">vtool.spatial_verification.</code><code class="descname">unnormalize_transform</code><span class="sig-paren">(</span><em>M_prime</em>, <em>T1</em>, <em>T2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/spatial_verification.html#unnormalize_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.unnormalize_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.sver_c_wrapper">
<span id="vtool-sver-c-wrapper-module"></span><h2>vtool.sver_c_wrapper module<a class="headerlink" href="#module-vtool.sver_c_wrapper" title="Permalink to this headline">¶</a></h2>
<p>wraps c implementations slower parts of spatial verification</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.sver_c_wrapper --rebuild-sver
python -m vtool.sver_c_wrapper --rebuild-sver --allexamples
python -m vtool.sver_c_wrapper --allexamples

python -m vtool.sver_c_wrapper --test-test_sver_wrapper --rebuild-sver
</pre></div>
</div>
<dl class="function">
<dt id="vtool.sver_c_wrapper.assert_output_equal">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">assert_output_equal</code><span class="sig-paren">(</span><em>output1</em>, <em>output2</em>, <em>thresh=1e-08</em>, <em>nestpath=None</em>, <em>level=0</em>, <em>lbl1=''</em>, <em>lbl2=''</em>, <em>output_lbl=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#assert_output_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.assert_output_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>recursive equality checks</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.sver_c_wrapper.c_double_p">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">c_double_p</code><a class="headerlink" href="#vtool.sver_c_wrapper.c_double_p" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">LP_c_double</span></code></p>
</dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.call_hello">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">call_hello</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#call_hello"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.call_hello" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.compare_implementations">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">compare_implementations</code><span class="sig-paren">(</span><em>func1</em>, <em>func2</em>, <em>args</em>, <em>show_output=False</em>, <em>lbl1=''</em>, <em>lbl2=''</em>, <em>output_lbl=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#compare_implementations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.compare_implementations" title="Permalink to this definition">¶</a></dt>
<dd><p>tests two different implementations of the same function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.errs_t">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">errs_t</code><span class="sig-paren">(</span><em>ndim</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.sver_c_wrapper.errs_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.get_affine_inliers_cpp">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">get_affine_inliers_cpp</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#get_affine_inliers_cpp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.get_affine_inliers_cpp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.get_best_affine_inliers_cpp">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">get_best_affine_inliers_cpp</code><span class="sig-paren">(</span><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>fs</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#get_best_affine_inliers_cpp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.get_best_affine_inliers_cpp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.inliers_t">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">inliers_t</code><span class="sig-paren">(</span><em>ndim</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.sver_c_wrapper.inliers_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.mats_t">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">mats_t</code><span class="sig-paren">(</span><em>ndim</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.sver_c_wrapper.mats_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.test_sver_wrapper">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">test_sver_wrapper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#test_sver_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.test_sver_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Test to ensure cpp and python agree and that cpp is faster</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.sver_c_wrapper --test-test_sver_wrapper
python -m vtool.sver_c_wrapper --test-test_sver_wrapper --rebuild-sver
python -m vtool.sver_c_wrapper --test-test_sver_wrapper --show
python -m vtool.sver_c_wrapper --test-test_sver_wrapper --show --dummy
python -m vtool.sver_c_wrapper --test-test_sver_wrapper --show --fname1<span class="o">=</span>easy1.png --fname2<span class="o">=</span>easy2.png
python -m vtool.sver_c_wrapper --test-test_sver_wrapper --show --fname1<span class="o">=</span>easy1.png --fname2<span class="o">=</span>hard3.png
python -m vtool.sver_c_wrapper --test-test_sver_wrapper --show --fname1<span class="o">=</span>carl.jpg --fname2<span class="o">=</span>hard3.png
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.sver_c_wrapper</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_sver_wrapper</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.test_sver_wrapper2">
<code class="descclassname">vtool.sver_c_wrapper.</code><code class="descname">test_sver_wrapper2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#test_sver_wrapper2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.test_sver_wrapper2" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.sver_c_wrapper --test-test_sver_wrapper2
python -m vtool.sver_c_wrapper --test-test_sver_wrapper2 --no-c --quiet
python -m vtool.sver_c_wrapper --test-test_sver_wrapper2 --rebuild-sver
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.sver_c_wrapper</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_sver_wrapper2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.symbolic">
<span id="vtool-symbolic-module"></span><h2>vtool.symbolic module<a class="headerlink" href="#module-vtool.symbolic" title="Permalink to this headline">¶</a></h2>
<p>Sympy helpers</p>
<dl class="function">
<dt id="vtool.symbolic.check_expr_eq">
<code class="descclassname">vtool.symbolic.</code><code class="descname">check_expr_eq</code><span class="sig-paren">(</span><em>expr1</em>, <em>expr2</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#check_expr_eq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.check_expr_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Does not work in general. Problem is not decidable
Thanks Richard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expr1</strong> &#8211; </li>
<li><strong>expr2</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.symbolic --test-check_expr_eq
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.symbolic</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="n">sx</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">tx</span> <span class="o">+</span> <span class="n">w1</span><span class="o">*</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">sy</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">ty</span> <span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">check_expr_eq</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.symbolic.custom_sympy_attrs">
<code class="descclassname">vtool.symbolic.</code><code class="descname">custom_sympy_attrs</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#custom_sympy_attrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.custom_sympy_attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.evalprint">
<code class="descclassname">vtool.symbolic.</code><code class="descname">evalprint</code><span class="sig-paren">(</span><em>str_</em>, <em>globals_=None</em>, <em>locals_=None</em>, <em>simplify=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#evalprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.evalprint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.symbolic_randcheck">
<code class="descclassname">vtool.symbolic.</code><code class="descname">symbolic_randcheck</code><span class="sig-paren">(</span><em>expr1</em>, <em>expr2</em>, <em>domain={}</em>, <em>n=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#symbolic_randcheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.symbolic_randcheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.sympy_latex_repr">
<code class="descclassname">vtool.symbolic.</code><code class="descname">sympy_latex_repr</code><span class="sig-paren">(</span><em>expr1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_latex_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.sympy_latex_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.symbolic.sympy_mat">
<code class="descclassname">vtool.symbolic.</code><code class="descname">sympy_mat</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/symbolic.html#sympy_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.symbolic.sympy_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.test_constrained_matching">
<span id="vtool-test-constrained-matching-module"></span><h2>vtool.test_constrained_matching module<a class="headerlink" href="#module-vtool.test_constrained_matching" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.test_constrained_matching.SimpleMatcher">
<em class="property">class </em><code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">SimpleMatcher</code><span class="sig-paren">(</span><em>simp</em>, <em>testtup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.load_data">
<code class="descname">load_data</code><span class="sig-paren">(</span><em>simp</em>, <em>testtup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.load_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.run_matching">
<code class="descname">run_matching</code><span class="sig-paren">(</span><em>simp</em>, <em>testtup=None</em>, <em>cfgdict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.run_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.run_matching" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.setstate_testdata">
<code class="descname">setstate_testdata</code><span class="sig-paren">(</span><em>simp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.setstate_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.setstate_testdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.start_new_viz">
<code class="descname">start_new_viz</code><span class="sig-paren">(</span><em>simp</em>, <em>nRows</em>, <em>nCols</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.start_new_viz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.start_new_viz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>simp</em>, <em>key</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize_coverage">
<code class="descname">visualize_coverage</code><span class="sig-paren">(</span><em>simp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize_coverage" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.test_constrained_matching --test-visualize_coverage --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span> <span class="o">=</span> <span class="n">SimpleMatcher</span><span class="p">(</span><span class="n">testdata_matcher</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span><span class="o">.</span><span class="n">run_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simp</span><span class="o">.</span><span class="n">visualize_coverage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize_matches">
<code class="descname">visualize_matches</code><span class="sig-paren">(</span><em>simp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize_matches" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.test_constrained_matching --test-visualize_matches --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span> <span class="o">=</span> <span class="n">SimpleMatcher</span><span class="p">(</span><span class="n">testdata_matcher</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span><span class="o">.</span><span class="n">run_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simp</span><span class="o">.</span><span class="n">visualize_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize_normalizers">
<code class="descname">visualize_normalizers</code><span class="sig-paren">(</span><em>simp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.test_constrained_matching --test-visualize_normalizers --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span> <span class="o">=</span> <span class="n">SimpleMatcher</span><span class="p">(</span><span class="n">testdata_matcher</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span><span class="o">.</span><span class="n">run_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simp</span><span class="o">.</span><span class="n">visualize_normalizers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.make_custom_interactions">
<code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">make_custom_interactions</code><span class="sig-paren">(</span><em>simp_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#make_custom_interactions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.make_custom_interactions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.on_single_match_clicked">
<code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">on_single_match_clicked</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#on_single_match_clicked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.on_single_match_clicked" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.param_interaction">
<code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">param_interaction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#param_interaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.param_interaction" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.test_constrained_matching --test-param_interaction
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>python -m vtool.test_constrained_matching &#8211;test-param_interaction
setparam normalizer_mode=nearby
setparam normalizer_mode=far
setparam ratio_thresh=.625
setparam ratio_thresh=.5</p>
<p>setparam ratio_thresh2=.625
normalizer_mode=plus</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">param_interaction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">testtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.show_example">
<code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">show_example</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#show_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.show_example" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.test_constrained_matching --test-show_example --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.show_matches">
<code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">show_matches</code><span class="sig-paren">(</span><em>fm</em>, <em>fs</em>, <em>fnum=1</em>, <em>pnum=None</em>, <em>title=''</em>, <em>key=None</em>, <em>simp=None</em>, <em>cmap='hot'</em>, <em>draw_lines=True</em>, <em>**locals_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#show_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.show_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.testdata_matcher">
<code class="descclassname">vtool.test_constrained_matching.</code><code class="descname">testdata_matcher</code><span class="sig-paren">(</span><em>fname1='easy1.png'</em>, <em>fname2='easy2.png'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#testdata_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.testdata_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8221;
fname1 = &#8216;easy1.png&#8217;
fname2 = &#8216;hard3.png&#8217;</p>
<p>python -m vtool.test_constrained_matching &#8211;test-visualize_matches &#8211;show</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname1</strong> (<em>str</em>) &#8211; (default = &#8216;easy1.png&#8217;)</li>
<li><strong>fname2</strong> (<em>str</em>) &#8211; (default = &#8216;easy2.png&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">testtup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><p>?</p>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m vtool.test_constrained_matching --test-testdata_matcher
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span> <span class="o">=</span> <span class="s">&#39;easy1.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname2</span> <span class="o">=</span> <span class="s">&#39;easy2.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">testdata_matcher</span><span class="p">(</span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;testtup = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">testtup</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.trig">
<span id="vtool-trig-module"></span><h2>vtool.trig module<a class="headerlink" href="#module-vtool.trig" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.trig.atan2">
<code class="descclassname">vtool.trig.</code><code class="descname">atan2</code><span class="sig-paren">(</span><em>y</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool/trig.html#atan2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.trig.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>does atan2 but returns from 0 to TAU
&gt;&gt;&gt; from vtool.trig import *  # NOQA
&gt;&gt;&gt; import utool
&gt;&gt;&gt; np.random.seed(0)
&gt;&gt;&gt; y = np.random.rand(1000).astype(np.float64)
&gt;&gt;&gt; x = np.random.rand(1000).astype(np.float64)
&gt;&gt;&gt; theta = atan2(y, x)
&gt;&gt;&gt; assert np.all(theta &gt;= 0)
&gt;&gt;&gt; assert np.all(theta &lt; 2 * np.pi)
&gt;&gt;&gt; print(utool.hashstr(theta))
go!su97%eo4qoyq7</p>
<p>#CYTH_INLINE
#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=1] y
np.ndarray[np.float64_t, ndim=1] x
np.ndarray[np.float64_t, ndim=1] theta</div></blockquote>
<p>#endif</p>
</dd></dl>

</div>
<div class="section" id="module-vtool">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtool" title="Permalink to this headline">¶</a></h2>
<p>VTool - Computer vision tools</p>
<dl class="function">
<dt id="vtool.reassign_submodule_attributes">
<code class="descclassname">vtool.</code><code class="descname">reassign_submodule_attributes</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool.html#reassign_submodule_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.reassign_submodule_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>why reloading all the modules doesnt do this I don&#8217;t know</p>
</dd></dl>

<dl class="function">
<dt id="vtool.reload_subs">
<code class="descclassname">vtool.</code><code class="descname">reload_subs</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtool.html#reload_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.reload_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads vtool and submodules</p>
</dd></dl>

<dl class="function">
<dt id="vtool.rrrr">
<code class="descclassname">vtool.</code><code class="descname">rrrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#vtool.rrrr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads vtool and submodules</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vtool.tests.html" class="btn btn-neutral float-right" title="vtool.tests package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to vtool’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jon Crall.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.1.dev1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>