

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>vtool package &mdash; vtool 1.0.0.dev1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="vtool 1.0.0.dev1 documentation" href="index.html"/>
        <link rel="next" title="vtool.tests package" href="vtool.tests.html"/>
        <link rel="prev" title="Welcome to vtool’s documentation!" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> vtool</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">vtool package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.chip">vtool.chip module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.clustering">vtool.clustering module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.clustering2">vtool.clustering2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.constrained_matching">vtool.constrained_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_grid">vtool.coverage_grid module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.coverage_kpts">vtool.coverage_kpts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.distance">vtool.distance module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.ellipse">vtool.ellipse module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.exif">vtool.exif module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.features">vtool.features module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.geometry">vtool.geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.histogram">vtool.histogram module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image">vtool.image module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.image_filters">vtool.image_filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.keypoint">vtool.keypoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.linalg">vtool.linalg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.matching">vtool.matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.math">vtool.math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.nearest_neighbors">vtool.nearest_neighbors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.other">vtool.other module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.patch">vtool.patch module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.quality_classifier">vtool.quality_classifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.segmentation">vtool.segmentation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.spatial_verification">vtool.spatial_verification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.sver_c_wrapper">vtool.sver_c_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.test_constrained_matching">vtool.test_constrained_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool.trig">vtool.trig module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vtool">Module contents</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">vtool</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>vtool package</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/vtool.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="vtool-package">
<h1>vtool package<a class="headerlink" href="#vtool-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="vtool.tests.html">vtool.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.dummy">vtool.tests.dummy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.grabdata">vtool.tests.grabdata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_akmeans">vtool.tests.test_akmeans module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_coverage_max_reduce">vtool.tests.test_coverage_max_reduce module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_draw_keypoint">vtool.tests.test_draw_keypoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_exhaustive_ori_extract">vtool.tests.test_exhaustive_ori_extract module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_pyflann">vtool.tests.test_pyflann module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_spatial_verification">vtool.tests.test_spatial_verification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.test_vtool">vtool.tests.test_vtool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests.time_cythonized_funcs">vtool.tests.time_cythonized_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="vtool.tests.html#module-vtool.tests">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-vtool.chip">
<span id="vtool-chip-module"></span><h2>vtool.chip module<a class="headerlink" href="#module-vtool.chip" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.chip.compute_chip">
<tt class="descclassname">vtool.chip.</tt><tt class="descname">compute_chip</tt><big>(</big><em>gfpath</em>, <em>bbox</em>, <em>theta</em>, <em>new_size</em>, <em>filter_list=[]</em><big>)</big><a class="reference internal" href="_modules/vtool/chip.html#compute_chip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.compute_chip" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a chip and applies filters</p>
<dl class="docutils">
<dt>gfpath, bbox, theta, new_size, filter_list = (&#8216;/media/raid/work/PZ_Master0/_ibsdb/chips/chip_aid=8490_bbox=(2267,1694,1070,630)_theta=0.0tau_gid=15897_CHIP(sz450).png&#8217;,</dt>
<dd>u&#8217;/media/raid/work/PZ_Master0/_ibsdb/images/99cf5f7f-8f74-6046-ac72-4df05ad7ee33.jpg&#8217;,
(2267, 1694, 1070, 630),
0.0,
(586, 345),
[])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_filter_list">
<tt class="descclassname">vtool.chip.</tt><tt class="descname">get_filter_list</tt><big>(</big><em>chipcfg_dict</em><big>)</big><a class="reference internal" href="_modules/vtool/chip.html#get_filter_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_filter_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.chip.get_scaled_size_with_area">
<tt class="descclassname">vtool.chip.</tt><tt class="descname">get_scaled_size_with_area</tt><big>(</big><em>target_area</em>, <em>w</em>, <em>h</em><big>)</big><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_size_with_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_scaled_size_with_area" title="Permalink to this definition">¶</a></dt>
<dd><p>returns new_size which scales (w, h) as close to target_area as possible
and maintains aspect ratio</p>
</dd></dl>

<dl class="function">
<dt id="vtool.chip.get_scaled_sizes_with_area">
<tt class="descclassname">vtool.chip.</tt><tt class="descname">get_scaled_sizes_with_area</tt><big>(</big><em>target_area</em>, <em>size_list</em><big>)</big><a class="reference internal" href="_modules/vtool/chip.html#get_scaled_sizes_with_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.chip.get_scaled_sizes_with_area" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.clustering">
<span id="vtool-clustering-module"></span><h2>vtool.clustering module<a class="headerlink" href="#module-vtool.clustering" title="Permalink to this headline">¶</a></h2>
<p>DEPRICATED USE clustering2.py</p>
<dl class="function">
<dt id="vtool.clustering.akmeans">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">akmeans</tt><big>(</big><em>data</em>, <em>num_clusters</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>ave_unchanged_thresh=0</em>, <em>ave_unchanged_iterwin=10</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximiate K-Means (using FLANN)
Input: data - np.array with rows of data.
Description: Quickly partitions data into K=num_clusters centroids.  Cluster
centers are randomly assigned to datapoints.  Each datapoint is assigned to
its approximate nearest cluster center.  The cluster centers are recomputed.
Repeat until approximate convergence.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.force_quit_akmeans">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">force_quit_akmeans</tt><big>(</big><em>signal</em>, <em>frame</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#force_quit_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.force_quit_akmeans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering.plot_clusters">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">plot_clusters</tt><big>(</big><em>data</em>, <em>datax2_clusterx</em>, <em>centroids</em>, <em>num_pca_dims=3</em>, <em>whiten=False</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#plot_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.plot_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.precompute_akmeans">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">precompute_akmeans</tt><big>(</big><em>data</em>, <em>num_clusters</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir=None</em>, <em>force_recomp=False</em>, <em>use_data_hash=True</em>, <em>cfgstr=''</em>, <em>refine=False</em>, <em>akmeans_cfgstr=None</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#precompute_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.precompute_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>precompute aproximate kmeans with builtin caching</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.refine_akmeans">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">refine_akmeans</tt><big>(</big><em>data</em>, <em>datax2_clusterx</em>, <em>centroids</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir=None</em>, <em>cfgstr=''</em>, <em>use_data_hash=True</em>, <em>akmeans_cfgstr=None</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#refine_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.refine_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Refines the approximates centroids</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.sparse_multiply_rows">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">sparse_multiply_rows</tt><big>(</big><em>csr_mat</em>, <em>vec</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#sparse_multiply_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.sparse_multiply_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Row-wise multiplication of a sparse matrix by a sparse vector</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering.sparse_normalize_rows">
<tt class="descclassname">vtool.clustering.</tt><tt class="descname">sparse_normalize_rows</tt><big>(</big><em>csr_mat</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering.html#sparse_normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering.sparse_normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.clustering2">
<span id="vtool-clustering2-module"></span><h2>vtool.clustering2 module<a class="headerlink" href="#module-vtool.clustering2" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.clustering2.akmeans">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">akmeans</tt><big>(</big><em>data</em>, <em>nCentroids</em>, <em>max_iters=5</em>, <em>initmethod='akmeans++'</em>, <em>flann_params={}</em>, <em>ave_unchanged_thresh=0</em>, <em>ave_unchanged_iterwin=10</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Approximiate K-Means (using FLANN)
Input: data - np.array with rows of data.
Description: Quickly partitions data into K=nCentroids centroids.  Cluster
centers are randomly assigned to datapoints.  Each datapoint is assigned to
its approximate nearest centroid center.  The centroid centers are recomputed.
Repeat until approximate convergence.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.akmeans_iterations">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">akmeans_iterations</tt><big>(</big><em>data</em>, <em>centroids</em>, <em>max_iters</em>, <em>flann_params</em>, <em>ave_unchanged_thresh</em>, <em>ave_unchanged_iterwin</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#akmeans_iterations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.akmeans_iterations" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function which continues the iterations of akmeans</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCentroids</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_iters</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ave_unchanged_thresh</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ave_unchanged_iterwin</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">initialize_centroids</span><span class="p">(</span><span class="n">nCentroids</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">akmeans_iterations</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">max_iters</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">ave_unchanged_thresh</span><span class="p">,</span> <span class="n">ave_unchanged_iterwin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.akmeans_plusplus_init">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">akmeans_plusplus_init</tt><big>(</big><em>data</em>, <em>K</em>, <em>samples_per_iter=None</em>, <em>flann_params=None</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#akmeans_plusplus_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.akmeans_plusplus_init" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Referencs:</dt>
<dd><a class="reference external" href="http://datasciencelab.wordpress.com/2014/01/15/improved-seeding-for-clustering-with-k-means/">http://datasciencelab.wordpress.com/2014/01/15/improved-seeding-for-clustering-with-k-means/</a></dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c"># 64000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nump</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dims</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_iters</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples_per_iter</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="n">nump</span><span class="p">,</span> <span class="n">dims</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_centers</span> <span class="o">=</span> <span class="n">akmeans_plusplus_init</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">samples_per_iter</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = str(initial_centers.sum())</span>
</pre></div>
</div>
<p>130240088</p>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples_per_iter</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">8000</span>  <span class="c"># 64000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_centers</span> <span class="o">=</span> <span class="n">akmeans_plusplus_init</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">samples_per_iter</span><span class="p">,</span>  <span class="n">flann_params</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>CommandLine:</dt>
<dd>utprof.sh ~/code/vtool/vtool/clustering2.py &#8211;test-akmeans_plusplus_init
python ~/code/vtool/vtool/clustering2.py &#8211;test-akmeans_plusplus_init</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">apply_grouping</tt><big>(</big><em>items</em>, <em>groupxs</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of ndarrays: grouped items</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>group_indices</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 &#8211;test-apply_grouping</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#np.random.seed(42)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#idx2_groupid = np.array(np.random.randint(0, 4, size=size))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#items = np.random.randint(5, 10, size=size)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="n">apply_grouping</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[array([8, 5, 6]), array([1, 5, 8, 7]), array([5, 3, 0, 9])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">apply_grouping_</tt><big>(</big><em>items</em>, <em>groupxs</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_" title="Permalink to this definition">¶</a></dt>
<dd><p>non-optimized version</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_iter">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">apply_grouping_iter</tt><big>(</big><em>items</em>, <em>groupxs</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_grouping_iter2">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">apply_grouping_iter2</tt><big>(</big><em>items</em>, <em>groupxs</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#apply_grouping_iter2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_grouping_iter2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.apply_jagged_grouping">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">apply_jagged_grouping</tt><big>(</big><em>unflat_items</em>, <em>groupxs</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#apply_jagged_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.apply_jagged_grouping" title="Permalink to this definition">¶</a></dt>
<dd><p>takes unflat_list and flat group indices. Returns the unflat grouping</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.approximate_assignments">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">approximate_assignments</tt><big>(</big><em>seachedvecs</em>, <em>queryvecs</em>, <em>K</em>, <em>flann_params</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#approximate_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.approximate_assignments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.approximate_distances">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">approximate_distances</tt><big>(</big><em>centroids</em>, <em>data</em>, <em>K</em>, <em>flann_params</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#approximate_distances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.approximate_distances" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.assert_centroids">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">assert_centroids</tt><big>(</big><em>centroids</em>, <em>data</em>, <em>nCentroids</em>, <em>clip_centroids</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#assert_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.assert_centroids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.cached_akmeans">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">cached_akmeans</tt><big>(</big><em>data</em>, <em>nCentroids</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir='default'</em>, <em>force_recomp=False</em>, <em>use_data_hash=True</em>, <em>cfgstr=''</em>, <em>refine=False</em>, <em>akmeans_cfgstr=None</em>, <em>use_cache=True</em>, <em>appname='vtool'</em>, <em>initmethod='akmeans++'</em>, <em>clip_centroids=True</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#cached_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.cached_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>precompute aproximate kmeans with builtin caching</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nump</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dims</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCentroids</span> <span class="o">=</span> <span class="mi">800</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_iters</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="n">nump</span><span class="p">,</span> <span class="n">dims</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd>import vtool.clustering2 as clustertool
max_iters = 300
flann = p yflann.FLANN()
centroids1 = flann.kmeans(data, nCentroids, max_iterations=max_iters, dtype=np.uint8)
centroids2 = clustertool.akmeans(data, nCentroids, max_iters, {})
%timeit clustertool.akmeans(data, nCentroids, max_iters, {})
%timeit flann.kmeans(data, nCentroids, max_iterations=max_iters)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.compute_centroids">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">compute_centroids</tt><big>(</big><em>data</em>, <em>centroids</em>, <em>datax2_centroidx</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#compute_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.compute_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes centroids given datax assignments
TODO: maybe use the grouping code instad of the LR algorithm</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCentroids</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">initialize_centroids</span><span class="p">(</span><span class="n">nCentroids</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids_</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">datax2_centroidx</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span> <span class="n">yflann</span><span class="o">.</span><span class="n">FLANN</span><span class="p">()</span><span class="o">.</span><span class="n">nn</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">flann_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">compute_centroids</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">datax2_centroidx</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.double_group">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">double_group</tt><big>(</big><em>inner_key_list</em>, <em>outer_keys_list</em>, <em>items_list</em>, <em>ensure_numpy=False</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#double_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.double_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes corresponding lists as input and builds a double mapping.</p>
<p>DEPRICATE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inner_key_list</strong> (<em>list</em>) &#8211; each value_i is a scalar key.</li>
<li><strong>outer_keys_list</strong> (<em>list</em>) &#8211; each value_i list of scalar keys</li>
<li><strong>items_list</strong> (<em>list</em>) &#8211; value_i is a list that corresponds to outer_keys_i</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">utool.ddict of dicts: outerkey2_innerkey2_items</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inner_key_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outer_keys_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_numpy</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outerkey2_innerkey2_items</span> <span class="o">=</span> <span class="n">double_group</span><span class="p">(</span><span class="n">inner_key_list</span><span class="p">,</span> <span class="n">outer_keys_list</span><span class="p">,</span> <span class="n">items_list</span><span class="p">,</span> <span class="n">ensure_numpy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outerkey2_innerkey2_items</span><span class="p">))</span>
<span class="go">{</span>
<span class="go">    10: {300: array([6]), 100: array([1])},</span>
<span class="go">    20: {400: array([7]), 100: array([2, 3])},</span>
<span class="go">    30: {200: array([4]), 300: array([5])},</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">len_</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incrementer</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">make_incrementer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nOuterList</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Define big double_group input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inner_key_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">len_</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outer_keys_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nOuter_</span><span class="p">)</span> <span class="k">for</span> <span class="n">nOuter_</span> <span class="ow">in</span> <span class="n">nOuterList</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">incrementer</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nOuter_</span><span class="p">)])</span> <span class="k">for</span> <span class="n">nOuter_</span> <span class="ow">in</span> <span class="n">nOuterList</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_numpy</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outerkey2_innerkey2_items</span> <span class="o">=</span> <span class="n">double_group</span><span class="p">(</span><span class="n">inner_key_list</span><span class="p">,</span> <span class="n">outer_keys_list</span><span class="p">,</span> <span class="n">items_list</span><span class="p">,</span> <span class="n">ensure_numpy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outerkey2_innerkey2_items</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outerkey2_innerkey2_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit:</dt>
<dd>%timeit double_group(inner_key_list, outer_keys_list, items_list, ensure_numpy)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.find_duplicate_items">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">find_duplicate_items</tt><big>(</big><em>item_arr</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#find_duplicate_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.find_duplicate_items" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">?: duplicate_items</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 &#8211;test-find_duplicate_items</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicate_items</span> <span class="o">=</span> <span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">duplicate_items</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">item_arr</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">duplicate_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[9, 67, 87, 88]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.get_akmeans_cfgstr">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">get_akmeans_cfgstr</tt><big>(</big><em>data</em>, <em>nCentroids</em>, <em>max_iters=5</em>, <em>initmethod='akmeans++'</em>, <em>flann_params={}</em>, <em>use_data_hash=True</em>, <em>cfgstr=''</em>, <em>akmeans_cfgstr=None</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#get_akmeans_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.get_akmeans_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.group_indices">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">group_indices</tt><big>(</big><em>idx2_groupid</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#group_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.group_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>idx2_groupid</strong> (<em>ndarray</em>) &#8211; numpy array of group ids (must be numeric)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>tuple</strong> &#8211;
(keys, groupxs)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray, list of ndarrays</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 &#8211;test-group_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#np.random.seed(42)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#size = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#idx2_groupid = np.array(np.random.randint(0, 4, size=size))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([1, 2, 3]), [array([1, 3, 5]), array([0, 2, 4, 6]), array([ 7,  8,  9, 10])])</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">24</span><span class="p">],</span> <span class="p">[</span> <span class="mi">129</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">24</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">822</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span> <span class="mi">659</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># 2d arrays must be flattened before coming into this function so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># information is on the last axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">(</span><span class="n">idx2_groupid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">keys</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 24, 129, 659, 822]), [array([ 0,  4, 10]), array([1]), array([2, 3, 5, 6, 8, 9]), array([7])])</span>
</pre></div>
</div>
</dd>
<dt>SeeAlso:</dt>
<dd>apply_grouping</dd>
<dt>TODO:</dt>
<dd>Look into np.split
<a class="reference external" href="http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array">http://stackoverflow.com/questions/21888406/getting-the-indexes-to-the-duplicate-columns-of-a-numpy-array</a></dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4651683/numpy-grouping-using-itertools-groupby-performance">http://stackoverflow.com/questions/4651683/numpy-grouping-using-itertools-groupby-performance</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">groupby</tt><big>(</big><em>items</em>, <em>idx2_groupid</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#groupby"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">idx2_groupid</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby_dict">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">groupby_dict</tt><big>(</big><em>items</em>, <em>idx2_groupid</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupby_gen">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">groupby_gen</tt><big>(</big><em>items</em>, <em>idx2_groupid</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#groupby_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupby_gen" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">items</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_groupid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.groupedzip">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">groupedzip</tt><big>(</big><em>id_list</em>, <em>datas_list</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#groupedzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.groupedzip" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for grouping multiple lists of data (stored in <tt class="docutils literal"><span class="pre">datas_list</span></tt>)
using <tt class="docutils literal"><span class="pre">id_list</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">_iter</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">iterator</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 &#8211;test-groupedzip</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datas_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="s">&#39;F&#39;</span><span class="p">,</span> <span class="s">&#39;G&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span><span class="p">,</span> <span class="n">grouped_iter</span> <span class="o">=</span> <span class="n">groupedzip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,</span> <span class="n">datas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grouped_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">groupxs</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">grouped_tuples</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">([&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], [&#39;A&#39;, &#39;C&#39;, &#39;E&#39;])</span>
<span class="go">([&#39;b&#39;, &#39;d&#39;, &#39;f&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;F&#39;])</span>
<span class="go">([&#39;g&#39;], [&#39;G&#39;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.initialize_centroids">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">initialize_centroids</tt><big>(</big><em>nCentroids</em>, <em>data</em>, <em>initmethod='akmeans++'</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#initialize_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.initialize_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes centroids to random datapoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.invert_apply_grouping">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">invert_apply_grouping</tt><big>(</big><em>grouped_items</em>, <em>groupxs</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#invert_apply_grouping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.invert_apply_grouping" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grouped_items</strong> (<em>list</em>) &#8211; of lists</li>
<li><strong>groupxs</strong> (<em>list</em>) &#8211; of lists</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.clustering2 &#8211;test-invert_apply_grouping</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1, 8, 5, 5, 8, 6, 7, 5, 3, 0, 9]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.clustering2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">invert_apply_grouping</span><span class="p">(</span><span class="n">grouped_items</span><span class="p">,</span> <span class="n">groupxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.jagged_group">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">jagged_group</tt><big>(</big><em>groupids_list</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#jagged_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.jagged_group" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens and returns group indexes into the flattened list</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.plot_centroids">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">plot_centroids</tt><big>(</big><em>data</em>, <em>centroids</em>, <em>num_pca_dims=3</em>, <em>whiten=False</em>, <em>labels='centroids'</em>, <em>fnum=1</em>, <em>prefix=''</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#plot_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.plot_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots centroids and datapoints. Plots accurately up to 3 dimensions.
If there are more than 3 dimensions, PCA is used to recude the dimenionality
to the &lt;num_pca_dims&gt; principal components</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.refine_akmeans">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">refine_akmeans</tt><big>(</big><em>data</em>, <em>centroids</em>, <em>max_iters=5</em>, <em>flann_params={}</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>use_data_hash=True</em>, <em>akmeans_cfgstr=None</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#refine_akmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.refine_akmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Refines the approximates centroids</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.sparse_multiply_rows">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">sparse_multiply_rows</tt><big>(</big><em>csr_mat</em>, <em>vec</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#sparse_multiply_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.sparse_multiply_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Row-wise multiplication of a sparse matrix by a sparse vector</p>
</dd></dl>

<dl class="function">
<dt id="vtool.clustering2.sparse_normalize_rows">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">sparse_normalize_rows</tt><big>(</big><em>csr_mat</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#sparse_normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.sparse_normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.clustering2.tune_flann2">
<tt class="descclassname">vtool.clustering2.</tt><tt class="descname">tune_flann2</tt><big>(</big><em>data</em><big>)</big><a class="reference internal" href="_modules/vtool/clustering2.html#tune_flann2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.clustering2.tune_flann2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.constrained_matching">
<span id="vtool-constrained-matching-module"></span><h2>vtool.constrained_matching module<a class="headerlink" href="#module-vtool.constrained_matching" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.constrained_matching.Annot">
<em class="property">class </em><tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">Annot</tt><big>(</big><em>annot</em>, <em>fpath</em>, <em>species='zebra_plains'</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>fpath1 = ut.grab_test_imgpath(fname1)
fpath2 = ut.grab_test_imgpath(fname2)
annot1 = Annot(fpath1)
annot2 = Annot(fpath2)
annot = annot1</p>
<dl class="method">
<dt id="vtool.constrained_matching.Annot.baseline_match">
<tt class="descname">baseline_match</tt><big>(</big><em>annot</em>, <em>annot2</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.baseline_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.baseline_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.compute_dstncvs_mask">
<tt class="descname">compute_dstncvs_mask</tt><big>(</big><em>annot</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.compute_dstncvs_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.compute_dstncvs_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.compute_fgweight_mask">
<tt class="descname">compute_fgweight_mask</tt><big>(</big><em>annot</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.compute_fgweight_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.compute_fgweight_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.constrained_match">
<tt class="descname">constrained_match</tt><big>(</big><em>annot</em>, <em>match_SV</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.constrained_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.constrained_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.lazy_compute">
<tt class="descname">lazy_compute</tt><big>(</big><em>annot</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.lazy_compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.lazy_compute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.load">
<tt class="descname">load</tt><big>(</big><em>annot</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#vtool.constrained_matching.Annot.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.show">
<tt class="descname">show</tt><big>(</big><em>annot</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.show_dstncvs_mask">
<tt class="descname">show_dstncvs_mask</tt><big>(</big><em>annot</em>, <em>title='wd'</em>, <em>update=True</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.show_dstncvs_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.show_dstncvs_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.Annot.show_fgweight_mask">
<tt class="descname">show_fgweight_mask</tt><big>(</big><em>annot</em>, <em>title='fg'</em>, <em>update=True</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#Annot.show_fgweight_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.Annot.show_fgweight_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="vtool.constrained_matching.AnnotMatch">
<em class="property">class </em><tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">AnnotMatch</tt><big>(</big><em>match</em>, <em>annot1</em>, <em>annot2</em>, <em>fm</em>, <em>fs</em>, <em>key=None</em>, <em>fm_norm=None</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname1</span><span class="p">,</span> <span class="n">fname2</span> <span class="o">=</span> <span class="s">&#39;easy1.png&#39;</span><span class="p">,</span> <span class="s">&#39;easy2.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">fname1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">fname2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot1</span><span class="p">,</span> <span class="n">annot2</span> <span class="o">=</span> <span class="n">Annot</span><span class="p">(</span><span class="n">fpath1</span><span class="p">),</span> <span class="n">Annot</span><span class="p">(</span><span class="n">fpath2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_ORIG</span><span class="p">,</span> <span class="n">match_RAT</span><span class="p">,</span> <span class="n">match_SV</span> <span class="o">=</span> <span class="n">annot1</span><span class="o">.</span><span class="n">baseline_match</span><span class="p">(</span><span class="n">annot2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match_SV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_SC</span><span class="p">,</span> <span class="n">match_SCR</span><span class="p">,</span> <span class="n">match_SCRSV</span> <span class="o">=</span> <span class="n">annot1</span><span class="o">.</span><span class="n">constrained_match</span><span class="p">(</span><span class="n">match_SV</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match</span> <span class="o">=</span> <span class="n">match_SCR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ___</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">match_ORIG</span><span class="p">,</span> <span class="n">match_RAT</span><span class="p">,</span> <span class="n">match_SV</span><span class="p">,</span> <span class="n">match_SC</span><span class="p">,</span> <span class="n">match_SCR</span><span class="p">,</span> <span class="n">match_SCRSV</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># false match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname3</span> <span class="o">=</span> <span class="s">&#39;hard3.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath3</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">fname3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot3</span> <span class="o">=</span> <span class="n">Annot</span><span class="p">(</span><span class="n">fpath3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_tn_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_tn_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">annot1</span><span class="o">.</span><span class="n">baseline_match</span><span class="p">(</span><span class="n">annot3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_SV_fn</span> <span class="o">=</span> <span class="n">match_tn_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_tn_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">annot1</span><span class="o">.</span><span class="n">constrained_match</span><span class="p">(</span><span class="n">match_SV_fn</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ___</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;___________&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">match_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">match</span><span class="o">.</span><span class="n">print_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;___________&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match_tn</span> <span class="ow">in</span> <span class="n">match_tn_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">match_tn</span><span class="o">.</span><span class="n">print_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;___________&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">match</span><span class="p">,</span> <span class="n">match_tn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">match_list</span><span class="p">,</span> <span class="n">match_tn_list</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">match</span><span class="o">.</span><span class="n">print_score_diffs</span><span class="p">(</span><span class="n">match_tn</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Ignore::</dt>
<dd><p class="first">match.show_matches(fnum=1, update=True)</p>
<p class="last">match.show_normalizers(fnum=2, update=True)</p>
</dd>
</dl>
<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_coverage_mask">
<tt class="descname">compute_coverage_mask</tt><big>(</big><em>match</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>compute matching coverage of annot</p>
</dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_scores">
<tt class="descname">compute_scores</tt><big>(</big><em>match</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_weighte_average_score">
<tt class="descname">compute_weighte_average_score</tt><big>(</big><em>match</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_weighte_average_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_weighte_average_score" title="Permalink to this definition">¶</a></dt>
<dd><p>old scoring measure</p>
</dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.compute_weighted_coverage_score">
<tt class="descname">compute_weighted_coverage_score</tt><big>(</big><em>match</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.compute_weighted_coverage_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.compute_weighted_coverage_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.lazy_compute">
<tt class="descname">lazy_compute</tt><big>(</big><em>match</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.lazy_compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.lazy_compute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.print_score_diffs">
<tt class="descname">print_score_diffs</tt><big>(</big><em>match</em>, <em>match_tn</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.print_score_diffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.print_score_diffs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.print_scores">
<tt class="descname">print_scores</tt><big>(</big><em>match</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.print_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.print_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.show_matches">
<tt class="descname">show_matches</tt><big>(</big><em>match</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>update=True</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.show_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.show_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.constrained_matching.AnnotMatch.show_normalizers">
<tt class="descname">show_normalizers</tt><big>(</big><em>match</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>update=True</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#AnnotMatch.show_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.AnnotMatch.show_normalizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.assign_nearest_neighbors">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">assign_nearest_neighbors</tt><big>(</big><em>vecs1</em>, <em>vecs2</em>, <em>K=2</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#assign_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.assign_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.baseline_vsone_ratio_matcher">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">baseline_vsone_ratio_matcher</tt><big>(</big><em>testtup</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#baseline_vsone_ratio_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.baseline_vsone_ratio_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>spatially constrained ratio matching</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.constrained_matching &#8211;test-spatially_constrianed_matcher</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">testdata_matcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basetup</span><span class="p">,</span> <span class="n">base_meta</span> <span class="o">=</span> <span class="n">baseline_vsone_ratio_matcher</span><span class="p">(</span><span class="n">testtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">basetup</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.baseline_vsone_ratio_matcher_">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">baseline_vsone_ratio_matcher_</tt><big>(</big><em>kpts1</em>, <em>vecs1</em>, <em>kpts2</em>, <em>vecs2</em>, <em>dlen_sqrd2</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#baseline_vsone_ratio_matcher_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.baseline_vsone_ratio_matcher_" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vecs1</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; SIFT descriptors</li>
<li><strong>vecs2</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; SIFT descriptors</li>
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first">%pylab qt4
import plottool as pt
pt.imshow(rchip1)
pt.draw_kpts2(kpts1)</p>
<p class="last">pt.show_chipmatch2(rchip1, rchip2, kpts1, kpts2, fm=fm, fs=fs)
pt.show_chipmatch2(rchip1, rchip2, kpts1, kpts2, fm=fm, fs=fs)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.compute_distinctivness">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">compute_distinctivness</tt><big>(</big><em>vecs_list</em>, <em>species='zebra_plains'</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#compute_distinctivness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.compute_distinctivness" title="Permalink to this definition">¶</a></dt>
<dd><p>hack in distinctivness</p>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.compute_forgroundness">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">compute_forgroundness</tt><big>(</big><em>fpath1</em>, <em>kpts1</em>, <em>species='zebra_plains'</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#compute_forgroundness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.compute_forgroundness" title="Permalink to this definition">¶</a></dt>
<dd><p>hack in foregroundness</p>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.spatially_constrain_matches">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">spatially_constrain_matches</tt><big>(</big><em>dlen_sqrd2</em>, <em>kpts1</em>, <em>kpts2</em>, <em>H_RAT</em>, <em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>match_xy_thresh</em>, <em>normalizer_mode='far'</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#spatially_constrain_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.spatially_constrain_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for spatially_constrianed_matcher
OLD FUNCTION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H_RAT</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix</li>
<li><strong>match_xy_thresh</strong> &#8211; threshold is specified as a fraction of the diagonal chip length</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.spatially_constrianed_matcher">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">spatially_constrianed_matcher</tt><big>(</big><em>testtup</em>, <em>basetup</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#spatially_constrianed_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.spatially_constrianed_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>spatially constrained ratio matching</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.constrained_matching &#8211;test-spatially_constrianed_matcher</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">testdata_matcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basetup</span><span class="p">,</span> <span class="n">base_meta</span> <span class="o">=</span> <span class="n">baseline_vsone_ratio_matcher</span><span class="p">(</span><span class="n">testtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nexttup</span><span class="p">,</span> <span class="n">next_meta</span> <span class="o">=</span> <span class="n">spatially_constrianed_matcher</span><span class="p">(</span><span class="n">testtup</span><span class="p">,</span> <span class="n">basetup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">nexttup</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.spatially_constrianed_matcher_">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">spatially_constrianed_matcher_</tt><big>(</big><em>kpts1</em>, <em>vecs1</em>, <em>kpts2</em>, <em>vecs2</em>, <em>dlen_sqrd2</em>, <em>H_RAT</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#spatially_constrianed_matcher_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.spatially_constrianed_matcher_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.constrained_matching.testdata_matcher">
<tt class="descclassname">vtool.constrained_matching.</tt><tt class="descname">testdata_matcher</tt><big>(</big><em>fname1='easy1.png'</em>, <em>fname2='easy2.png'</em><big>)</big><a class="reference internal" href="_modules/vtool/constrained_matching.html#testdata_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.constrained_matching.testdata_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8221;
fname1 = &#8216;easy1.png&#8217;
fname2 = &#8216;hard3.png&#8217;</p>
<p>annot1 = Annot(fpath1)
annot2 = Annot(fpath2)</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.coverage_grid">
<span id="vtool-coverage-grid-module"></span><h2>vtool.coverage_grid module<a class="headerlink" href="#module-vtool.coverage_grid" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.coverage_grid.compute_subbin_to_bins_dist">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">compute_subbin_to_bins_dist</tt><big>(</big><em>neighbor_bin_centers</em>, <em>subbin_xy_arr</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#compute_subbin_to_bins_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.compute_subbin_to_bins_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.get_coverage_grid_gridsearch_configs">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">get_coverage_grid_gridsearch_configs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_coverage_grid_gridsearch_configs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.get_coverage_grid_gridsearch_configs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.get_subbin_xy_neighbors">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">get_subbin_xy_neighbors</tt><big>(</big><em>subbin_index00</em>, <em>grid_steps</em>, <em>num_cols</em>, <em>num_rows</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#get_subbin_xy_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.get_subbin_xy_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all neighbor of a bin
subbin_index00 = left and up subbin index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.gridsearch_coverage_grid">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">gridsearch_coverage_grid</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid &#8211;test-gridsearch_coverage_grid &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.gridsearch_coverage_grid_mask">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">gridsearch_coverage_grid_mask</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#gridsearch_coverage_grid_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.gridsearch_coverage_grid_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid &#8211;test-gridsearch_coverage_grid_mask &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_coverage_grid_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.make_grid_coverage_mask">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">make_grid_coverage_mask</tt><big>(</big><em>kpts</em>, <em>chipsize</em>, <em>weights</em>, <em>pxl_per_bin=4</em>, <em>grid_steps=1</em>, <em>resize=False</em>, <em>out=None</em>, <em>grid_sigma=1.6</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#make_grid_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.make_grid_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoint</li>
<li><strong>chipsize</strong> (<em>tuple</em>) &#8211; width, height</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weightgrid</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid &#8211;test-make_grid_coverage_mask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">(</span><span class="s">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weightgrid</span> <span class="o">=</span> <span class="n">make_grid_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify result</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">weightgrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.show_coverage_grid">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">show_coverage_grid</tt><big>(</big><em>num_rows</em>, <em>num_cols</em>, <em>subbin_xy_arr</em>, <em>neighbor_bin_centers</em>, <em>neighbor_bin_weights</em>, <em>neighbor_bin_indices</em>, <em>fnum=None</em>, <em>pnum=None</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#show_coverage_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.show_coverage_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>visualizes the voting scheme on the grid. (not a mask, and no max)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.sparse_grid_coverage">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">sparse_grid_coverage</tt><big>(</big><em>kpts</em>, <em>chipsize</em>, <em>weights</em>, <em>pxl_per_bin=0.3</em>, <em>grid_steps=1</em>, <em>grid_sigma=1.6</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#sparse_grid_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.sparse_grid_coverage" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoint</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_grid &#8211;test-sparse_grid_coverage &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_grid</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">coverage_kpts</span><span class="o">.</span><span class="n">testdata_coverage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">chipsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pxl_per_bin</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_steps</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_sigma</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coverage_gridtup</span> <span class="o">=</span> <span class="n">sparse_grid_coverage</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">pxl_per_bin</span><span class="p">,</span> <span class="n">grid_steps</span><span class="p">,</span> <span class="n">grid_sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">show_coverage_grid</span><span class="p">(</span><span class="o">*</span><span class="n">coverage_gridtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_grid.weighted_gaussian_falloff">
<tt class="descclassname">vtool.coverage_grid.</tt><tt class="descname">weighted_gaussian_falloff</tt><big>(</big><em>neighbor_subbin_sqrddist_arr</em>, <em>weights</em>, <em>grid_sigma</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_grid.html#weighted_gaussian_falloff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_grid.weighted_gaussian_falloff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.coverage_kpts">
<span id="vtool-coverage-kpts-module"></span><h2>vtool.coverage_kpts module<a class="headerlink" href="#module-vtool.coverage_kpts" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">get_coverage_kpts_gridsearch_configs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_coverage_kpts_gridsearch_configs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.get_coverage_kpts_gridsearch_configs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.get_gaussian_weight_patch">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">get_gaussian_weight_patch</tt><big>(</big><em>gauss_shape=(19</em>, <em>19)</em>, <em>gauss_sigma_frac=0.3</em>, <em>gauss_norm_01=True</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#get_gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.get_gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>2d gaussian image useful for plotting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">patch</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts &#8211;test-get_gaussian_weight_patch</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_gaussian_weight_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.gridsearch_kpts_coverage_mask">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">gridsearch_kpts_coverage_mask</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#gridsearch_kpts_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.gridsearch_kpts_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts &#8211;test-gridsearch_kpts_coverage_mask &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_kpts_coverage_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.make_kpts_coverage_mask">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">make_kpts_coverage_mask</tt><big>(</big><em>kpts</em>, <em>chipsize</em>, <em>weights=None</em>, <em>return_patch=False</em>, <em>patch=None</em>, <em>resize=False</em>, <em>out=None</em>, <em>cov_blur_on=True</em>, <em>cov_blur_ksize=(17</em>, <em>17)</em>, <em>cov_blur_sigma=5.0</em>, <em>cov_gauss_shape=(19</em>, <em>19)</em>, <em>cov_gauss_sigma_frac=0.3</em>, <em>cov_scale_factor=0.2</em>, <em>cov_agg_mode='max'</em>, <em>cov_remove_shape=False</em>, <em>cov_remove_scale=False</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#make_kpts_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.make_kpts_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a intensity image denoting which pixels are covered by the input
keypoints</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</li>
<li><strong>chipsize</strong> (<em>tuple</em>) &#8211; width height of the underlying image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>tuple</strong> &#8211;
dstimg, patch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.coverage_kpts &#8211;test-make_kpts_coverage_mask &#8211;show
python -m vtool.coverage_kpts &#8211;test-make_kpts_coverage_mask</p>
<p class="last">python -m vtool.patch &#8211;test-test_show_gaussian_patches2 &#8211;show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#img_fpath = ut.grab_test_imgpath(&#39;carl.jpg&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_kpts</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipsize</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span><span class="p">,</span> <span class="n">patch</span> <span class="o">=</span> <span class="n">make_kpts_coverage_mask</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_patch</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.show_coverage_map">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">show_coverage_map</tt><big>(</big><em>chip</em>, <em>mask</em>, <em>patch</em>, <em>kpts</em>, <em>fnum=None</em>, <em>ell_alpha=0.6</em>, <em>show_mask_kpts=False</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#show_coverage_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.show_coverage_map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.testdata_coverage">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">testdata_coverage</tt><big>(</big><em>fname=None</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#testdata_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.testdata_coverage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.warp_patch_onto_kpts">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">warp_patch_onto_kpts</tt><big>(</big><em>kpts</em>, <em>patch</em>, <em>chipshape</em>, <em>weights=None</em>, <em>out=None</em>, <em>cov_scale_factor=0.2</em>, <em>cov_agg_mode='max'</em>, <em>cov_remove_shape=False</em>, <em>cov_remove_scale=False</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warp_patch_onto_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.warp_patch_onto_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Overlays the source image onto a destination image in each keypoint location</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>patch</strong> (<em>ndarray</em>) &#8211; patch to warp (like gaussian)</li>
<li><strong>weights</strong> (<em>ndarray</em>) &#8211; score for every keypoint</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>cov_scale_factor (float):</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mask</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.coverage_kpts &#8211;test-warp_patch_onto_kpts
python -m vtool.coverage_kpts &#8211;test-warp_patch_onto_kpts &#8211;show
python -m vtool.coverage_kpts &#8211;test-warp_patch_onto_kpts &#8211;show &#8211;hole
python -m vtool.coverage_kpts &#8211;test-warp_patch_onto_kpts &#8211;show &#8211;square
python -m vtool.coverage_kpts &#8211;test-warp_patch_onto_kpts &#8211;show &#8211;square &#8211;hole</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyhesaff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span>    <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyhesaff</span><span class="o">.</span><span class="n">detect_kpts</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[::</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipshape</span> <span class="o">=</span> <span class="n">chip</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov_scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">srcshape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="n">srcshape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SQUARE</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--square&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HOLE</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--hole&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">SQUARE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">srcshape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">srcshape</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span> <span class="c">#, norm_01=False)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span> <span class="o">=</span> <span class="n">patch</span> <span class="o">/</span> <span class="n">patch</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">HOLE</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstimg</span> <span class="o">=</span> <span class="n">warp_patch_onto_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">chipshape</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cov_scale_factor</span><span class="o">=</span><span class="n">cov_scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;dstimg stats </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;patch stats </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_stats_str</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(patch.sum())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">inbounds</span><span class="p">(</span><span class="n">dstimg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># show results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">dstimg</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">show_coverage_map</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.coverage_kpts.warped_patch_generator">
<tt class="descclassname">vtool.coverage_kpts.</tt><tt class="descname">warped_patch_generator</tt><big>(</big><em>patch</em>, <em>dsize</em>, <em>affmat_list</em>, <em>weight_list</em>, <em>cov_size_penalty_on=True</em>, <em>cov_size_penalty_power=0.5</em>, <em>cov_size_penalty_frac=0.1</em><big>)</big><a class="reference internal" href="_modules/vtool/coverage_kpts.html#warped_patch_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.coverage_kpts.warped_patch_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>generator that warps the patches (like gaussian) onto an image with dsize using constant memory.</p>
<p>output must be used or copied on every iteration otherwise the next output will clobber the previous</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine">http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool.distance">
<span id="vtool-distance-module"></span><h2>vtool.distance module<a class="headerlink" href="#module-vtool.distance" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.distance.L1">
<tt class="descclassname">vtool.distance.</tt><tt class="descname">L1</tt><big>(</big><em>hist1</em>, <em>hist2</em><big>)</big><a class="reference internal" href="_modules/vtool/distance.html#L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L1 (aka manhatten or grid) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2">
<tt class="descclassname">vtool.distance.</tt><tt class="descname">L2</tt><big>(</big><em>hist1</em>, <em>hist2</em><big>)</big><a class="reference internal" href="_modules/vtool/distance.html#L2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2" title="Permalink to this definition">¶</a></dt>
<dd><p>returns L2 (aka euclidean or standard) distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.L2_sqrd">
<tt class="descclassname">vtool.distance.</tt><tt class="descname">L2_sqrd</tt><big>(</big><em>hist1</em>, <em>hist2</em><big>)</big><a class="reference internal" href="_modules/vtool/distance.html#L2_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.L2_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the squared L2 distance</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>L2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">L2_sqrd</span><span class="p">(</span><span class="n">hist1</span><span class="p">,</span> <span class="n">hist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">v9wc&amp;brmvjy1as!z</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth::</dt>
<dd><p class="first">#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] hist1
np.ndarray[np.float64_t, ndim=2] hist2</div></blockquote>
<p>#if CYTH
cdef:</p>
<blockquote>
<div>size_t cx, rx</div></blockquote>
<p>cdef unsigned int rows = hist1.shape[0]
cdef unsigned int cols = hist1.shape[1]
# Prealloc output
cdef np.ndarray[np.float64_t, ndim=1] out = np.zeros((rows,), dtype=hist1.dtype)
for rx in range(rows):</p>
<blockquote>
<div><dl class="docutils">
<dt>for cx in range(cols):</dt>
<dd>out[rx] += (hist1[rx, cx] - hist2[rx, cx]) ** 2</dd>
</dl>
</div></blockquote>
<p class="last">return out
#else</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.det_distance">
<tt class="descclassname">vtool.distance.</tt><tt class="descname">det_distance</tt><big>(</big><em>det1</em>, <em>det2</em><big>)</big><a class="reference internal" href="_modules/vtool/distance.html#det_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.det_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">det_distance</span><span class="p">(</span><span class="n">det1</span><span class="p">,</span> <span class="n">det2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">pfce!exwvqz8e1n!</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth::</dt>
<dd><p class="first">#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=1] det1
np.ndarray[np.float64_t, ndim=1] det2</div></blockquote>
<p>#if CYTH
# TODO: Move to ktool?
cdef unsigned int nDets = det1.shape[0]
# Prealloc output
out = np.zeros((nDets,), dtype=det1.dtype)
cdef size_t ix
for ix in range(nDets):</p>
<blockquote>
<div><p># simple determinant: ad - bc
if det1[ix] &gt; det2[ix]:</p>
<blockquote>
<div>out[ix] = det1[ix] / det2[ix]</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>out[ix] = det2[ix] / det1[ix]</dd>
</dl>
</div></blockquote>
<p class="last">return out
#else</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.hist_isect">
<tt class="descclassname">vtool.distance.</tt><tt class="descname">hist_isect</tt><big>(</big><em>hist1</em>, <em>hist2</em><big>)</big><a class="reference internal" href="_modules/vtool/distance.html#hist_isect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.hist_isect" title="Permalink to this definition">¶</a></dt>
<dd><p>returns histogram intersection distance between two histograms</p>
</dd></dl>

<dl class="function">
<dt id="vtool.distance.ori_distance">
<tt class="descclassname">vtool.distance.</tt><tt class="descname">ori_distance</tt><big>(</big><em>ori1</em>, <em>ori2</em><big>)</big><a class="reference internal" href="_modules/vtool/distance.html#ori_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.distance.ori_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns how far off determinants are from one another</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.distance &#8211;test-ori_distance</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">TAU</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_</span> <span class="o">=</span> <span class="n">ori_distance</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">ori2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ori1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ori2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">dist_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([ 0.3,  1.4,  0.6,  0.3, -0.5,  0.9, -0.4,  2.5,  2.9, -0.7], dtype=np.float64)</span>
<span class="go">np.array([ 1.8,  0.2,  0.4,  2.7, -2.7, -2.6, -3. ,  2.1,  1.7,  2.3], dtype=np.float64)</span>
<span class="go">np.array([ 1.5,  1.2,  0.2,  2.4,  2.2,  2.8,  2.6,  0.4,  1.2,  3.1], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#if CYTH
#CYTH_INLINE
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray ori1
np.ndarray ori2</div></blockquote>
<p class="last">#endif</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        TAU = np.pi * 2</span>
<span class="go">        np.random.seed(53)</span>
<span class="go">        ori1 = (np.random.rand(100000) * TAU) - np.pi</span>
<span class="go">        ori2 = (np.random.rand(100000) * TAU) - np.pi</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>def func_outvars():</dt>
<dd>ori_dist = np.abs(ori1 - ori2)
np.mod(ori_dist, TAU, out=ori_dist)
np.minimum(ori_dist, np.subtract(TAU, ori_dist), out=ori_dist)
return ori_dist</dd>
<dt>def func_orig():</dt>
<dd>ori_dist = np.abs(ori1 - ori2) % TAU
ori_dist = np.minimum(ori_dist, TAU - ori_dist)
return ori_dist</dd>
</dl>
<p>&#8216;&#8217;&#8216;)</p>
</div></blockquote>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        func_outvars()</span>
<span class="go">        func_orig()</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.ellipse">
<span id="vtool-ellipse-module"></span><h2>vtool.ellipse module<a class="headerlink" href="#module-vtool.ellipse" title="Permalink to this headline">¶</a></h2>
<p>This module should handle all things elliptical</p>
<dl class="function">
<dt id="vtool.ellipse.adaptive_scale">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">adaptive_scale</tt><big>(</big><em>img_fpath</em>, <em>kpts</em>, <em>nScales=4</em>, <em>low=-0.5</em>, <em>high=0.5</em>, <em>nSamples=16</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#adaptive_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.adaptive_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.check_kpts_in_bounds">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">check_kpts_in_bounds</tt><big>(</big><em>kpts_</em>, <em>width</em>, <em>height</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#check_kpts_in_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.check_kpts_in_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.circular_distance">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">circular_distance</tt><big>(</big><em>arr=None</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#circular_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.circular_distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_kpts">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">expand_kpts</tt><big>(</big><em>kpts</em>, <em>scales</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#expand_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_scales">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">expand_scales</tt><big>(</big><em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#expand_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_scales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.expand_subscales">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">expand_subscales</tt><big>(</big><em>kpts</em>, <em>subscale_list</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#expand_subscales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.expand_subscales" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.extrema_neighbors">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">extrema_neighbors</tt><big>(</big><em>extrema_list</em>, <em>nBins</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#extrema_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.extrema_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.find_maxima">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">find_maxima</tt><big>(</big><em>y_list</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.find_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.find_maxima_with_neighbors">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">find_maxima_with_neighbors</tt><big>(</big><em>scalar_list</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#find_maxima_with_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.find_maxima_with_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.gradient_magnitude">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">gradient_magnitude</tt><big>(</big><em>img</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#gradient_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.homogenous_circle_pts">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">homogenous_circle_pts</tt><big>(</big><em>nSamples</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#homogenous_circle_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.homogenous_circle_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_between">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">interpolate_between</tt><big>(</big><em>peak_list</em>, <em>nScales</em>, <em>high</em>, <em>low</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_between"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_between" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_maxima">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">interpolate_maxima</tt><big>(</big><em>scalar_list</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_maxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_maxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_peaks">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">interpolate_peaks</tt><big>(</big><em>x_data_list</em>, <em>y_data_list</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.interpolate_peaks2">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">interpolate_peaks2</tt><big>(</big><em>x_data_list</em>, <em>y_data_list</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#interpolate_peaks2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.interpolate_peaks2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.kpts_matrices">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">kpts_matrices</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.kpts_matrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.kpts_to_invV">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">kpts_to_invV</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#kpts_to_invV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.kpts_to_invV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_ell_border_pts">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">sample_ell_border_pts</tt><big>(</big><em>expanded_kpts</em>, <em>nSamples</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_ell_border_vals">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">sample_ell_border_vals</tt><big>(</big><em>imgBGR</em>, <em>expanded_kpts</em>, <em>nKp</em>, <em>nScales</em>, <em>nSamples</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#sample_ell_border_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_ell_border_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.sample_uniform">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">sample_uniform</tt><big>(</big><em>kpts</em>, <em>nSamples=128</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#sample_uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.sample_uniform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.ellipse.subscale_peaks">
<tt class="descclassname">vtool.ellipse.</tt><tt class="descname">subscale_peaks</tt><big>(</big><em>border_vals_sum</em>, <em>kpts</em>, <em>nScales</em>, <em>low</em>, <em>high</em><big>)</big><a class="reference internal" href="_modules/vtool/ellipse.html#subscale_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.ellipse.subscale_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.exif">
<span id="vtool-exif-module"></span><h2>vtool.exif module<a class="headerlink" href="#module-vtool.exif" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.exif.check_exif_keys">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">check_exif_keys</tt><big>(</big><em>pil_img</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#check_exif_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.check_exif_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.convert_degrees">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">convert_degrees</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#convert_degrees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.convert_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert the GPS coordinates stored in the EXIF to degress in float format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_dict">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_exif_dict</tt><big>(</big><em>pil_img</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAGID</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_dict2">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_exif_dict2</tt><big>(</big><em>pil_img</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_exif_dict2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_dict2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exif dictionary by TAG (less efficient)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exif_tagids">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_exif_tagids</tt><big>(</big><em>tag_list</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_exif_tagids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exif_tagids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.get_exist">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_exist</tt><big>(</big><em>data</em>, <em>key</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_exist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_exist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.get_lat_lon">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_lat_lon</tt><big>(</big><em>exif_dict</em>, <em>default=(-1</em>, <em>-1)</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_lat_lon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided exif_data2 (obtained through exif_data2 above)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_lat_lon2">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_lat_lon2</tt><big>(</big><em>exif_data2</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_lat_lon2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_lat_lon2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the latitude and longitude, if available, from the provided exif_data2 (obtained through exif_data2 above)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.get_unixtime">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">get_unixtime</tt><big>(</big><em>exif_dict</em>, <em>default=-1</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#get_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.get_unixtime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.make_exif_dict_human_readable">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">make_exif_dict_human_readable</tt><big>(</big><em>exif_dict</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#make_exif_dict_human_readable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.make_exif_dict_human_readable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.parse_exif_unixtime">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">parse_exif_unixtime</tt><big>(</big><em>image_fpath</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#parse_exif_unixtime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.parse_exif_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">unixtime</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.exif &#8211;test-parse_exif_unixtime</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.exif</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_file_url</span><span class="p">(</span><span class="s">&#39;http://images.summitpost.org/original/769474.JPG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unixtime</span> <span class="o">=</span> <span class="n">parse_exif_unixtime</span><span class="p">(</span><span class="n">image_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">unixtime</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">1325369249.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.exif.read_all_exif_tags">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">read_all_exif_tags</tt><big>(</big><em>pil_img</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#read_all_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_all_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_exif">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">read_exif</tt><big>(</big><em>fpath</em>, <em>tag=None</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#read_exif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_exif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_exif_tags">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">read_exif_tags</tt><big>(</big><em>pil_img</em>, <em>exif_tagid_list</em>, <em>default_list=None</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#read_exif_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_exif_tags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.exif.read_one_exif_tag">
<tt class="descclassname">vtool.exif.</tt><tt class="descname">read_one_exif_tag</tt><big>(</big><em>pil_img</em>, <em>tag</em><big>)</big><a class="reference internal" href="_modules/vtool/exif.html#read_one_exif_tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.exif.read_one_exif_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.features">
<span id="vtool-features-module"></span><h2>vtool.features module<a class="headerlink" href="#module-vtool.features" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.features.extract_features">
<tt class="descclassname">vtool.features.</tt><tt class="descname">extract_features</tt><big>(</big><em>img_fpath</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/features.html#extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>calls pyhesaff&#8217;s main driver function for detecting hessian affine keypoints.
extra parameters can be passed to the hessian affine detector by using
kwargs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img_fpath</strong> (<em>str</em>) &#8211; image file path on disk</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(kpts, vecs)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.features &#8211;test-extract_features
python -m vtool.features &#8211;test-extract_features &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--fname&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;lena.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Show keypoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">doclf</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">docla</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.features.get_extract_features_default_params">
<tt class="descclassname">vtool.features.</tt><tt class="descname">get_extract_features_default_params</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/features.html#get_extract_features_default_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.features.get_extract_features_default_params" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.features &#8211;test-get_extract_features_default_params</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.features</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_dict</span> <span class="o">=</span> <span class="n">get_extract_features_default_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.geometry">
<span id="vtool-geometry-module"></span><h2>vtool.geometry module<a class="headerlink" href="#module-vtool.geometry" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.geometry.bbox_of_verts">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">bbox_of_verts</tt><big>(</big><em>verts</em>, <em>castint=False</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#bbox_of_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bbox_of_verts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.bboxes_from_vert_list">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">bboxes_from_vert_list</tt><big>(</big><em>verts_list</em>, <em>castint=False</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#bboxes_from_vert_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.bboxes_from_vert_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the bounding polygon inside a rectangle</p>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.draw_verts">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">draw_verts</tt><big>(</big><em>img_in</em>, <em>verts</em>, <em>color=(0</em>, <em>128</em>, <em>255)</em>, <em>thickness=2</em>, <em>out=None</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#draw_verts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.draw_verts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ndarray[uint8_t, ndim=2]: img -  image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.geometry &#8211;test-draw_verts &#8211;show
python -m vtool.geometry &#8211;test-draw_verts:0 &#8211;show
python -m vtool.geometry &#8211;test-draw_verts:1 &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.geometry</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_in</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;carl.jpg&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span> <span class="o">=</span> <span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">img_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">draw_verts</span><span class="p">(</span><span class="n">img_in</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">img_in</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">out</span> <span class="ow">is</span> <span class="n">img</span><span class="p">,</span> <span class="s">&#39;should be in place&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.geometry.homogonize">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">homogonize</tt><big>(</big><em>xy_arr</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#homogonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.homogonize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.homogonize_list">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">homogonize_list</tt><big>(</big><em>xy_list</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#homogonize_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.homogonize_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.unhomogonize">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">unhomogonize</tt><big>(</big><em>xyz_arr</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#unhomogonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.unhomogonize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.unhomogonize_list">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">unhomogonize_list</tt><big>(</big><em>xyz_list</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#unhomogonize_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.unhomogonize_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.verts_from_bbox">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">verts_from_bbox</tt><big>(</big><em>bbox</em>, <em>close=False</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#verts_from_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.verts_from_bbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.geometry.verts_list_from_bboxes_list">
<tt class="descclassname">vtool.geometry.</tt><tt class="descname">verts_list_from_bboxes_list</tt><big>(</big><em>bboxes_list</em><big>)</big><a class="reference internal" href="_modules/vtool/geometry.html#verts_list_from_bboxes_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.geometry.verts_list_from_bboxes_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a four-vertex polygon from the bounding rectangle</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.histogram">
<span id="vtool-histogram-module"></span><h2>vtool.histogram module<a class="headerlink" href="#module-vtool.histogram" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.histogram.get_histinfo_str">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">get_histinfo_str</tt><big>(</big><em>hist</em>, <em>edges</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#get_histinfo_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.get_histinfo_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_argmaxima">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">hist_argmaxima</tt><big>(</big><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#hist_argmaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_argmaxima" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-hist_argmaxima</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">hist_argmaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">maxima_x</span><span class="p">,</span> <span class="n">maxima_y</span><span class="p">,</span> <span class="n">argmaxima</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 2.75]), array([ 34.62]), array([4]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_edges_to_centers">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">hist_edges_to_centers</tt><big>(</big><em>edges</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#hist_edges_to_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_edges_to_centers" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.71</span><span class="p">,</span> <span class="mf">5.50</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mf">7.07</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[-0.395  0.395  1.18   1.965  2.75   3.535  4.32   5.105  5.89   6.675]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>import plottool as pt
from matplotlib import pyplot as plt
fig = plt.figure()
plt.plot(edges, [.5] * len(edges), &#8216;r|-&#8216;)
plt.plot(centers, [.5] * len(centers), &#8216;go&#8217;)
plt.gca().set_ylim(.49, .51)
plt.gca().set_xlim(-2, 8)
pt.dark_background()
fig.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.hist_interpolated_submaxima">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">hist_interpolated_submaxima</tt><big>(</big><em>hist</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#hist_interpolated_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.hist_interpolated_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(submaxima_x, submaxima_y)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-hist_interpolated_submaxima</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">hist_interpolated_submaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 3.0318792]), array([ 37.19208239]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="p">[</span><span class="mf">700.413</span><span class="p">,</span> <span class="mf">1680.93</span><span class="p">,</span> <span class="mf">823.31</span><span class="p">,</span> <span class="mf">521.934</span><span class="p">,</span> <span class="mf">721.44</span><span class="p">,</span> <span class="mf">777.964</span><span class="p">,</span> <span class="mf">483.108</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">178.108</span><span class="p">,</span> <span class="mf">243.603</span><span class="p">,</span> <span class="mf">1089.18</span><span class="p">,</span> <span class="mf">2546.99</span><span class="p">,</span> <span class="mf">306.315</span><span class="p">,</span> <span class="mf">210.7</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">277.306</span><span class="p">,</span> <span class="mf">653.927</span><span class="p">,</span> <span class="mf">805.233</span><span class="p">,</span> <span class="mf">537.68</span><span class="p">,</span> <span class="mf">625.399</span><span class="p">,</span> <span class="mf">738.363</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">1572.03</span><span class="p">,</span> <span class="mf">406.922</span><span class="p">,</span> <span class="mf">277.89</span><span class="p">,</span> <span class="mf">172.177</span><span class="p">,</span> <span class="mf">387.935</span><span class="p">,</span> <span class="mf">376.248</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">218.595</span><span class="p">,</span> <span class="mf">195.206</span><span class="p">,</span> <span class="mf">222.028</span><span class="p">,</span> <span class="mf">588.637</span><span class="p">,</span> <span class="mf">376.1</span><span class="p">,</span> <span class="mf">193.714</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">175.754</span><span class="p">,</span> <span class="mf">299.887</span><span class="p">,</span> <span class="mf">446.97</span><span class="p">,</span> <span class="mf">275.423</span><span class="p">,</span> <span class="mf">194.888</span><span class="p">,</span> <span class="mf">700.413</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">1680.93</span><span class="p">,</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.169816</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.169816</span><span class="p">,</span> <span class="mf">0.339631</span><span class="p">,</span> <span class="mf">0.509447</span><span class="p">,</span> <span class="mf">0.679263</span><span class="p">,</span> <span class="mf">0.849078</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">1.01889</span><span class="p">,</span> <span class="mf">1.18871</span><span class="p">,</span> <span class="mf">1.35853</span><span class="p">,</span> <span class="mf">1.52834</span><span class="p">,</span> <span class="mf">1.69816</span><span class="p">,</span> <span class="mf">1.86797</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">2.03779</span><span class="p">,</span> <span class="mf">2.2076</span><span class="p">,</span> <span class="mf">2.37742</span><span class="p">,</span> <span class="mf">2.54724</span><span class="p">,</span> <span class="mf">2.71705</span><span class="p">,</span> <span class="mf">2.88687</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">3.05668</span><span class="p">,</span> <span class="mf">3.2265</span><span class="p">,</span> <span class="mf">3.39631</span><span class="p">,</span> <span class="mf">3.56613</span><span class="p">,</span> <span class="mf">3.73595</span><span class="p">,</span> <span class="mf">3.90576</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">4.07558</span><span class="p">,</span> <span class="mf">4.24539</span><span class="p">,</span> <span class="mf">4.41521</span><span class="p">,</span> <span class="mf">4.58502</span><span class="p">,</span> <span class="mf">4.75484</span><span class="p">,</span> <span class="mf">4.92465</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">5.09447</span><span class="p">,</span> <span class="mf">5.26429</span><span class="p">,</span> <span class="mf">5.4341</span><span class="p">,</span> <span class="mf">5.60392</span><span class="p">,</span> <span class="mf">5.77373</span><span class="p">,</span> <span class="mf">5.94355</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mf">6.11336</span><span class="p">,</span> <span class="mf">6.28318</span><span class="p">,</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">hist_edges_to_centers</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">hist_interpolated_submaxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_hist_subbin_maxima</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt>
<dd>import plottool as pt
pt.draw_hist_subbin_maxima(hist, centers)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.interpolate_submaxima">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">interpolate_submaxima</tt><big>(</big><em>argmaxima</em>, <em>hist</em>, <em>centers=None</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#interpolate_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.interpolate_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-interpolate_submaxima</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>    <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">34.62</span><span class="p">,</span> <span class="mf">29.16</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">6.73</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">1.18</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>  <span class="mf">2.75</span><span class="p">,</span>  <span class="mf">3.53</span><span class="p">,</span> <span class="mf">4.32</span><span class="p">,</span> <span class="mf">5.11</span><span class="p">,</span> <span class="mf">5.89</span><span class="p">,</span> <span class="mf">6.68</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span> <span class="o">=</span> <span class="n">interpolate_submaxima</span><span class="p">(</span><span class="n">argmaxima</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">submaxima_x</span><span class="p">,</span> <span class="n">submaxima_y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([ 0.14597723,  3.0318792 ]), array([  9.20251557,  37.19208239]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>assert str(interpolate_submaxima(argmaxima, hist, centers)) == str(readable_interpolate_submaxima(argmaxima, hist, centers))
%timeit interpolate_submaxima(argmaxima, hist, centers)
%timeit readable_interpolate_submaxima(argmaxima, hist, centers)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.interpolated_histogram">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">interpolated_histogram</tt><big>(</big><em>data</em>, <em>weights</em>, <em>range_</em>, <em>bins</em>, <em>interpolation_wrap=True</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#interpolated_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.interpolated_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Follows np.histogram, but does interpolation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>range</strong> (<em>tuple</em>) &#8211; range from 0 to 1</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-interpolated_histogram</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">range_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_wrap</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">interpolated_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">range_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">interpolation_wrap</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1E-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hist</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">edges</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_histinfo_str</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>#Example2:
#    &gt;&gt;&gt; # ENABLE_DOCTEST
#    &gt;&gt;&gt; from vtool.histogram import *  # NOQA
#    &gt;&gt;&gt; # build test data
#    &gt;&gt;&gt; data    = np.random.rand(10)
#    &gt;&gt;&gt; weights = np.random.rand(10)
#    &gt;&gt;&gt; <a href="#id7"><span class="problematic" id="id8">range_</span></a> = (0, 1)
#    &gt;&gt;&gt; bins = np.random.randint(2) + 1 + np.random.randint(2) * 100
#    &gt;&gt;&gt; interpolation_wrap = True
#    &gt;&gt;&gt; # execute function
#    &gt;&gt;&gt; hist, edges = interpolated_histogram(data, weights, <a href="#id9"><span class="problematic" id="id10">range_</span></a>, bins, interpolation_wrap)
#    &gt;&gt;&gt; assert np.abs(hist.sum() - weights.sum()) &lt; 1E-9
#    &gt;&gt;&gt; assert hist.size == bins
#    &gt;&gt;&gt; assert edges.size == bins + 1
#    &gt;&gt;&gt; result = get_histinfo_str(hist, edges)
#    &gt;&gt;&gt; print(result)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.maxima_neighbors">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">maxima_neighbors</tt><big>(</big><em>argmaxima</em>, <em>hist</em>, <em>centers=None</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#maxima_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.maxima_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.maximum_parabola_point">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">maximum_parabola_point</tt><big>(</big><em>A</em>, <em>B</em>, <em>C</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#maximum_parabola_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.maximum_parabola_point" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.readable_interpolate_submaxima">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">readable_interpolate_submaxima</tt><big>(</big><em>argmaxima</em>, <em>hist</em>, <em>centers=None</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#readable_interpolate_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.readable_interpolate_submaxima" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_hist_submaxima">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">show_hist_submaxima</tt><big>(</big><em>hist_</em>, <em>edges=None</em>, <em>centers=None</em>, <em>maxima_thresh=0.8</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#show_hist_submaxima"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_hist_submaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>For C++ to show data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-show_hist_submaxima &#8211;show
python -m pyhesaff._pyhesaff &#8211;test-test_rot_invar &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--hist&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--maxima_thresh&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_hist_submaxima</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_ori_image">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">show_ori_image</tt><big>(</big><em>gori</em>, <em>weights</em>, <em>patch</em>, <em>gradx=None</em>, <em>grady=None</em>, <em>gauss=None</em>, <em>fnum=None</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_ori_image" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m pyhesaff._pyhesaff &#8211;test-test_rot_invar &#8211;show &#8211;nocpp</p>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.show_ori_image_ondisk">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">show_ori_image_ondisk</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#show_ori_image_ondisk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.show_ori_image_ondisk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m vtool.histogram &#8211;test-show_ori_image_ondisk &#8211;show</p>
<p>python -m vtool.histogram &#8211;test-show_ori_image_ondisk &#8211;show &#8211;patch_img_fpath patches/KP_0_PATCH.png &#8211;ori_img_fpath patches/KP_0_orientations01.png &#8211;weights_img_fpath patches/KP_0_WEIGHTS.png &#8211;grady_img_fpath patches/KP_0_ygradient.png &#8211;gradx_img_fpath patches/KP_0_xgradient.png &#8211;title cpp_show_ori_ondisk</p>
<p class="last">python -m pyhesaff._pyhesaff &#8211;test-test_rot_invar &#8211;show &#8211;rebuild-hesaff &#8211;no-rmbuild</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_ori_image_ondisk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.subbin_bounds">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">subbin_bounds</tt><big>(</big><em>z</em>, <em>radius</em>, <em>low</em>, <em>high</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#subbin_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.subbin_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets quantized bounds of a sub-bin/pixel point and a radius.
Useful for cropping using subpixel points</p>
<dl class="docutils">
<dt>Illustration::</dt>
<dd><p class="first">(the bin edges are pipes)
(the bin centers are pluses)</p>
<p>Input = {&#8216;z&#8217;: 1.5, &#8216;radius&#8217;:5.666, &#8216;low&#8217;:0, &#8216;high&#8217;:7}
Output = {&#8216;z1&#8217;:0, &#8216;z2&#8217;: 7, &#8216;offst&#8217;: 5.66}</p>
<div class="line-block">
<div class="line">|   |   |   |   |   |   |   |</div>
</div>
<dl class="last docutils">
<dt><a href="#id5"><span class="problematic" id="id6">|_+_|_+_|_+_|_+_|_+_|_+_|_+_|_+_|</span></a></dt>
<dd><p class="first">^     ^                     ^
z1    z                     z2</p>
<blockquote>
<div>,.___.___.___.___.___.   &lt; radius (5.333)</div></blockquote>
<dl class="docutils">
<dt>.&#8212;.-,                        &lt; z_offset1 (1.6666)</dt>
<dd>,_.___.___.___.___.___.  &lt; z_offset2 (5.666)</dd>
</dl>
<p class="last">.&#8212;.-,                        &lt; z_offset1 (1.6666)</p>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>float</em>) &#8211; center of a circle a 1d pixel array</li>
<li><strong>radius</strong> (<em>float</em>) &#8211; radius of the circle</li>
<li><strong>low</strong> (<em>int</em>) &#8211; minimum index of 1d pixel array</li>
<li><strong>high</strong> (<em>int</em>) &#8211; maximum index of 1d pixel array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(iz1, iz2, z_offst) - quantized_bounds and subbin_offset
iz1 - low radius endpoint
iz2 - high radius endpoint
z_offst - subpixel offset
#Returns: quantized_bounds=(iz1, iz2), subbin_offset</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-subbin_bounds</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.666</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">)</span> <span class="o">=</span> <span class="n">subbin_bounds</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">iz1</span><span class="p">,</span> <span class="n">iz2</span><span class="p">,</span> <span class="n">z_offst</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 7, 1.5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.histogram.wrap_histogram">
<tt class="descclassname">vtool.histogram.</tt><tt class="descname">wrap_histogram</tt><big>(</big><em>hist_</em>, <em>edges_</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/histogram.html#wrap_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.histogram.wrap_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates the first and last histogram bin being being adjacent to one another
by replicating those bins at the last and first positions respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(hist_wrap, edge_wrap)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.histogram &#8211;test-wrap_histogram</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.histogram</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>  <span class="mf">8.</span>  <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">34.32</span><span class="p">,</span>  <span class="mf">29.45</span><span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>   <span class="mf">0.</span>  <span class="p">,</span>   <span class="mf">6.73</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.78539816</span><span class="p">,</span>  <span class="mf">1.57079633</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">2.35619449</span><span class="p">,</span>  <span class="mf">3.14159265</span><span class="p">,</span>  <span class="mf">3.92699081</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="mf">4.71238898</span><span class="p">,</span>  <span class="mf">5.49778714</span><span class="p">,</span>  <span class="mf">6.2831853</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist_wrap</span><span class="p">,</span> <span class="n">edge_wrap</span><span class="p">)</span> <span class="o">=</span> <span class="n">wrap_histogram</span><span class="p">(</span><span class="n">hist_</span><span class="p">,</span> <span class="n">edges_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edgewrap_str</span> <span class="o">=</span>  <span class="s">&#39;[&#39;</span> <span class="o">+</span>  <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&#39;</span><span class="si">%.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">edge_wrap</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;]&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">histwrap_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">hist_wrap</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">histwrap_str</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">NEWLINE</span> <span class="o">+</span> <span class="n">edgewrap_str</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[6.73, 8.0, 0.0, 0.0, 34.32, 29.45, 0.0, 0.0, 6.73, 8.0]</span>
<span class="go">[-0.79, 0.00, 0.79, 1.57, 2.36, 3.14, 3.93, 4.71, 5.50, 6.28, 7.07]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.image">
<span id="vtool-image-module"></span><h2>vtool.image module<a class="headerlink" href="#module-vtool.image" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.image.ThumbnailCacheContext">
<em class="property">class </em><tt class="descclassname">vtool.image.</tt><tt class="descname">ThumbnailCacheContext</tt><big>(</big><em>uuid_list</em>, <em>asrgb=True</em>, <em>thumb_size=64</em>, <em>thumb_dpath=None</em>, <em>appname='vtool'</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#ThumbnailCacheContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.ThumbnailCacheContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Lazy computation of of images as thumbnails.</p>
<p>Just pass a list of uuids corresponding to the images. Then compute images
flagged as dirty and give them back to the context.  thumbs_list will be
populated on contex exit</p>
<dl class="method">
<dt id="vtool.image.ThumbnailCacheContext.filter_dirty_items">
<tt class="descname">filter_dirty_items</tt><big>(</big><em>list_</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#ThumbnailCacheContext.filter_dirty_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.ThumbnailCacheContext.filter_dirty_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns only items marked by the context as dirty</p>
</dd></dl>

<dl class="method">
<dt id="vtool.image.ThumbnailCacheContext.save_dirty_thumbs_from_images">
<tt class="descname">save_dirty_thumbs_from_images</tt><big>(</big><em>img_list</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#ThumbnailCacheContext.save_dirty_thumbs_from_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.ThumbnailCacheContext.save_dirty_thumbs_from_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass in any images marked by the context as dirty here</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.image.blend_images">
<tt class="descclassname">vtool.image.</tt><tt class="descname">blend_images</tt><big>(</big><em>img1</em>, <em>img2</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#blend_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.blend_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_BGR2L">
<tt class="descclassname">vtool.image.</tt><tt class="descname">cvt_BGR2L</tt><big>(</big><em>imgBGR</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2L"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_BGR2L" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_BGR2RGB">
<tt class="descclassname">vtool.image.</tt><tt class="descname">cvt_BGR2RGB</tt><big>(</big><em>imgBGR</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#cvt_BGR2RGB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_BGR2RGB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.cvt_bbox_xywh_to_pt1pt2">
<tt class="descclassname">vtool.image.</tt><tt class="descname">cvt_bbox_xywh_to_pt1pt2</tt><big>(</big><em>xywh</em>, <em>sx=1.0</em>, <em>sy=1.0</em>, <em>round_=True</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#cvt_bbox_xywh_to_pt1pt2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.cvt_bbox_xywh_to_pt1pt2" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts bbox to thumb format with a scale factor</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.find_pixel_value">
<tt class="descclassname">vtool.image.</tt><tt class="descname">find_pixel_value</tt><big>(</big><em>img</em>, <em>pixel</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#find_pixel_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.find_pixel_value" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.math &#8211;test-find_pixel_value</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition">http://stackoverflow.com/questions/21407815/get-column-row-index-from-numpy-array-that-meets-a-boolean-condition</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pixel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">find_pixel_value</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 3]</span>
<span class="go"> [5 5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_gpathlist_sizes">
<tt class="descclassname">vtool.image.</tt><tt class="descname">get_gpathlist_sizes</tt><big>(</big><em>gpath_list</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#get_gpathlist_sizes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_gpathlist_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>reads the size of each image in gpath_list</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_num_channels">
<tt class="descclassname">vtool.image.</tt><tt class="descname">get_num_channels</tt><big>(</big><em>img</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#get_num_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_num_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of color channels</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_scale_factor">
<tt class="descclassname">vtool.image.</tt><tt class="descname">get_scale_factor</tt><big>(</big><em>src_img</em>, <em>dst_img</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#get_scale_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_scale_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>returns scale factor from one image to the next</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.get_size">
<tt class="descclassname">vtool.image.</tt><tt class="descname">get_size</tt><big>(</big><em>img</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the image size in (width, height)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imread">
<tt class="descclassname">vtool.image.</tt><tt class="descname">imread</tt><big>(</big><em>img_fpath</em>, <em>delete_if_corrupted=False</em>, <em>grayscale=False</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#imread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imread" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">imgBGR</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image &#8211;test-imread</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error">http://docs.opencv.org/modules/core/doc/utility_and_system_functions_and_macros.html#error</a>
<a class="reference external" href="http://stackoverflow.com/questions/23572241/cv2-threshold-error-210">http://stackoverflow.com/questions/23572241/cv2-threshold-error-210</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_if_corrupted</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grayscale</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">delete_if_corrupted</span><span class="p">,</span> <span class="n">grayscale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imwrite">
<tt class="descclassname">vtool.image.</tt><tt class="descname">imwrite</tt><big>(</big><em>img_fpath</em>, <em>imgBGR</em>, <em>fallback=False</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#imwrite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imwrite" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html">http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.imwrite_fallback">
<tt class="descclassname">vtool.image.</tt><tt class="descname">imwrite_fallback</tt><big>(</big><em>img_fpath</em>, <em>imgBGR</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#imwrite_fallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.imwrite_fallback" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.open_image_size">
<tt class="descclassname">vtool.image.</tt><tt class="descname">open_image_size</tt><big>(</big><em>image_fpath</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#open_image_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.open_image_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.open_pil_image">
<tt class="descclassname">vtool.image.</tt><tt class="descname">open_pil_image</tt><big>(</big><em>image_fpath</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#open_pil_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.open_pil_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.pad_image_on_disk">
<tt class="descclassname">vtool.image.</tt><tt class="descname">pad_image_on_disk</tt><big>(</big><em>img_fpath</em>, <em>pad_</em>, <em>out_fpath=None</em>, <em>value=0</em>, <em>borderType=0L</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#pad_image_on_disk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.pad_image_on_disk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.print_image_checks">
<tt class="descclassname">vtool.image.</tt><tt class="descname">print_image_checks</tt><big>(</big><em>img_fpath</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#print_image_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.print_image_checks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resize</tt><big>(</big><em>img</em>, <em>dsize</em>, <em>interpolation=4L</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_image_by_scale">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resize_image_by_scale</tt><big>(</big><em>img</em>, <em>scale</em>, <em>interpolation=4L</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resize_image_by_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_image_by_scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resize_imagelist_generator">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resize_imagelist_generator</tt><big>(</big><em>gpath_list</em>, <em>new_gpath_list</em>, <em>newsize_list</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resize_imagelist_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_imagelist_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes images and yeilds results asynchronously</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_imagelist_to_sqrtarea">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resize_imagelist_to_sqrtarea</tt><big>(</big><em>gpath_list</em>, <em>new_gpath_list=None</em>, <em>sqrt_area=800</em>, <em>output_dir=None</em>, <em>checkexists=True</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resize_imagelist_to_sqrtarea"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_imagelist_to_sqrtarea" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes images and yeilds results asynchronously</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_thumb">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resize_thumb</tt><big>(</big><em>img</em>, <em>max_dsize=(64</em>, <em>64)</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resize_thumb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an image such that its max width or height is:</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resize_worker">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resize_worker</tt><big>(</big><em>tup</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resize_worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resize_worker" title="Permalink to this definition">¶</a></dt>
<dd><p>worker function for parallel generator</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.resized_clamped_thumb_dims">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resized_clamped_thumb_dims</tt><big>(</big><em>img_size</em>, <em>max_dsize</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resized_clamped_thumb_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resized_clamped_thumb_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.resized_dims_and_ratio">
<tt class="descclassname">vtool.image.</tt><tt class="descname">resized_dims_and_ratio</tt><big>(</big><em>img_size</em>, <em>max_dsize</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#resized_dims_and_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.resized_dims_and_ratio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.image.rotate_image">
<tt class="descclassname">vtool.image.</tt><tt class="descname">rotate_image</tt><big>(</big><em>img</em>, <em>theta</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#rotate_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rotate_image" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image &#8211;test-rotate_image</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_test_patch</span><span class="p">(</span><span class="s">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">16.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgR</span> <span class="o">=</span> <span class="n">rotate_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span>  <span class="o">*</span> <span class="mi">255</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgR</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.rotate_image_on_disk">
<tt class="descclassname">vtool.image.</tt><tt class="descname">rotate_image_on_disk</tt><big>(</big><em>img_fpath</em>, <em>theta</em>, <em>out_fpath=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#rotate_image_on_disk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.rotate_image_on_disk" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.image &#8211;test-rotate_image_on_disk</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">TAU</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fpath_</span> <span class="o">=</span> <span class="n">rotate_image_on_disk</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">out_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out_fpath_</span><span class="p">,</span>  <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.scale_bbox_to_verts_gen">
<tt class="descclassname">vtool.image.</tt><tt class="descname">scale_bbox_to_verts_gen</tt><big>(</big><em>bbox_list</em>, <em>theta_list</em>, <em>sx</em>, <em>sy</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#scale_bbox_to_verts_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.scale_bbox_to_verts_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps with drawing scaled bbounding boxes on thumbnails</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bbox_list</strong> (<em>list</em>) &#8211; bboxes in x,y,w,h format</li>
<li><strong>theta_list</strong> (<em>list</em>) &#8211; rotation of bounding boxes</li>
<li><strong>sx</strong> (<em>float</em>) &#8211; x scale factor</li>
<li><strong>sy</strong> (<em>float</em>) &#8211; y scale factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Yeilds:</dt>
<dd>new_verts - vertices of scaled bounding box for every input</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.image &#8211;test-scale_bbox_to_verts_gen</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.image</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_verts_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scale_bbox_to_verts_gen</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_verts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[5, 5], [55, 5], [55, 55], [5, 55], [5, 5]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.image.subpixel_values">
<tt class="descclassname">vtool.image.</tt><tt class="descname">subpixel_values</tt><big>(</big><em>img</em>, <em>pts</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#subpixel_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.subpixel_values" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p>stackoverflow.com/uestions/12729228/simple-efficient-binlinear-interpolation-of-images-in-numpy-and-python</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>cv2.getRectSubPix(image, patchSize, center[, patch[, patchType]])</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.image.warpAffine">
<tt class="descclassname">vtool.image.</tt><tt class="descname">warpAffine</tt><big>(</big><em>img</em>, <em>Aff</em>, <em>dsize</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#warpAffine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.warpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image.warpHomog">
<tt class="descclassname">vtool.image.</tt><tt class="descname">warpHomog</tt><big>(</big><em>img</em>, <em>Homog</em>, <em>dsize</em><big>)</big><a class="reference internal" href="_modules/vtool/image.html#warpHomog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image.warpHomog" title="Permalink to this definition">¶</a></dt>
<dd><p>dsize = (width, height) of return image</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.image_filters">
<span id="vtool-image-filters-module"></span><h2>vtool.image_filters module<a class="headerlink" href="#module-vtool.image_filters" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.image_filters.adapteq_fn">
<tt class="descclassname">vtool.image_filters.</tt><tt class="descname">adapteq_fn</tt><big>(</big><em>chipBGR</em><big>)</big><a class="reference internal" href="_modules/vtool/image_filters.html#adapteq_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.adapteq_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>create a CLAHE object (Arguments are optional).</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.clean_mask">
<tt class="descclassname">vtool.image_filters.</tt><tt class="descname">clean_mask</tt><big>(</big><em>mask</em>, <em>num_dilate=3</em>, <em>num_erode=3</em>, <em>window_frac=0.025</em><big>)</big><a class="reference internal" href="_modules/vtool/image_filters.html#clean_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.clean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.grabcut_fn">
<tt class="descclassname">vtool.image_filters.</tt><tt class="descname">grabcut_fn</tt><big>(</big><em>chipBGR</em><big>)</big><a class="reference internal" href="_modules/vtool/image_filters.html#grabcut_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.grabcut_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>naively segments a chip</p>
</dd></dl>

<dl class="function">
<dt id="vtool.image_filters.histeq_fn">
<tt class="descclassname">vtool.image_filters.</tt><tt class="descname">histeq_fn</tt><big>(</big><em>chipBGR</em><big>)</big><a class="reference internal" href="_modules/vtool/image_filters.html#histeq_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.image_filters.histeq_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram equalization of a grayscale image. from  _tpl/other</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.keypoint">
<span id="vtool-keypoint-module"></span><h2>vtool.keypoint module<a class="headerlink" href="#module-vtool.keypoint" title="Permalink to this headline">¶</a></h2>
<p>python -c &#8220;import vtool, doctest; print(doctest.testmod(vtool.keypoint))&#8221;</p>
<p>Keypoints are stored in the invA format by default.
Unfortunately many places in the code reference this as A instead of invA
because I was confused when I first started writing this.</p>
<p>to rectify this I am changing terminology.</p>
<dl class="docutils">
<dt>Variables:</dt>
<dd><dl class="first last docutils">
<dt>invV <span class="classifier-delimiter">:</span> <span class="classifier">maps from ucircle onto an ellipse (perdoch.invA)</span></dt>
<dd>V : maps from ellipse to ucircle      (perdoch.A)
Z : the conic matrix                  (perdoch.E)</dd>
</dl>
</dd>
<dt>Representation:</dt>
<dd><dl class="first last docutils">
<dt>kpts (ndarray) <span class="classifier-delimiter">:</span> <span class="classifier">[x, y, iv11, iv21, iv22, ori]</span></dt>
<dd>a flat on disk representation of the keypoint</dd>
<dt>invV (ndarray): [(iv11, iv12, x),</dt>
<dd><blockquote class="first">
<div>(iv21, iv22, y),
(   0,    0, 1),]</div></blockquote>
<p class="last">a more conceptually useful representation mapp;ing a
unit circle onto an ellipse (without any rotation)</p>
</dd>
<dt>invVR (ndarray): [(iv11, iv12, x),</dt>
<dd><blockquote class="first">
<div>(iv21, iv22, y),
(   0,    0, 1),].dot(R)</div></blockquote>
<p class="last">same as invV but it is rotated before warping a unit circle
into an ellipse.</p>
</dd>
</dl>
</dd>
<dt>Efficiency Notes:</dt>
<dd><p class="first">single index indexing is very fast</p>
<p>slicing seems to be very fast.</p>
<p class="last">fancy indexing with __getitem__ is very slow
using np.take is a better idea, but its a bit harder
to use with multidimensional arrays</p>
</dd>
</dl>
<dl class="data">
<dt id="vtool.keypoint.TAU">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">TAU</tt><em class="property"> = 6.283185307179586</em><a class="headerlink" href="#vtool.keypoint.TAU" title="Permalink to this definition">¶</a></dt>
<dd><p>%s/<a href="#id11"><span class="problematic" id="id12">numpy_floatarray_</span></a>([13])dimension/np.ndarray[np.float64_t, ndim=1]/gc
%s/np.ndarray[np.float64_t, ndim=([13])]/<a href="#id13"><span class="problematic" id="id14">numpy_floatarray_</span></a>1dimension/gc</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.augment_2x2_with_translation">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">augment_2x2_with_translation</tt><big>(</big><em>kpts</em>, <em>_mat2x2</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#augment_2x2_with_translation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.augment_2x2_with_translation" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to augment shape matrix with a translation component</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.cast_split">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">cast_split</tt><big>(</big><em>kpts</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#cast_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.cast_split" title="Permalink to this definition">¶</a></dt>
<dd><p>breakup keypoints into location, shape, and orientation</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.flatten_invV_mats_to_kpts">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">flatten_invV_mats_to_kpts</tt><big>(</big><em>invV_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#flatten_invV_mats_to_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.flatten_invV_mats_to_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens invV matrices into kpts format</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_RV_mats_3x3">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_RV_mats_3x3</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_RV_mats_3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_RV_mats_3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>prefered over get_invV_mats</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>V_mats</strong> &#8211;
sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_V_mats">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_V_mats</tt><big>(</big><em>kpts</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_V_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_V_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>V_mats</strong> &#8211;
sequence of matrices that transform an ellipse to unit circle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_Z_mats">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_Z_mats</tt><big>(</big><em>V_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_Z_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_Z_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>transform into conic matrix Z
Z = (V.T).dot(V)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>Z_mats</strong> &#8211;
Z is a conic representation of an ellipse</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_grid_kpts">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_grid_kpts</tt><big>(</big><em>wh=(300</em>, <em>300)</em>, <em>wh_stride=(50</em>, <em>50)</em>, <em>scale=20</em>, <em>dtype=&lt;type 'numpy.float32'&gt;</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_grid_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_grid_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a regular grid of keypoints</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats2x2">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVR_mats2x2</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape+rotation matrix (from unit circle to ellipse)
Ignores translation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">invVR_mats</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invVR_mats2x2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0.],</span>
<span class="go">        [ 2.,  3.]],</span>
<span class="go">       [[ 0., -1.],</span>
<span class="go">        [ 3., -2.]]])</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats2x2</span> <span class="o">=</span> <span class="n">get_invVR_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">invVR_mats2x2</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats3x3">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVR_mats3x3</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been rotated, scaled, skewed, and translated. Into
the image keypoint position.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ndarray[float32_t, ndim=3]: invVR_mats</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invVR_mats3x3</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats3x3</span> <span class="o">=</span> <span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invVR_mats3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[  1.,   0.,  10.],</span>
<span class="go">        [  2.,   3.,  20.],</span>
<span class="go">        [  0.,   0.,   1.]],</span>
<span class="go">       [[  0.,  -1.,  30.],</span>
<span class="go">        [  3.,  -2.,  40.],</span>
<span class="go">        [  0.,   0.,   1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_oris">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVR_mats_oris</tt><big>(</big><em>invVR_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts orientation from matrix encoding</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invVR_mats_oris</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_oris</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">np.array([ 5.37,  5.29,  5.9 ,  5.26,  4.74,  5.6 ,  4.9 ], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAMS:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<p>#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=1] _oris
np.ndarray[np.float64_t, ndim=1] _iv12s
np.ndarray[np.float64_t, ndim=1] _iv11s</div></blockquote>
<p class="last">_iv11s = invVR_mats[:, 0, 0]
_iv12s = invVR_mats[:, 0, 1]
_oris = np.arctan2(_iv12s, _iv11s)  # outputs from -TAU/2 to TAU/2
_oris[_oris &lt; 0] = _oris[_oris &lt; 0] + TAU  # map to 0 to TAU (keep coords)
_oris = (-_oris) % TAU
return _oris
#else</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(10000, 2, 2).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0, 1]</span>
<span class="go">        invVR_mats.T[1, 0]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_shape">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVR_mats_shape</tt><big>(</big><em>invVR_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint shape components</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invVR_mats_shape</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_invVR_mats_shape</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">oq9o@yqhtgloy58!</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>TODO
(a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
<a class="reference external" href="http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing">http://stackoverflow.com/questions/14386822/fast-numpy-fancy-indexing</a>
# So, this doesn&#8217;t work
# Try this instead
<a class="reference external" href="http://docs.cython.org/src/userguide/memoryviews.html#memoryviews">http://docs.cython.org/src/userguide/memoryviews.html#memoryviews</a></p>
<dl class="docutils">
<dt>Cyth::</dt>
<dd><p class="first">#CYTH_INLINE
#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=1] _iv11s
np.ndarray[np.float64_t, ndim=1] _iv12s
np.ndarray[np.float64_t, ndim=1] _iv21s
np.ndarray[np.float64_t, ndim=1] _iv22s
#double [:] _iv11s
#double [:] _iv12s
#double [:] _iv21s
#double [:] _iv22s</dd>
</dl>
<p class="last">#endif</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_sqrd_scale">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVR_mats_sqrd_scale</tt><big>(</big><em>invVR_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_sqrd_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_sqrd_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the squared scale of the invVR keyponts</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invVR_mats_sqrd_scale</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">det_arr</span> <span class="o">=</span> <span class="n">get_invVR_mats_sqrd_scale</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">det_arr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([-0.16, -0.09, -0.34,  0.59, -0.2 ,  0.18,  0.06], dtype=np.float64)</span>
</pre></div>
</div>
<p>#CYTH_INLINE
#CYTH_RETURNS np.ndarray[np.float64_t, ndim=1]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<p>#if CYTH
cdef unsigned int nMats = invVR_mats.shape[0]
# Prealloc output
cdef np.ndarray[np.float64_t, ndim=1] out = np.zeros((nMats,), dtype=np.float64)
#cdef size_t ix
cdef Py_ssize_t ix
for ix in range(nMats):</p>
<blockquote>
<div><p># simple determinant: ad - bc
out[ix] = ((invVR_mats[ix, 0, 0] * invVR_mats[ix, 1, 1]) -</p>
<blockquote>
<div>(invVR_mats[ix, 0, 1] * invVR_mats[ix, 1, 0]))</div></blockquote>
</div></blockquote>
<p>return out
#else</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVR_mats_xys">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVR_mats_xys</tt><big>(</big><em>invVR_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVR_mats_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVR_mats_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>extracts locations
extracts xys from matrix encoding</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invVR_mats</strong> (<em>ndarray</em>) &#8211; list of matrices mapping ucircles to ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the xy location</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=2] _xys</dd>
</dl>
<p class="last">#endif</p>
</dd>
<dt>Timeit:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setup</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        import numpy as np</span>
<span class="go">        np.random.seed(0)</span>
<span class="go">        invVR_mats = np.random.rand(1000, 3, 3).astype(np.float64)</span>
<span class="go">        &#39;&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">codeblock</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;&#39;&#39;</span>
<span class="go">        invVR_mats[:, 0:2, 2].T</span>
<span class="go">        invVR_mats.T[2, 0:2]</span>
<span class="go">        invVR_mats.T.take(2, axis=0).take([0, 1], axis=0)</span>
<span class="go">        invVR_mats.T.take(2, axis=0)[0:2]</span>
<span class="go">        &#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">util_dev</span><span class="o">.</span><span class="n">timeit_compare</span><span class="p">(</span><span class="n">stmt_list</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E5</span><span class="p">))</span>
<span class="go">#&gt;&gt;&gt; ut.util_dev.rrr()</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invV_mats</tt><big>(</big><em>kpts</em>, <em>with_trans=False</em>, <em>with_ori=False</em>, <em>ashomog=False</em>, <em>ascontiguous=False</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: DEPRICATE. too many conditionals</p>
<p>packs keypoint shapes into affine invV matrixes
(default is just the 2x2 shape. But translation, orientation,
homogonous, and contiguous flags can be set.)</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_trans</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_ori</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ashomog</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascontiguous</span><span class="o">=</span><span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">innVR_mats</span> <span class="o">=</span> <span class="n">get_invV_mats</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">with_trans</span><span class="p">,</span> <span class="n">with_ori</span><span class="p">,</span> <span class="n">ashomog</span><span class="p">,</span> <span class="n">ascontiguous</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">innVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[  1.,   0.,  10.],</span>
<span class="go">        [  2.,   3.,  20.],</span>
<span class="go">        [  0.,   0.,   1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats2x2">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invV_mats2x2</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keypoint shape (from unit circle to ellipse)
Ignores translation and rotation component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ndarray[float32_t, ndim=3]: invV_mats</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invV_mats2x2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats2x2</span> <span class="o">=</span> <span class="n">get_invV_mats2x2</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_mats2x2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0.],</span>
<span class="go">        [ 2.,  3.]],</span>
<span class="go">       [[ 1.,  0.],</span>
<span class="go">        [ 2.,  3.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_mats3x3">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invV_mats3x3</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_mats3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_mats3x3" title="Permalink to this definition">¶</a></dt>
<dd><p>NEWER FUNCTION</p>
<p>Returns full keypoint transform matricies from a unit circle to an
ellipse that has been scaled, skewed, and translated. Into
the image keypoint position.</p>
<p>DOES NOT INCLUDE ROTATION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ndarray[float32_t, ndim=3]: invVR_mats -  keypoint shape and rotations (possibly translation)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_invV_mats3x3</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">TAU</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_arrs3x3</span> <span class="o">=</span> <span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">invV_arrs3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[ 1.,  0.,  0.],</span>
<span class="go">        [ 2.,  3.,  0.],</span>
<span class="go">        [ 0.,  0.,  1.]],</span>
<span class="go">       [[ 1.,  0.,  0.],</span>
<span class="go">        [ 2.,  3.,  0.],</span>
<span class="go">        [ 0.,  0.,  1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invV_xy_axis_extents">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invV_xy_axis_extents</tt><big>(</big><em>invV_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invV_xy_axis_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invV_xy_axis_extents" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the scales of the major and minor elliptical axis.
from invV_mats (faster)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_invVs">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_invVs</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_invVs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_invVs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint shapes (oriented with the gravity vector)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_dlen_sqrd">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_kpts_dlen_sqrd</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns diagonal length squared of keypoint extent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dlen_sqrd</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_kpts_dlen_sqrd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd</span> <span class="o">=</span> <span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dlen_sqrd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">5681.31</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_image_extent">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_kpts_image_extent</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_image_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_image_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the width and height of keypoint bounding box
This combines xy and shape information
Does not take into account if keypoint extent goes under (0, 0)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">wh_bound</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_kpts_image_extent</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wh_bound</span> <span class="o">=</span> <span class="n">get_kpts_image_extent</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wh_bound</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([ 51.79,  54.77])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_kpts_strs">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_kpts_strs</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_kpts_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_kpts_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_match_spatial_squared_error">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_match_spatial_squared_error</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>fx2_to_fx1</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_match_spatial_squared_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_match_spatial_squared_error" title="Permalink to this definition">¶</a></dt>
<dd><p>transforms img2 to img2 and finds squared spatial error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix mapping image 1 to image 2 space</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; has shape (nMatch, K)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">fx2_to_xyerr_sqrd has shape (nMatch, K)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_match_spatial_squared_error:0
python -m vtool.keypoint &#8211;test-get_match_spatial_squared_error:1</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">129.83</span><span class="p">,</span>   <span class="mf">46.97</span><span class="p">,</span>   <span class="mf">15.84</span><span class="p">,</span>    <span class="mf">4.66</span><span class="p">,</span>    <span class="mf">7.24</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">137.88</span><span class="p">,</span>   <span class="mf">49.87</span><span class="p">,</span>   <span class="mf">20.09</span><span class="p">,</span>    <span class="mf">5.76</span><span class="p">,</span>    <span class="mf">6.2</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">115.95</span><span class="p">,</span>   <span class="mf">53.13</span><span class="p">,</span>   <span class="mf">12.96</span><span class="p">,</span>    <span class="mf">1.73</span><span class="p">,</span>    <span class="mf">8.77</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">324.88</span><span class="p">,</span>  <span class="mf">172.58</span><span class="p">,</span>  <span class="mf">127.69</span><span class="p">,</span>   <span class="mf">41.29</span><span class="p">,</span>   <span class="mf">50.5</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">285.44</span><span class="p">,</span>  <span class="mf">254.61</span><span class="p">,</span>  <span class="mf">136.06</span><span class="p">,</span>   <span class="o">-</span><span class="mf">4.77</span><span class="p">,</span>   <span class="mf">76.69</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">367.72</span><span class="p">,</span>  <span class="mf">140.81</span><span class="p">,</span>  <span class="mf">172.13</span><span class="p">,</span>   <span class="mf">12.99</span><span class="p">,</span>   <span class="mf">96.15</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">318.93</span><span class="p">,</span>   <span class="mf">11.98</span><span class="p">,</span>   <span class="mf">12.11</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>    <span class="mf">8.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">509.47</span><span class="p">,</span>   <span class="mf">12.53</span><span class="p">,</span>   <span class="mf">22.4</span> <span class="p">,</span>    <span class="mf">1.31</span><span class="p">,</span>    <span class="mf">5.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">514.03</span><span class="p">,</span>   <span class="mf">13.04</span><span class="p">,</span>   <span class="mf">19.25</span><span class="p">,</span>    <span class="mf">1.74</span><span class="p">,</span>    <span class="mf">4.72</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">490.19</span><span class="p">,</span>  <span class="mf">185.49</span><span class="p">,</span>   <span class="mf">95.67</span><span class="p">,</span>   <span class="o">-</span><span class="mf">4.84</span><span class="p">,</span>   <span class="mf">88.23</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">316.97</span><span class="p">,</span>  <span class="mf">206.07</span><span class="p">,</span>   <span class="mf">90.87</span><span class="p">,</span>    <span class="mf">0.07</span><span class="p">,</span>   <span class="mf">80.45</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">366.07</span><span class="p">,</span>  <span class="mf">140.05</span><span class="p">,</span>  <span class="mf">161.27</span><span class="p">,</span>  <span class="o">-</span><span class="mf">47.01</span><span class="p">,</span>   <span class="mf">85.62</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">0.70098</span><span class="p">,</span>   <span class="mf">0.12273</span><span class="p">,</span>   <span class="mf">5.18734</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span>  <span class="mf">0.12444</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.63474</span><span class="p">,</span>  <span class="mf">14.13995</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span>  <span class="mf">0.00004</span><span class="p">,</span>   <span class="mf">0.00025</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.64873</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  82.848,  186.238,  183.979,  192.639],</span>
<span class="go">          [ 382.988,  374.356,  122.179,  289.16 ],</span>
<span class="go">          [ 387.563,  378.93 ,  126.389,  292.391],</span>
<span class="go">          [ 419.246,  176.668,  400.175,  167.411],</span>
<span class="go">          [ 174.269,  274.289,  281.03 ,   33.521],</span>
<span class="go">          [  54.083,  269.645,   94.711,  277.706]], dtype=np.float64)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">,</span>   <span class="mf">15.84</span><span class="p">,</span>    <span class="mf">4.66</span><span class="p">,</span>    <span class="mf">7.24</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">9.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">20.09</span><span class="p">,</span>    <span class="mf">5.76</span><span class="p">,</span>    <span class="mf">6.2</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.96</span><span class="p">,</span>    <span class="mf">1.73</span><span class="p">,</span>    <span class="mf">8.77</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.11</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>    <span class="mf">8.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">5.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">22.4</span> <span class="p">,</span>    <span class="mf">1.31</span><span class="p">,</span>    <span class="mf">5.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">19.25</span><span class="p">,</span>    <span class="mf">1.74</span><span class="p">,</span>    <span class="mf">4.72</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr_sqrd</span> <span class="o">=</span> <span class="n">get_match_spatial_squared_error</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_xyerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fx2_to_xyerr_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">fx2_to_xyerr</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[  0.   ,  16.125,  10.44 ],</span>
<span class="go">          [  7.616,  13.153,   3.   ],</span>
<span class="go">          [  4.   ,  12.166,   6.708]], dtype=np.float64)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_ori_mats">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_ori_mats</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_ori_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns keypoint orientation matrixes</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_ori_strs">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_ori_strs</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_ori_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_ori_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_oris">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_oris</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_oris"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_oris" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts keypoint orientations for kpts array</p>
<p>(in isotropic guassian space relative to the gravity vector)
(in simpler words: the orientation is is taken from keypoints warped to the unit circle)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray</em>) &#8211; (N x 6) [x, y, a, c, d, theta]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(ndarray) theta</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_scales">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_scales</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets average scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_shape_strs">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_shape_strs</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_shape_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_shape_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_sqrd_scales">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_sqrd_scales</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_sqrd_scales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_sqrd_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average squared scale (does not take into account elliptical shape</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_transforms_from_patch_image_kpts">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_transforms_from_patch_image_kpts</tt><big>(</big><em>kpts</em>, <em>patch_shape</em>, <em>scale_factor=1.0</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_transforms_from_patch_image_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_transforms_from_patch_image_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some patch (like a gaussian patch) transforms a patch to be overlayed
on top of each keypoint in the image (adjusted for a scale factor)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a list of 3x3 tranformation matricies for each keypoint</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">M_list</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_transforms_from_patch_image_kpts</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_list</span> <span class="o">=</span> <span class="n">get_transforms_from_patch_image_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">patch_shape</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_repr</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[[  1.49,   0.  ,  15.53],</span>
<span class="go">        [ -1.46,   6.9 ,   8.68],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  0.67,   0.  ,  26.98],</span>
<span class="go">        [ -1.46,   6.9 ,   8.68],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  3.49,   0.  ,  19.53],</span>
<span class="go">        [  3.43,   3.01,  10.67],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  3.82,   0.  ,  19.55],</span>
<span class="go">        [  5.04,   4.03,   1.8 ],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]],</span>
<span class="go">       [[  4.59,   0.  ,  18.24],</span>
<span class="go">        [  0.97,   3.35,  18.02],</span>
<span class="go">        [  0.  ,   0.  ,   1.  ]]])</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.coverage_kpts</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_aff2Ds</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">ori</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kpts</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_3x3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_3x3</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invV_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">invVR_aff2Ds</span><span class="p">)</span> <span class="o">==</span> <span class="n">invVR_3x3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">invVR_aff2Ds</span><span class="p">)</span> <span class="o">==</span> <span class="n">invV_3x3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Timeit:</dt>
<dd>%timeit [np.array(((a, 0, x), (c, d, y), (0, 0, 1),)) for (x, y, a, c, d, ori) in kpts]
%timeit vt.get_invVR_mats3x3(kpts)
%timeit vt.get_invV_mats3x3(kpts) &lt;- THIS IS ACTUALLY MUCH FASTER</dd>
<dt>Ignore::</dt>
<dd>%pylab qt4
import plottool as pt
pt.imshow(chip)
pt.draw_kpts2(kpts)
pt.update()</dd>
<dt>Timeit:</dt>
<dd><p class="first">sa_list1 = np.array([S2.dot(A) for A in invVR_aff2Ds])
sa_list2 = matrix_multiply(S2, invVR_aff2Ds)
assert np.all(sa_list1 == sa_list2)
%timeit np.array([S2.dot(A) for A in invVR_aff2Ds])
%timeit matrix_multiply(S2, invVR_aff2Ds)</p>
<p class="last">from six.moves import reduce
perspective_list2 = np.array([S2.dot(A).dot(S1).dot(T1) for A in invVR_aff2Ds])
perspective_list = reduce(matrix_multiply, (S2, invVR_aff2Ds, S1, T1))
assert np.all(perspective_list == perspective_list2)
%timeit np.array([S2.dot(A).dot(S1).dot(T1) for A in invVR_aff2Ds])
%timeit reduce(matrix_multiply, (S2, invVR_aff2Ds, S1, T1))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xy_axis_extents">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_xy_axis_extents</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_axis_extents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xy_axis_extents" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>gets the scales of the major and minor elliptical axis</dt>
<dd>from kpts (slower due to conversion to invV_mats)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2][ndims=2]</em>) &#8211; keypoints</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">xyexnts</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-get_xy_axis_extents</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyexnts</span> <span class="o">=</span> <span class="n">get_xy_axis_extents</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">xyexnts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  6.2212909   24.91645859]</span>
<span class="go"> [  2.79504602  24.7306281 ]</span>
<span class="go"> [ 16.43837149  19.39813418]</span>
<span class="go"> [ 18.23215582  25.76692184]</span>
<span class="go"> [ 19.78704902  16.82756301]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xy_strs">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_xy_strs</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_xy_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xy_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>strings debugging and output</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.get_xys">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">get_xys</tt><big>(</big><em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#get_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.get_xys" title="Permalink to this definition">¶</a></dt>
<dd><p>Keypoint locations in chip space</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.invert_invV_mats">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">invert_invV_mats</tt><big>(</big><em>invV_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#invert_invV_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.invert_invV_mats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>invV_mats</strong> (<em>ndarray[float32_t, ndim=3]</em>) &#8211; keypoint shapes (possibly translation)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ndarray[float32_t, ndim=3]: V_mats</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-invert_invV_mats</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invV_mats</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_invVR_mats3x3</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_mats</span> <span class="o">=</span> <span class="n">invert_invV_mats</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">matrix_multiply</span><span class="p">(</span><span class="n">invV_mats</span><span class="p">,</span> <span class="n">V_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># This should give us identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kp_cpp_infostr">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">kp_cpp_infostr</tt><big>(</big><em>kp</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#kp_cpp_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kp_cpp_infostr" title="Permalink to this definition">¶</a></dt>
<dd><p>mirrors c++ debug code</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kpts_docrepr">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">kpts_docrepr</tt><big>(</big><em>arr</em>, <em>name='arr'</em>, <em>indent=True</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_docrepr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kpts_docrepr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-kpts_docrepr</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">kpts_docrepr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.kpts_repr">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">kpts_repr</tt><big>(</big><em>arr</em>, <em>precision=2</em>, <em>suppress_small=True</em>, <em>linebreak=False</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#kpts_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.kpts_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.offset_kpts">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">offset_kpts</tt><big>(</big><em>kpts</em>, <em>offset=(0.0</em>, <em>0.0)</em>, <em>scale_factor=1.0</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#offset_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.offset_kpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.keypoint.rectify_invV_mats_are_up">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">rectify_invV_mats_are_up</tt><big>(</big><em>invVR_mats</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#rectify_invV_mats_are_up"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.rectify_invV_mats_are_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful if invVR_mats is no longer lower triangular
rotates affine shape matrixes into downward (lower triangular) position</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invVR_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">rectify_invV_mats_are_up</span><span class="p">(</span><span class="n">invVR_mats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">2wir&amp;6ybcga0bpvz</span>
</pre></div>
</div>
<p>#if CYTH
# TODO: Template this for [float64_t, float32_t]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=3] invVR_mats</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=3] invV_mats
np.ndarray[np.float64_t, ndim=1] _oris
np.ndarray[np.float64_t, ndim=1] _a
np.ndarray[np.float64_t, ndim=1] _b
np.ndarray[np.float64_t, ndim=1] _c
np.ndarray[np.float64_t, ndim=1] _d
np.ndarray[np.float64_t, ndim=1] <a href="#id15"><span class="problematic" id="id16">det_</span></a>
np.ndarray[np.float64_t, ndim=1] b2a2
np.ndarray[np.float64_t, ndim=1] iv11
np.ndarray[np.float64_t, ndim=1] iv21
np.ndarray[np.float64_t, ndim=1] iv22</dd>
</dl>
<p>#endif</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">transform_kpts</tt><big>(</big><em>kpts</em>, <em>M</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>returns M.dot(kpts_mat)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>M</strong> (<em>ndarray</em>) &#8211; transform matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(_iv11s, _iv12s, _iv21s, _iv22s)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-transform_kpts</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">transform_kpts</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 200.   ,  450.   ,   52.166,    1.056,  241.499,   -0.   ],</span>
<span class="go">          [ 290.   ,  540.   ,   23.551,  -27.559,  241.499,   -0.   ],</span>
<span class="go">          [ 300.   ,  600.   ,  122.166,  242.357,  105.287,   -0.   ],</span>
<span class="go">          [ 310.   ,  600.   ,  133.556,  309.899,  141.041,   -0.   ],</span>
<span class="go">          [ 320.   ,  630.   ,  160.527,  194.6  ,  117.354,   -0.   ]], dtype=np.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts_to_imgspace">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">transform_kpts_to_imgspace</tt><big>(</big><em>kpts</em>, <em>bbox</em>, <em>bbox_theta</em>, <em>chipsz</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_to_imgspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_to_imgspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms keypoints so they are plotable in imagespace
kpts   - xyacdo keypoints
bbox   - chip bounding boxes in image space
theta  - chip rotationsinvC
chipsz - chip extent (in keypoint / chip space)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.keypoint.transform_kpts_xys">
<tt class="descclassname">vtool.keypoint.</tt><tt class="descname">transform_kpts_xys</tt><big>(</big><em>H</em>, <em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/keypoint.html#transform_kpts_xys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.keypoint.transform_kpts_xys" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xy_t</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.keypoint &#8211;test-transform_kpts_xys</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.keypoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">3.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_t</span> <span class="o">=</span> <span class="n">transform_kpts_xys</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">xy_t</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 2.979,  2.982,  2.984,  2.984,  2.985],</span>
<span class="go">          [ 2.574,  2.482,  2.516,  2.5  ,  2.508]], dtype=np.float64)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore::</dt>
<dd>%pylab qt4
import plottool as pt
pt.imshow(chip)
pt.draw_kpts2(kpts)
pt.update()</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.linalg">
<span id="vtool-linalg-module"></span><h2>vtool.linalg module<a class="headerlink" href="#module-vtool.linalg" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>TODO: Look at this file</dt>
<dd><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/code/transformations.py.html">http://www.lfd.uci.edu/~gohlke/code/transformations.py.html</a></dd>
</dl>
<dl class="function">
<dt id="vtool.linalg.OLD_pdf_norm2d">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">OLD_pdf_norm2d</tt><big>(</big><em>x_</em>, <em>y_</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#OLD_pdf_norm2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.OLD_pdf_norm2d" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATED</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.add_homogenous_coordinate">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">add_homogenous_coordinate</tt><big>(</big><em>_xys</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#add_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.add_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.det_ltri">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">det_ltri</tt><big>(</big><em>ltri</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#det_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.det_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular determinant</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.dot_ltri">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">dot_ltri</tt><big>(</big><em>ltri1</em>, <em>ltri2</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#dot_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.dot_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular dot product</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.gauss2d_pdf">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">gauss2d_pdf</tt><big>(</big><em>x_</em>, <em>y_</em>, <em>sigma=None</em>, <em>mu=None</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#gauss2d_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.gauss2d_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Input: x and y coordinate of a 2D gaussian</dt>
<dd>sigma, mu - covariance and mean vector</dd>
</dl>
<p>Output: The probability density at that point</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.homogonize">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">homogonize</tt><big>(</big><em>_xyzs</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#homogonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.homogonize" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE in favor of remove_homogenous_coordinate</p>
<p>normalizes 3d homogonous coordinates into 2d coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>_xyzs</strong> (<em>ndarray</em>) &#8211; of shape (3, N)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">_xys of shape (2, N)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg &#8211;test-homogonize</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xyzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">140.</span><span class="p">,</span>  <span class="mf">167.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">185.</span><span class="p">,</span>  <span class="mf">194.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span> <span class="mf">121.</span><span class="p">,</span>  <span class="mf">139.</span><span class="p">,</span>  <span class="mf">156.</span><span class="p">,</span>  <span class="mf">155.</span><span class="p">,</span>  <span class="mf">163.</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">47.</span><span class="p">,</span>   <span class="mf">56.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">62.</span><span class="p">,</span>   <span class="mf">65.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_xys</span> <span class="o">=</span> <span class="n">homogonize</span><span class="p">(</span><span class="n">_xyzs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">_xys</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[ 2.979,  2.982,  2.984,  2.984,  2.985],</span>
<span class="go">       [ 2.574,  2.482,  2.516,  2.5  ,  2.508]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.inv_ltri">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">inv_ltri</tt><big>(</big><em>ltri</em>, <em>det</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#inv_ltri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.inv_ltri" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower triangular inverse</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.normalize_rows">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">normalize_rows</tt><big>(</big><em>arr1</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#normalize_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>from vtool.linalg import *</p>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.normalize_vecs2d_inplace">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">normalize_vecs2d_inplace</tt><big>(</big><em>vecs</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#normalize_vecs2d_inplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.normalize_vecs2d_inplace" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vecs</strong> (<em>ndarray</em>) &#8211; row vectors to normalize in place</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg &#8211;test-normalize_vecs2d_inplace</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalize_vecs2d_inplace</span><span class="p">(</span><span class="n">vecs1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vecs1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#vecs2 = np.random.rand(10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#normalize_vecs2d_inplace(vecs2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#res2 = str(vecs2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.remove_homogenous_coordinate">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">remove_homogenous_coordinate</tt><big>(</big><em>_xyzs</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#remove_homogenous_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.remove_homogenous_coordinate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_around_bbox_mat3x3">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">rotation_around_bbox_mat3x3</tt><big>(</big><em>theta</em>, <em>bbox</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_bbox_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_around_bbox_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_around_mat3x3">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">rotation_around_mat3x3</tt><big>(</big><em>theta</em>, <em>x</em>, <em>y</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#rotation_around_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_around_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_mat2x2">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">rotation_mat2x2</tt><big>(</big><em>theta</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat2x2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_mat2x2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.rotation_mat3x3">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">rotation_mat3x3</tt><big>(</big><em>radians</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#rotation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.rotation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.scale_mat3x3">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">scale_mat3x3</tt><big>(</big><em>sx</em>, <em>sy=None</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#scale_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.scale_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.scaleedoffset_mat3x3">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">scaleedoffset_mat3x3</tt><big>(</big><em>offset</em>, <em>scale_factor</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#scaleedoffset_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.scaleedoffset_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.svd">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">svd</tt><big>(</big><em>M</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.svd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<em>ndarray</em>) &#8211; must be either float32 or float64</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(U, s, Vt)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.linalg &#8211;test-svd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.5812</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.615</span><span class="p">,</span> <span class="mf">17.1295</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span><span class="p">)</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeit::</dt>
<dd>flags = cv2.SVD_FULL_UV
%timeit cv2.SVDecomp(M, flags=flags)
%timeit npl.svd(M)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.linalg.transform_points_with_homography">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">transform_points_with_homography</tt><big>(</big><em>H</em>, <em>_xys</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#transform_points_with_homography"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.transform_points_with_homography" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.translation_mat3x3">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">translation_mat3x3</tt><big>(</big><em>x</em>, <em>y</em>, <em>dtype=&lt;type 'numpy.float64'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#translation_mat3x3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.translation_mat3x3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.linalg.whiten_xy_points">
<tt class="descclassname">vtool.linalg.</tt><tt class="descname">whiten_xy_points</tt><big>(</big><em>xy_m</em><big>)</big><a class="reference internal" href="_modules/vtool/linalg.html#whiten_xy_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.linalg.whiten_xy_points" title="Permalink to this definition">¶</a></dt>
<dd><p>whitens points to mean=0, stddev=1 and returns transformation</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.linalg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.tests</span> <span class="kn">import</span> <span class="n">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_m</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">whiten_xy_points</span><span class="p">(</span><span class="n">xy_m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_norm</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">wg%mpai0hxvil4p2</span>
</pre></div>
</div>
<p>#CYTH_INLINE
#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] xy_m
np.ndarray[np.float64_t, ndim=1] mu_xy
np.ndarray[np.float64_t, ndim=1] std_xy
np.ndarray[np.float64_t, ndim=2] T
np.float64_t tx, ty, sx, sy
np.ndarray[np.float64_t, ndim=2] xy_norm</div></blockquote>
<p>#endif</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.matching">
<span id="vtool-matching-module"></span><h2>vtool.matching module<a class="headerlink" href="#module-vtool.matching" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.matching.assign_spatially_constrained_matches">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">assign_spatially_constrained_matches</tt><big>(</big><em>chip2_dlen_sqrd</em>, <em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>fx2_to_fx1</em>, <em>fx2_to_dist</em>, <em>match_xy_thresh</em>, <em>norm_xy_bounds=(0.0</em>, <em>1.0)</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#assign_spatially_constrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.assign_spatially_constrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>kpts2</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
<li><strong>H</strong> (<em>ndarray[float64_t, ndim=2]</em>) &#8211; homography/perspective matrix that maps image1 space into image2 space</li>
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; image2s nearest feature indices in image1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">assigntup(
fx2_match, - matching feature indices in image 2
fx1_match, - matching feature indices in image 1
fx1_norm,  - normmalizing indices in image 1
match_dist, - descriptor distances between fx2_match and fx1_match
norm_dist, - descriptor distances between fx2_match and fx1_norm
)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching &#8211;test-assign_spatially_constrained_matches</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">4.</span><span class="p">,</span>   <span class="mf">15.84</span><span class="p">,</span>    <span class="mf">4.66</span><span class="p">,</span>    <span class="mf">7.24</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">9.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">,</span>   <span class="mf">20.09</span><span class="p">,</span>    <span class="mf">5.76</span><span class="p">,</span>    <span class="mf">6.2</span> <span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.96</span><span class="p">,</span>    <span class="mf">1.73</span><span class="p">,</span>    <span class="mf">8.77</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">2.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">12.11</span><span class="p">,</span>    <span class="mf">0.38</span><span class="p">,</span>    <span class="mf">8.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">5.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">22.4</span> <span class="p">,</span>    <span class="mf">1.31</span><span class="p">,</span>    <span class="mf">5.04</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span>  <span class="mf">6.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">19.25</span><span class="p">,</span>    <span class="mf">1.74</span><span class="p">,</span>    <span class="mf">4.72</span><span class="p">,</span>    <span class="mf">0.</span>  <span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_xy_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">37</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip2_dlen_sqrd</span> <span class="o">=</span> <span class="mi">1400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_xy_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">40</span><span class="p">,</span> <span class="o">.</span><span class="mi">80</span><span class="p">,</span> <span class="o">.</span><span class="mi">85</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span><span class="o">.</span><span class="mi">30</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">60</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span><span class="o">.</span><span class="mi">80</span><span class="p">,</span> <span class="o">.</span><span class="mi">90</span><span class="p">,</span> <span class="o">.</span><span class="mi">91</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_spatially_constrained_matches</span><span class="p">(</span><span class="n">chip2_dlen_sqrd</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">,</span> <span class="n">match_xy_thresh</span><span class="p">,</span> <span class="n">norm_xy_bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_match</span><span class="p">,</span> <span class="n">fx1_match</span><span class="p">,</span> <span class="n">fx1_norm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([0, 1, 2], dtype=np.int32),</span>
<span class="go">    np.array([2, 0, 2], dtype=np.int32),</span>
<span class="go">    np.array([1, 1, 0], dtype=np.int32),</span>
<span class="go">    np.array([ 0.4,  0.3,  0.8], dtype=np.float32),</span>
<span class="go">    np.array([ 0.8,  0.5,  0.9], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Example:</p>
<p>assigns spatially constrained vsone match using results of nearest
neighbors.</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.assign_unconstrained_matches">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">assign_unconstrained_matches</tt><big>(</big><em>fx2_to_fx1</em>, <em>fx2_to_dist</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#assign_unconstrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.assign_unconstrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>assigns vsone matches using results of nearest neighbors.</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_fx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">77</span><span class="p">,</span>   <span class="mi">971</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">116</span><span class="p">,</span>   <span class="mi">120</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">122</span><span class="p">,</span>   <span class="mi">128</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span><span class="mi">1075</span><span class="p">,</span>  <span class="mi">692</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span> <span class="mi">530</span><span class="p">,</span>   <span class="mi">45</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="p">[</span>  <span class="mi">45</span><span class="p">,</span>  <span class="mi">530</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_to_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.05907059</span><span class="p">,</span>  <span class="mf">0.2389698</span> <span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.02129555</span><span class="p">,</span>  <span class="mf">0.24083519</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.03901863</span><span class="p">,</span>  <span class="mf">0.24756241</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.14974403</span><span class="p">,</span>  <span class="mf">0.15112305</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.22693443</span><span class="p">,</span>  <span class="mf">0.24428177</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="p">[</span> <span class="mf">0.2155838</span> <span class="p">,</span>  <span class="mf">0.23641014</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assigntup</span> <span class="o">=</span> <span class="n">assign_unconstrained_matches</span><span class="p">(</span><span class="n">fx2_to_fx1</span><span class="p">,</span> <span class="n">fx2_to_dist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_match</span><span class="p">,</span> <span class="n">fx1_match</span><span class="p">,</span> <span class="n">fx1_norm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_dist</span> <span class="o">=</span> <span class="n">assigntup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">assigntup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([0, 1, 2, 3, 4, 5], dtype=np.int32),</span>
<span class="go">    np.array([  77,  116,  122, 1075,  530,   45], dtype=np.int32),</span>
<span class="go">    np.array([971, 120, 128, 692,  45, 530], dtype=np.int32),</span>
<span class="go">    np.array([ 0.059,  0.021,  0.039,  0.15 ,  0.227,  0.216], dtype=np.float64),</span>
<span class="go">    np.array([ 0.239,  0.241,  0.248,  0.151,  0.244,  0.236], dtype=np.float64),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.ensure_fsv_list">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">ensure_fsv_list</tt><big>(</big><em>fsv_list</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#ensure_fsv_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ensure_fsv_list" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure fs is at least Nx1</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.marge_matches">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">marge_matches</tt><big>(</big><em>fm_A</em>, <em>fm_B</em>, <em>fsv_A</em>, <em>fsv_B</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#marge_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.marge_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>combines feature matches from two matching algorithms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fm_A</strong> (<em>ndarray[ndims=2]</em>) &#8211; type A feature matches</li>
<li><strong>fm_B</strong> (<em>ndarray[ndims=2]</em>) &#8211; type B feature matches</li>
<li><strong>fsv_A</strong> (<em>ndarray[ndims=2]</em>) &#8211; type A feature scores</li>
<li><strong>fsv_B</strong> (<em>ndarray[ndims=2]</em>) &#8211; type B feature scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fm_both, fs_both)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching &#8211;test-marge_matches</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_A</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">29</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">111</span><span class="p">],</span> <span class="p">[</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">125</span><span class="p">],</span> <span class="p">[</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">125</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_B</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">125</span><span class="p">],</span> <span class="p">[</span> <span class="mi">30</span><span class="p">,</span>  <span class="mi">32</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span>  <span class="o">.</span><span class="mi">2</span><span class="p">],</span>  <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">7</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fm_both</span><span class="p">,</span> <span class="n">fs_both</span><span class="p">)</span> <span class="o">=</span> <span class="n">marge_matches</span><span class="p">(</span><span class="n">fm_A</span><span class="p">,</span> <span class="n">fm_B</span><span class="p">,</span> <span class="n">fsv_A</span><span class="p">,</span> <span class="n">fsv_B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">((</span><span class="n">fm_both</span><span class="p">,</span> <span class="n">fs_both</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[ 15,  17],</span>
<span class="go">              [ 25, 125],</span>
<span class="go">              [ 54,  29],</span>
<span class="go">              [ 95, 111],</span>
<span class="go">              [ 97, 125],</span>
<span class="go">              [ 11,  21],</span>
<span class="go">              [ 30,  32]], dtype=np.int32),</span>
<span class="go">    np.array([[ 0.1 ,  0.2 ,  0.3 ],</span>
<span class="go">              [ 0.1 ,  0.1 ,  0.5 ],</span>
<span class="go">              [ 1.  ,  0.9 ,   nan],</span>
<span class="go">              [ 0.8 ,  0.2 ,   nan],</span>
<span class="go">              [ 1.  ,  0.9 ,   nan],</span>
<span class="go">              [  nan,   nan,  0.12],</span>
<span class="go">              [  nan,   nan,  0.7 ]], dtype=np.float64),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.normalized_nearest_neighbors">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">normalized_nearest_neighbors</tt><big>(</big><em>flann</em>, <em>vecs2</em>, <em>K</em>, <em>checks=800</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#normalized_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.normalized_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>uses flann index to return nearest neighbors with distances normalized
between 0 and 1 using sifts uint8 trick</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.ratio_test">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">ratio_test</tt><big>(</big><em>fx2_match</em>, <em>fx1_match</em>, <em>fx1_norm</em>, <em>match_dist</em>, <em>norm_dist</em>, <em>ratio_thresh=0.625</em>, <em>fm_dtype=&lt;type 'numpy.int32'&gt;</em>, <em>fs_dtype=&lt;type 'numpy.float32'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#ratio_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.ratio_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowes ratio test for one-vs-one feature matches.</p>
<p>Assumes reverse matches (image2 to image1) and returns (image1 to image2)
matches. Generalized to accept any match or normalizer not just K=1 and K=2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fx2_to_fx1</strong> (<em>ndarray</em>) &#8211; nearest neighbor indices (from flann)</li>
<li><strong>fx2_to_dist</strong> (<em>ndarray</em>) &#8211; nearest neighbor distances (from flann)</li>
<li><strong>match_col</strong> (<em>int or ndarray</em>) &#8211; column of matching indices</li>
<li><strong>norm_col</strong> (<em>int or ndarray</em>) &#8211; column of normalizng indices</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(fm_RAT, fs_RAT, fm_norm_RAT)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.matching &#8211;test-ratio_test</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx2_match</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_match</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">77</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">1075</span><span class="p">,</span> <span class="mi">530</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fx1_norm</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">971</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">692</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">530</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.059</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">,</span> <span class="mf">0.039</span><span class="p">,</span> <span class="mf">0.15</span> <span class="p">,</span> <span class="mf">0.227</span><span class="p">,</span> <span class="mf">0.216</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_dist</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.239</span><span class="p">,</span> <span class="mf">0.241</span><span class="p">,</span> <span class="mf">0.248</span><span class="p">,</span> <span class="mf">0.151</span><span class="p">,</span> <span class="mf">0.244</span><span class="p">,</span> <span class="mf">0.236</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_tup</span> <span class="o">=</span> <span class="n">ratio_test</span><span class="p">(</span><span class="n">fx2_match</span><span class="p">,</span> <span class="n">fx1_match</span><span class="p">,</span> <span class="n">fx1_norm</span><span class="p">,</span> <span class="n">match_dist</span><span class="p">,</span> <span class="n">norm_dist</span><span class="p">,</span> <span class="n">ratio_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fm_RAT</span><span class="p">,</span> <span class="n">fs_RAT</span><span class="p">,</span> <span class="n">fm_norm_RAT</span><span class="p">)</span> <span class="o">=</span> <span class="n">ratio_tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">ratio_tup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[ 77,   0],</span>
<span class="go">              [116,   1],</span>
<span class="go">              [122,   2]], dtype=np.int32),</span>
<span class="go">    np.array([ 0.753,  0.913,  0.843], dtype=np.float32),</span>
<span class="go">    np.array([[971,   0],</span>
<span class="go">              [120,   1],</span>
<span class="go">              [128,   2]], dtype=np.int32),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.spatially_constrained_ratio_match">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">spatially_constrained_ratio_match</tt><big>(</big><em>flann</em>, <em>vecs2</em>, <em>kpts1</em>, <em>kpts2</em>, <em>H</em>, <em>chip2_dlen_sqrd</em>, <em>match_xy_thresh=1.0</em>, <em>scr_ratio_thresh=0.625</em>, <em>scr_K=7</em>, <em>norm_xy_bounds=(0.0</em>, <em>1.0)</em>, <em>fm_dtype=&lt;type 'numpy.int32'&gt;</em>, <em>fs_dtype=&lt;type 'numpy.float32'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#spatially_constrained_ratio_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.spatially_constrained_ratio_match" title="Permalink to this definition">¶</a></dt>
<dd><p>performs nearest neighbors, then assigns based on spatial constraints, the
last step performs a ratio test.</p>
<p>H - a homography H that maps image1 space into image2 space
H should map from query to database chip (1 to 2)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.matching.unconstrained_ratio_match">
<tt class="descclassname">vtool.matching.</tt><tt class="descname">unconstrained_ratio_match</tt><big>(</big><em>flann</em>, <em>vecs2</em>, <em>unc_ratio_thresh=0.625</em>, <em>fm_dtype=&lt;type 'numpy.int32'&gt;</em>, <em>fs_dtype=&lt;type 'numpy.float32'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/matching.html#unconstrained_ratio_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.matching.unconstrained_ratio_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowes ratio matching</p>
<p>fs_dtype = kwargs.get(&#8216;fs_dtype&#8217;, np.float32)
fm_dtype = kwargs.get(&#8216;fm_dtype&#8217;, np.int32)</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.math">
<span id="vtool-math-module"></span><h2>vtool.math module<a class="headerlink" href="#module-vtool.math" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.math.ensure_monotone_decreasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">ensure_monotone_decreasing</tt><big>(</big><em>arr_</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_decreasing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.math.ensure_monotone_increasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">ensure_monotone_increasing</tt><big>(</big><em>arr_</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_increasing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.math.ensure_monotone_strictly_increasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">ensure_monotone_strictly_increasing</tt><big>(</big><em>arr_</em>, <em>zerohack=False</em>, <em>onehack=False</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#ensure_monotone_strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.ensure_monotone_strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks up streaks of equal values by interpolating between the next lowest and next highest value</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zerohack</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">onehack</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">ensure_monotone_strictly_increasing</span><span class="p">(</span><span class="n">arr_</span><span class="p">,</span> <span class="n">zerohack</span><span class="p">,</span> <span class="n">onehack</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strictly_increasing</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="s">&#39;ensure strict monotonic failed&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.gauss_func1d">
<tt class="descclassname">vtool.math.</tt><tt class="descname">gauss_func1d</tt><big>(</big><em>x</em>, <em>mu=0.0</em>, <em>sigma=1.0</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#gauss_func1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.gauss_func1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.math &#8211;test-gauss_func1d</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.gauss_func1d_unnormalized">
<tt class="descclassname">vtool.math.</tt><tt class="descname">gauss_func1d_unnormalized</tt><big>(</big><em>x</em>, <em>sigma=1.0</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#gauss_func1d_unnormalized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.gauss_func1d_unnormalized" title="Permalink to this definition">¶</a></dt>
<dd><p>faster version of gauss_func1d with no normalization. So the maximum point
will have a value of 1.0</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.math</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussval</span> <span class="o">=</span> <span class="n">gauss_func1d_unnormalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gaussval</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">gaussval</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([ 0.05,  0.24,  0.35,  0.4 ,  0.35,  0.24,  0.05])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.math.group_consecutive">
<tt class="descclassname">vtool.math.</tt><tt class="descname">group_consecutive</tt><big>(</big><em>arr</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#group_consecutive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.group_consecutive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lists of consecutive values</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy">http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.iceil">
<tt class="descclassname">vtool.math.</tt><tt class="descname">iceil</tt><big>(</big><em>num</em>, <em>dtype=&lt;type 'numpy.int32'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#iceil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.iceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer ceiling. (because numpy doesn&#8217;t seem to have it!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ndarray or scalar:</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.math &#8211;test-iceil</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">utool.util_alg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">utool.util_alg</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">iceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([2, 3], dtype=np.int32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.math.iround">
<tt class="descclassname">vtool.math.</tt><tt class="descname">iround</tt><big>(</big><em>num</em>, <em>dtype=&lt;type 'numpy.int32'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#iround"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.iround" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer round. (because numpy doesn&#8217;t seem to have it!)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.non_decreasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">non_decreasing</tt><big>(</big><em>L</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#non_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.non_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.non_increasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">non_increasing</tt><big>(</big><em>L</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#non_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.non_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.strictly_decreasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">strictly_decreasing</tt><big>(</big><em>L</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.strictly_increasing">
<tt class="descclassname">vtool.math.</tt><tt class="descname">strictly_increasing</tt><big>(</big><em>L</em><big>)</big><a class="reference internal" href="_modules/vtool/math.html#strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity">http://stackoverflow.com/questions/4983258/python-how-to-check-list-monotonicity</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.math.test_language_modulus">
<tt class="descclassname">vtool.math.</tt><tt class="descname">test_language_modulus</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/math.html#test_language_modulus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.math.test_language_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Modulo_operation">http://en.wikipedia.org/wiki/Modulo_operation</a></p>
</dd></dl>

</div>
<div class="section" id="module-vtool.nearest_neighbors">
<span id="vtool-nearest-neighbors-module"></span><h2>vtool.nearest_neighbors module<a class="headerlink" href="#module-vtool.nearest_neighbors" title="Permalink to this headline">¶</a></h2>
<p>Wrapper around flann (with caching)</p>
<p>python -c &#8220;import vtool, doctest; print(doctest.testmod(vtool.nearest_neighbors))&#8221;</p>
<dl class="function">
<dt id="vtool.nearest_neighbors.ann_flann_once">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">ann_flann_once</tt><big>(</big><em>dpts</em>, <em>qpts</em>, <em>num_neighbors</em>, <em>flann_params={}</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#ann_flann_once"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.ann_flann_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the approximate nearest neighbors of qpts in dpts</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors &#8211;test-ann_flann_once:0</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">list_str</span><span class="p">((</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([[3, 3, 3, 3, 0],</span>
<span class="go">              [2, 0, 1, 4, 4]], dtype=np.int32),</span>
<span class="go">    np.array([[ 1037329.,  1235876.,  1168550.,  1286435.,  1075507.],</span>
<span class="go">              [ 1038324.,  1243690.,  1304896.,  1320598.,  1369036.]], dtype=np.float32),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test upper bounds on sift descriptors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get points on unit sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nDpts</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nQpts</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nDpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">normalize_rows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nQpts</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="s">&#39;not on unit sphere&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># cast to uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_max</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uint8_min</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># hack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">100</span> <span class="c"># 2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">qpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">qpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dpts</span> <span class="o">*</span> <span class="n">uint8_max</span><span class="p">),</span> <span class="n">uint8_min</span><span class="p">,</span> <span class="n">uint8_max</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts8</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span> <span class="o">=</span> <span class="n">ann_flann_once</span><span class="p">(</span><span class="n">dpts8</span><span class="p">,</span> <span class="n">qpts8</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">biggest_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">qx2_dist</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;biggest_dist = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">biggest_dist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Get actual distance by hand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hand_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts8</span> <span class="o">-</span> <span class="n">dpts8</span><span class="p">[</span><span class="n">qx2_dx</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Seems like flann returns squared distance. makes sense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="nb">repr</span><span class="p">((</span><span class="n">qx2_dx</span><span class="p">,</span> <span class="n">qx2_dist</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">8zdwd&amp;q0mu+ez4gp</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Build theoretically maximally distant vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">qpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">dpts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># FIX TO ACTUALLY BE AT THE RIGHT NORM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">dpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qpts</span> <span class="o">=</span> <span class="n">qpts</span> <span class="o">*</span> <span class="p">(</span><span class="mi">512</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">qpts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">qpts</span> <span class="o">-</span> <span class="n">dpts</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Because of norm condition another maximally disant pair of vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># is [1, 0, 0, ... 0] and [0, 1, .. 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verifythat this gives you same dist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">512</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dist2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.assign_to_centroids">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">assign_to_centroids</tt><big>(</big><em>dpts</em>, <em>qpts</em>, <em>num_neighbors=1</em>, <em>flann_params={}</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#assign_to_centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.assign_to_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for akmeans</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.build_flann_index">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">build_flann_index</tt><big>(</big><em>dpts</em>, <em>flann_params</em>, <em>quiet=False</em>, <em>verbose=True</em>, <em>flann=None</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#build_flann_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.build_flann_index" title="Permalink to this definition">¶</a></dt>
<dd><p>build flann with some verbosity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dpts</strong> (<em>ndarray</em>) &#8211; database vectors</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; verbosity flag</li>
<li><strong>flann</strong> (<em>None</em>) &#8211; outvar</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pyflann.FLANN: flann</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors &#8211;test-build_flann_index</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann</span> <span class="o">=</span> <span class="n">build_flann_index</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">flann</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flann</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_augment">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">flann_augment</tt><big>(</big><em>dpts</em>, <em>new_dpts</em>, <em>cache_dir</em>, <em>cfgstr</em>, <em>new_cfgstr</em>, <em>flann_params</em>, <em>use_cache=True</em>, <em>save=True</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_augment" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dpts</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">get_nth_prime</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s">&#39;vtool&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s">&#39;_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cfgstr</span> <span class="o">=</span> <span class="s">&#39;_new_testcfg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.flann_cache">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">flann_cache</tt><big>(</big><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_cache=True</em>, <em>save=True</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=True</em>, <em>quiet=False</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#flann_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.flann_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to load a cached flann index before doing anything
from vtool.nn</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_cfgstr">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">get_flann_cfgstr</tt><big>(</big><em>dpts</em>, <em>flann_params</em>, <em>cfgstr=''</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors &#8211;test-get_flann_cfgstr</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="s">&#39;.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="s">&#39;_FEAT(alg=heshes)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">get_kdtree_flann_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_flann_cfgstr</span><span class="p">(</span><span class="n">dpts</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_FEAT(alg=heshes)_FLANN(4kdtree)_DPTS((10,128)b+oqb%cnuo&amp;oxk7h)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_fpath">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">get_flann_fpath</tt><big>(</big><em>dpts</em>, <em>cache_dir='default'</em>, <em>cfgstr=''</em>, <em>flann_params={}</em>, <em>use_params_hash=True</em>, <em>use_data_hash=True</em>, <em>appname='vtool'</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_fpath" title="Permalink to this definition">¶</a></dt>
<dd><p>returns filepath for flann index</p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_params">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">get_flann_params</tt><big>(</big><em>type_='kdtree'</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a></p>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_flann_params_cfgstr">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">get_flann_params_cfgstr</tt><big>(</big><em>flann_params</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_flann_params_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_flann_params_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.get_kdtree_flann_params">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">get_kdtree_flann_params</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#get_kdtree_flann_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.get_kdtree_flann_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.invertible_stack">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">invertible_stack</tt><big>(</big><em>vecs_list</em>, <em>label_list</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#invertible_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.invertible_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks descriptors into a flat structure and returns inverse mapping from
flat database descriptor indexes (dx) to annotation ids (label) and feature
indexes (fx). Feature indexes are w.r.t. annotation indexes.</p>
<dl class="docutils">
<dt>Output:</dt>
<dd>idx2_desc - flat descriptor stack
idx2_label  - inverted index into annotations
idx2_fx   - inverted index into features</dd>
</dl>
<p># Example with 2D Descriptors</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.nearest_neighbors</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DESC_TYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DESC_TYPE</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_label</span><span class="p">,</span> <span class="n">idx2_fx</span> <span class="o">=</span> <span class="n">invertible_stack</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_vec</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="go">array([[ 0,  0,  5,  2,  1,  5,  2,  1,  3, 42,  2],</span>
<span class="go">       [ 0,  1,  3, 30,  1,  3, 30,  1,  3, 42,  6]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_label</span><span class="p">))</span>
<span class="go">array([1, 1, 2, 2, 2, 4, 4, 4, 5, 5, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">idx2_fx</span><span class="p">))</span>
<span class="go">array([0, 1, 0, 1, 2, 0, 1, 2, 0, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.nearest_neighbors.tune_flann">
<tt class="descclassname">vtool.nearest_neighbors.</tt><tt class="descname">tune_flann</tt><big>(</big><em>dpts</em>, <em>target_precision=0.9</em>, <em>build_weight=0.5</em>, <em>memory_weight=0.0</em>, <em>sample_fraction=0.01</em><big>)</big><a class="reference internal" href="_modules/vtool/nearest_neighbors.html#tune_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.nearest_neighbors.tune_flann" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_pami2014.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf">http://www.cs.ubc.ca/research/flann/uploads/FLANN/flann_manual-1.8.4.pdf</a>
<a class="reference external" href="http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html">http://docs.opencv.org/trunk/modules/flann/doc/flann_fast_approximate_nearest_neighbor_search.html</a></p>
<dl class="docutils">
<dt>Math::</dt>
<dd><p class="first">cost of an algorithm is:</p>
<dl class="last docutils">
<dt>LaTeX:</dt>
<dd><dl class="first last docutils">
<dt>cost = frac</dt>
<dd>{search + build_weight * build }
{ minoverparams( search + build_weight build)} +
memory_weight * memory</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>target_precision</strong> (<em>float</em>) &#8211; number between 0 and 1 representing desired
accuracy. Higher values are more accurate.</li>
<li><strong>build_weight</strong> (<em>float</em>) &#8211; importance weight given to minimizing build time
relative to search time. This number can range from 0 to infinity.
typically because building is a more complex computation you want
to keep the number relatively low, (less than 1) otherwise you&#8217;ll
end up getting a linear search (no build time).</li>
<li><strong>memory_weight</strong> (<em>float</em>) &#8211; Importance of memory relative to total speed.
A value less than 1 gives more importance to the time spent and a
value greater than 1 gives more importance to the memory usage.</li>
<li><strong>sample_fraction</strong> (<em>float</em>) &#8211; number between 0 and 1 representing the
fraction of the input data to use in the optimization. A higher
number uses more data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuned_params</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.nearest_neighbors &#8211;test-tune_flann</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.other">
<span id="vtool-other-module"></span><h2>vtool.other module<a class="headerlink" href="#module-vtool.other" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.other.and_3lists">
<tt class="descclassname">vtool.other.</tt><tt class="descname">and_3lists</tt><big>(</big><em>arr1</em>, <em>arr2</em>, <em>arr3</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#and_3lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.and_3lists" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">and_3lists</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">utool</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
<span class="go">prxuyy1w%ht57jaf</span>
</pre></div>
</div>
<p>#if CYTH
#CYTH_INLINE
cdef:</p>
<blockquote>
<div>np.ndarray arr1
np.ndarray arr2
np.ndarray arr3</div></blockquote>
<p>#endif</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.and_lists">
<tt class="descclassname">vtool.other.</tt><tt class="descname">and_lists</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#and_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.and_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other &#8211;test-and_lists</dd>
<dt>SeeAlso:</dt>
<dd>or_lists</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[False  True False  True]</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ensure equal division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">flags</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">endx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">segments</span> <span class="o">*</span> <span class="p">(</span><span class="n">validx</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="p">(</span><span class="n">segments</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">validx</span><span class="p">[:</span><span class="n">endx</span><span class="p">],</span> <span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">parts</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[243734, 714397, 1204989, 1729375, 2235191]</span>
</pre></div>
</div>
</dd>
</dl>
<p>%timeit reduce(np.logical_and, args)
%timeit np.logical_and.reduce(args)  # wins with more data</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.axiswise_operation2">
<tt class="descclassname">vtool.other.</tt><tt class="descname">axiswise_operation2</tt><big>(</big><em>arr1</em>, <em>arr2</em>, <em>op</em>, <em>axis=0</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#axiswise_operation2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.axiswise_operation2" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply opperation to each row</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">vecs</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>performs an operation between an
(N x A x B ... x Z) array with an
(N x 1) array</p>
<p>%timeit op(arr1, arr2[np.newaxis, :])
%timeit op(arr1, arr2[None, :])
%timeit op(arr1, arr2.reshape(1, arr2.shape[0]))
arr2.shape = (1, arr2.shape[0])
%timeit op(arr1, arr2)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.clipnorm">
<tt class="descclassname">vtool.other.</tt><tt class="descname">clipnorm</tt><big>(</big><em>arr</em>, <em>min_</em>, <em>max_</em>, <em>out=None</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#clipnorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.clipnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>normalizes arr to the range 0 to 1 using <a href="#id17"><span class="problematic" id="id18">min_</span></a> and <a href="#id19"><span class="problematic" id="id20">max_</span></a> as clipping bounds</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.colwise_operation">
<tt class="descclassname">vtool.other.</tt><tt class="descname">colwise_operation</tt><big>(</big><em>arr1</em>, <em>arr2</em>, <em>op</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#colwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.colwise_operation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compare_matrix_columns">
<tt class="descclassname">vtool.other.</tt><tt class="descname">compare_matrix_columns</tt><big>(</big><em>matrix</em>, <em>columns</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_matrix_columns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.compare_matrix_to_rows">
<tt class="descclassname">vtool.other.</tt><tt class="descname">compare_matrix_to_rows</tt><big>(</big><em>row_matrix</em>, <em>row_list</em>, <em>comp_op=&lt;ufunc 'equal'&gt;</em>, <em>logic_op=&lt;ufunc 'logical_or'&gt;</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#compare_matrix_to_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.compare_matrix_to_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares each row in row_list to each row in row matrix using comp_op
Both must have the same number of columns.
Performs logic_op on the results of each individual row</p>
<p>compop   = np.equal
logic_op = np.logical_or</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.componentwise_dot">
<tt class="descclassname">vtool.other.</tt><tt class="descname">componentwise_dot</tt><big>(</big><em>arr1</em>, <em>arr2</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#componentwise_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.componentwise_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">cosangle</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr1</span> <span class="o">=</span> <span class="n">arr1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosangle</span> <span class="o">=</span> <span class="n">componentwise_dot</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cosangle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 1.  1.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.flag_intersection">
<tt class="descclassname">vtool.other.</tt><tt class="descname">flag_intersection</tt><big>(</big><em>X_</em>, <em>C_</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#flag_intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.flag_intersection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_covered_mask">
<tt class="descclassname">vtool.other.</tt><tt class="descname">get_covered_mask</tt><big>(</big><em>covered_array</em>, <em>covering_array</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#get_covered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_covered_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.get_uncovered_mask">
<tt class="descclassname">vtool.other.</tt><tt class="descname">get_uncovered_mask</tt><big>(</big><em>covered_array</em>, <em>covering_array</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#get_uncovered_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.get_uncovered_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">flags</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other &#8211;test-get_uncovered_mask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True False  True False False]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ True  True  True  True  True]</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covering_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">get_uncovered_mask</span><span class="p">(</span><span class="n">covered_array</span><span class="p">,</span> <span class="n">covering_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ True, False,  True],</span>
<span class="go">          [False, False,  True],</span>
<span class="go">          [ True,  True,  True]], dtype=bool)</span>
</pre></div>
</div>
</dd>
<dt>Ignore::</dt>
<dd>covering_array = [1, 2, 3, 4, 5, 6, 7]
%timeit get_uncovered_mask(covered_array, covering_array)
100000 loops, best of 3: 18.6 µs per loop
%timeit get_uncovered_mask2(covered_array, covering_array)
100000 loops, best of 3: 16.9 µs per loop</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.index_partition">
<tt class="descclassname">vtool.other.</tt><tt class="descname">index_partition</tt><big>(</big><em>item_list</em>, <em>part1_items</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#index_partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.index_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>returns two lists. The first are the indecies of items in item_list that
are in part1_items. the second is the indices in item_list that are not
in part1_items. items in part1_items that are not in item_list are
ignored</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;dist&#39;</span><span class="p">,</span> <span class="s">&#39;fg&#39;</span><span class="p">,</span> <span class="s">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_items</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;fg&#39;</span><span class="p">,</span> <span class="s">&#39;distinctiveness&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part1_indexes</span><span class="p">,</span> <span class="n">part2_indexes</span> <span class="o">=</span> <span class="n">index_partition</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">part1_items</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part1_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">part2_indexes</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_flags">
<tt class="descclassname">vtool.other.</tt><tt class="descname">intersect2d_flags</tt><big>(</big><em>A</em>, <em>B</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#intersect2d_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_flags" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(flag_list1, flag_list2)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other &#8211;test-intersect2d_flags</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">609</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">344</span><span class="p">],</span> <span class="p">[</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">690</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">422</span><span class="p">,</span>  <span class="mi">968</span><span class="p">],</span> <span class="p">[</span> <span class="mi">481</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1132</span><span class="p">],</span> <span class="p">[</span> <span class="mi">759</span><span class="p">,</span>  <span class="mi">159</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_flags</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">flag_list1</span><span class="p">,</span> <span class="n">flag_list2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([False, False, False], dtype=bool), array([False, False, False, False, False], dtype=bool))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_indices">
<tt class="descclassname">vtool.other.</tt><tt class="descname">intersect2d_indices</tt><big>(</big><em>A</em>, <em>B</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#intersect2d_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_indices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(ax_list, bx_list)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other &#8211;test-intersect2d_indices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">542</span><span class="p">,</span>  <span class="mi">297</span><span class="p">],</span> <span class="p">[</span> <span class="mi">955</span><span class="p">,</span> <span class="mi">1113</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">],</span> <span class="p">[</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1265</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">117</span><span class="p">,</span>  <span class="mi">211</span><span class="p">],</span> <span class="p">[</span> <span class="mi">158</span><span class="p">,</span>  <span class="mi">171</span><span class="p">],</span> <span class="p">[</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1254</span><span class="p">],</span> <span class="p">[</span> <span class="mi">309</span><span class="p">,</span>  <span class="mi">328</span><span class="p">],</span> <span class="p">[</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">1148</span><span class="p">],</span> <span class="p">[</span> <span class="mi">750</span><span class="p">,</span>  <span class="mi">357</span><span class="p">],</span> <span class="p">[</span> <span class="mi">976</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">intersect2d_indices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">ax_list</span><span class="p">,</span> <span class="n">bx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([0, 3, 4]), array([1, 2, 6]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_numpy">
<tt class="descclassname">vtool.other.</tt><tt class="descname">intersect2d_numpy</tt><big>(</big><em>A</em>, <em>B</em>, <em>assume_unique=False</em>, <em>return_indices=False</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#intersect2d_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155">http://stackoverflow.com/questions/8317022/get-intersecting-rows-across-two-2d-numpy-arrays/8317155#8317155</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ndarray[ndims=2]: C</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.other &#8211;test-intersect2d_numpy</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">403</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">535</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">152</span><span class="p">,</span>  <span class="mi">98</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">387</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span> <span class="mi">261</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">403</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span>  <span class="mi">85</span><span class="p">,</span> <span class="mi">815</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">552</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mi">22</span><span class="p">,</span>  <span class="mi">32</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">254</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assume_unique</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[ 85, 403, 412],</span>
<span class="go">       [ 32,  22, 103]]), array([2, 6, 7]), array([0, 1, 2]))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span> <span class="o">=</span> <span class="n">intersect2d_numpy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">Ax</span><span class="p">,</span> <span class="n">Bx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(array([[1, 2, 3]]), array([0]), array([0]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.intersect2d_structured_numpy">
<tt class="descclassname">vtool.other.</tt><tt class="descname">intersect2d_structured_numpy</tt><big>(</big><em>A</em>, <em>B</em>, <em>assume_unique=False</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#intersect2d_structured_numpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.intersect2d_structured_numpy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.iter_reduce_ufunc">
<tt class="descclassname">vtool.other.</tt><tt class="descname">iter_reduce_ufunc</tt><big>(</big><em>ufunc</em>, <em>arr_iter</em>, <em>out=None</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#iter_reduce_ufunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.iter_reduce_ufunc" title="Permalink to this definition">¶</a></dt>
<dd><p>constant memory iteration and reduction</p>
<p>applys ufunc from left to right over the input arrays</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_memory</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arr_list</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">gen_memory</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arr</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">gen_memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;memory = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;gen_memory = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res1</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">arr_list</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res3</span> <span class="o">=</span> <span class="n">iter_reduce_ufunc</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">arr_gen</span><span class="p">(</span><span class="n">arr_list</span><span class="p">,</span> <span class="n">gen_memory</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">memory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;res1       = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;res2       = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;res3       = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;memory     = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;gen_memory = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gen_memory</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res1</span> <span class="o">==</span> <span class="n">res2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">res2</span> <span class="o">==</span> <span class="n">res3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.list_compress_">
<tt class="descclassname">vtool.other.</tt><tt class="descname">list_compress_</tt><big>(</big><em>list_</em>, <em>flag_list</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#list_compress_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.list_compress_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.list_take_">
<tt class="descclassname">vtool.other.</tt><tt class="descname">list_take_</tt><big>(</big><em>list_</em>, <em>index_list</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#list_take_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.list_take_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.mult_lists">
<tt class="descclassname">vtool.other.</tt><tt class="descname">mult_lists</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#mult_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.mult_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.nearest_point">
<tt class="descclassname">vtool.other.</tt><tt class="descname">nearest_point</tt><big>(</big><em>x</em>, <em>y</em>, <em>pts</em>, <em>mode='random'</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#nearest_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.nearest_point" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the nearest point(s) in pts to (x, y)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.or_lists">
<tt class="descclassname">vtool.other.</tt><tt class="descname">or_lists</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#or_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.or_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Like np.logical_and, but can take more than 2 arguments</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>and_lists</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.other.rowwise_operation">
<tt class="descclassname">vtool.other.</tt><tt class="descname">rowwise_operation</tt><big>(</big><em>arr1</em>, <em>arr2</em>, <em>op</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#rowwise_operation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.rowwise_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRICATE THIS IS POSSIBLE WITH STRICTLY BROADCASTING AND
USING np.newaxis</p>
<p>DEPRICATE, numpy has better ways of doing this.
Is the rowwise name correct? Should it be colwise?</p>
<p>performs an operation between an
(N x A x B ... x Z) array with an
(N x 1) array</p>
</dd></dl>

<dl class="function">
<dt id="vtool.other.trytake">
<tt class="descclassname">vtool.other.</tt><tt class="descname">trytake</tt><big>(</big><em>list_</em>, <em>index_list</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#trytake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.trytake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.weighted_average_scoring">
<tt class="descclassname">vtool.other.</tt><tt class="descname">weighted_average_scoring</tt><big>(</big><em>fsv</em>, <em>weight_filtxs</em>, <em>nonweight_filtxs</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#weighted_average_scoring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.weighted_average_scoring" title="Permalink to this definition">¶</a></dt>
<dd><p>does frac{sum_i w^f_i * w^d_i * r_i}{sum_i w^f_i, w^d_i}
to get a weighed average of ratio scores</p>
<p>If we normalize the weight part to add to 1 then we can get per-feature
scores.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Weighted_arithmetic_mean">http://en.wikipedia.org/wiki/Weighted_arithmetic_mean</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.other</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.82992172</span><span class="p">,</span>  <span class="mf">1.56136119</span><span class="p">,</span>  <span class="mf">0.66465378</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8000412</span> <span class="p">,</span>  <span class="mf">2.14719748</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.80848503</span><span class="p">,</span>  <span class="mf">2.6816361</span> <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.86761665</span><span class="p">,</span>  <span class="mf">2.70189977</span><span class="p">,</span>  <span class="mf">1.</span>        <span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.8004055</span> <span class="p">,</span>  <span class="mf">1.58753884</span><span class="p">,</span>  <span class="mf">0.92178345</span><span class="p">],])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonweight_filtxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_fs</span> <span class="o">=</span> <span class="n">weighted_average_scoring</span><span class="p">(</span><span class="n">fsv</span><span class="p">,</span> <span class="n">weight_filtxs</span><span class="p">,</span> <span class="n">nonweight_filtxs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">new_fs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[ 0.08585277  0.17123899  0.21611761  0.23367671  0.11675666]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.other.zipcompress">
<tt class="descclassname">vtool.other.</tt><tt class="descname">zipcompress</tt><big>(</big><em>arr_list</em>, <em>flags_list</em>, <em>axis=None</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#zipcompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.zipcompress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.other.ziptake">
<tt class="descclassname">vtool.other.</tt><tt class="descname">ziptake</tt><big>(</big><em>arr_list</em>, <em>indices_list</em>, <em>axis=None</em><big>)</big><a class="reference internal" href="_modules/vtool/other.html#ziptake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.other.ziptake" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.patch">
<span id="vtool-patch-module"></span><h2>vtool.patch module<a class="headerlink" href="#module-vtool.patch" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.patch.GaussianBlurInplace">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">GaussianBlurInplace</tt><big>(</big><em>img</em>, <em>sigma</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#GaussianBlurInplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.GaussianBlurInplace" title="Permalink to this definition">¶</a></dt>
<dd><p>simulates code from helpers.cpp in hesaff</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-GaussianBlurInplace &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="s">&#39;star2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GaussianBlurInplace</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="ow">not</span> <span class="n">size</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># check if even</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ksize</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_gaussian_patch</span><span class="p">(</span><span class="n">ksize</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_dominant_kp_orientations">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">find_dominant_kp_orientations</tt><big>(</big><em>imgBGR</em>, <em>kp</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#find_dominant_kp_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_dominant_kp_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a>
page 219</p>
<p><a class="reference external" href="http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf">http://www.cs.berkeley.edu/~malik/cs294/lowe-ijcv04.pdf</a>
page 13.</p>
<p>Lowe uses a 36-bin histogram of edge orientations weigted by a gaussian
distance to the center and gradient magintude. He finds all peaks within
80% of the global maximum. Then he fine tunes the orientation using a
3-binned parabolic fit. Multiple orientations (and hence multiple
keypoints) can be returned, but empirically only about 15% will have
these and they do tend to be important.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ori_offset - offset of current orientation to dominant orientation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-find_dominant_kp_orientations</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#imgBGR = get_test_patch(&#39;cross&#39;, jitter=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgBGR</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kp</span> <span class="o">=</span> <span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;kp = </span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">kp_cpp_infostr</span><span class="p">(</span><span class="n">kp</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_oris</span> <span class="o">=</span> <span class="n">find_dominant_kp_orientations</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">,</span> <span class="n">DEBUG_ROTINVAR</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;new_oris = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">new_oris</span><span class="p">,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_kpts_direction">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">find_kpts_direction</tt><big>(</big><em>imgBGR</em>, <em>kpts</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#find_kpts_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_kpts_direction" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imgBGR</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data in opencv format (blue, green, red)</li>
<li><strong>kpts</strong> (<em>ndarray[float32_t, ndim=2]</em>) &#8211; keypoints</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ndarray[float32_t, ndim=2]: kpts -  keypoints</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-find_kpts_direction</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.find_patch_dominant_orientations">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">find_patch_dominant_orientations</tt><big>(</big><em>patch</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#find_patch_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.find_patch_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_average_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">gaussian_average_patch</tt><big>(</big><em>patch</em>, <em>sigma=None</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#gaussian_average_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_average_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-gaussian_average_patch</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_star_patch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_average_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">0.414210641527</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>import utool as ut
import plottool as pt
import vtool as vt
import cv2
gauss_kernel_d0 = (cv2.getGaussianKernel(patch.shape[0], sigma))
gauss_kernel_d1 = (cv2.getGaussianKernel(patch.shape[1], sigma))
weighted_patch = patch.copy()
weighted_patch = np.multiply(weighted_patch,   gauss_kernel_d0)
weighted_patch = np.multiply(weighted_patch.T, gauss_kernel_d1).T
gaussian_kern2 = gauss_kernel_d0.dot(gauss_kernel_d1.T)
fig = pt.figure(fnum=1, pnum=(1, 3, 1), doclf=True, docla=True)
pt.imshow(patch * 255)
fig = pt.figure(fnum=1, pnum=(1, 3, 2))
pt.imshow(ut.norm_zero_one(gaussian_kern2) * 255.0)
fig = pt.figure(fnum=1, pnum=(1, 3, 3))
pt.imshow(ut.norm_zero_one(weighted_patch) * 255.0)
pt.update()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">gaussian_patch</tt><big>(</big><em>shape=(7</em>, <em>7)</em>, <em>sigma=1.0</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>another version of the guassian_patch function. hopefully better</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel">http://docs.opencv.org/modules/imgproc/doc/filtering.html#getgaussiankernel</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>shape</strong> (<em>tuple</em>) &#8211; array dimensions</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-gaussian_patch2</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gausspatch</span> <span class="o">=</span> <span class="n">gaussian_patch</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gausspatch</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">1.0</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>import plottool as pt
pt.imshow(gausspatch * 255)
pt.update()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.gaussian_weight_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">gaussian_weight_patch</tt><big>(</big><em>patch</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#gaussian_weight_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.gaussian_weight_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.get_cross_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_cross_patch</tt><big>(</big><em>jitter=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_cross_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_cross_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_orientation_histogram">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_orientation_histogram</tt><big>(</big><em>gori</em>, <em>gori_weights</em>, <em>bins=36</em>, <em>DEBUG_ROTINVAR=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_orientation_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_orientation_histogram" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(hist, centers)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-get_orientation_histogram</dd>
<dt>Ignore:</dt>
<dd>print(vt.kpts_docrepr(gori, &#8216;gori = &#8216;))
print(vt.kpts_docrepr(gori_weights, &#8216;gori_weights = &#8216;))</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">6.15</span><span class="p">,</span>  <span class="mf">3.13</span><span class="p">,</span>  <span class="mf">3.24</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">4.71</span><span class="p">,</span>  <span class="mf">4.61</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">4.71</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">1.57</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">1.57</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">3.14</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gori_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_orientation_histogram</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gori_weights</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">hist</span><span class="p">,</span> <span class="n">centers</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_star2_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_star2_patch</tt><big>(</big><em>jitter=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_star2_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_star2_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_star_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_star_patch</tt><big>(</big><em>jitter=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_star_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_star_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_stripe_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_stripe_patch</tt><big>(</big><em>jitter=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_stripe_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_stripe_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>test data patch</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_test_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_test_patch</tt><big>(</big><em>key='star'</em>, <em>jitter=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_test_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_test_patch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">patch</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-get_test_patch &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s">&#39;star2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jitter</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch</span> <span class="o">=</span> <span class="n">get_test_patch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jitter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">patch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_unwarped_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_unwarped_patch</tt><big>(</big><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unwarped warped patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) &#8211; keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_unwarped_patches">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_unwarped_patches</tt><big>(</big><em>img</em>, <em>kpts</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_unwarped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_unwarped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cropped unwarped (keypoint is still elliptical) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpts</strong> (<em>ndarrays</em>) &#8211; keypoint ndarrays in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(patches, subkpts) - the unnormalized patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_warped_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_warped_patch</tt><big>(</big><em>imgBGR</em>, <em>kp</em>, <em>gray=False</em>, <em>flags=4L</em>, <em>borderMode=1L</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_warped_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpt</strong> (<em>ndarray</em>) &#8211; keypoint ndarray in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(wpatch, wkp) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.get_warped_patches">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">get_warped_patches</tt><big>(</big><em>img</em>, <em>kpts</em>, <em>flags=4L</em>, <em>borderMode=1L</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#get_warped_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.get_warped_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns warped (into a unit circle) patch around a keypoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>ndarray</em>) &#8211; array representing an image</li>
<li><strong>kpts</strong> (<em>ndarrays</em>) &#8211; keypoint ndarrays in [x, y, a, c, d, theta] format</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(warped_patches, warped_subkpts) the normalized 41x41 patches from the img corresonding to the keypoint</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.intern_warp_single_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">intern_warp_single_patch</tt><big>(</big><em>img</em>, <em>x</em>, <em>y</em>, <em>ori</em>, <em>V</em>, <em>patchSize</em>, <em>flags=2L</em>, <em>borderMode=1L</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#intern_warp_single_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.intern_warp_single_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.make_test_image_keypoints">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">make_test_image_keypoints</tt><big>(</big><em>imgBGR</em>, <em>scale=1.0</em>, <em>skew=0</em>, <em>theta=0</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#make_test_image_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.make_test_image_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_gradient">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">patch_gradient</tt><big>(</big><em>patch</em>, <em>ksize=1</em>, <em>gaussian_weighted=False</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#patch_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_mag">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">patch_mag</tt><big>(</big><em>gradx</em>, <em>grady</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#patch_mag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_mag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.patch_ori">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">patch_ori</tt><big>(</big><em>gradx</em>, <em>grady</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#patch_ori"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.patch_ori" title="Permalink to this definition">¶</a></dt>
<dd><p>returns patch orientation relative to the x-axis</p>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.show_gaussian_patch">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">show_gaussian_patch</tt><big>(</big><em>shape</em>, <em>sigma1</em>, <em>sigma2</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#show_gaussian_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.show_gaussian_patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.show_patch_orientation_estimation">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">show_patch_orientation_estimation</tt><big>(</big><em>imgBGR</em>, <em>kpts</em>, <em>patch</em>, <em>gradx</em>, <em>grady</em>, <em>gmag</em>, <em>gori</em>, <em>hist</em>, <em>centers</em>, <em>gori_weights</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#show_patch_orientation_estimation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.show_patch_orientation_estimation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.patch.test_find_kp_direction">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">test_find_kp_direction</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#test_find_kp_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_find_kp_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows steps in orientation estimation</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-test_find_kp_direction &#8211;show
python -m vtool.patch &#8211;test-test_find_kp_direction &#8211;show &#8211;interact</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_find_kp_direction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">test_ondisk_find_patch_fpath_dominant_orientations</tt><big>(</big><em>patch_fpath</em>, <em>bins=36</em>, <em>maxima_thresh=0.8</em>, <em>DEBUG_ROTINVAR=True</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#test_ondisk_find_patch_fpath_dominant_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_ondisk_find_patch_fpath_dominant_orientations" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-test_ondisk_find_patch_fpath_dominant_orientations</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--patch-fpath&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;star.png&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxima_thresh</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_ondisk_find_patch_fpath_dominant_orientations</span><span class="p">(</span><span class="n">patch_fpath</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">maxima_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_show_gaussian_patches">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">test_show_gaussian_patches</tt><big>(</big><em>shape=(19</em>, <em>19)</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-test_show_gaussian_patches &#8211;show
python -m vtool.patch &#8211;test-test_show_gaussian_patches &#8211;show &#8211;shape=7,7
python -m vtool.patch &#8211;test-test_show_gaussian_patches &#8211;show &#8211;shape=17,17
python -m vtool.patch &#8211;test-test_show_gaussian_patches &#8211;show &#8211;shape=41,41
python -m vtool.patch &#8211;test-test_show_gaussian_patches &#8211;show &#8211;shape=41,7</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.patch.test_show_gaussian_patches2">
<tt class="descclassname">vtool.patch.</tt><tt class="descname">test_show_gaussian_patches2</tt><big>(</big><em>shape=(19</em>, <em>19)</em><big>)</big><a class="reference internal" href="_modules/vtool/patch.html#test_show_gaussian_patches2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.patch.test_show_gaussian_patches2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.patch &#8211;test-test_show_gaussian_patches2 &#8211;show
python -m vtool.patch &#8211;test-test_show_gaussian_patches2 &#8211;show &#8211;shape=7,7
python -m vtool.patch &#8211;test-test_show_gaussian_patches2 &#8211;show &#8211;shape=19,19
python -m vtool.patch &#8211;test-test_show_gaussian_patches2 &#8211;show &#8211;shape=41,41
python -m vtool.patch &#8211;test-test_show_gaussian_patches2 &#8211;show &#8211;shape=41,7</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://matplotlib.org/examples/mplot3d/surface3d_demo.html">http://matplotlib.org/examples/mplot3d/surface3d_demo.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.patch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s">&#39;--shape&#39;</span><span class="p">,),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_show_gaussian_patches2</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-vtool.quality_classifier">
<span id="vtool-quality-classifier-module"></span><h2>vtool.quality_classifier module<a class="headerlink" href="#module-vtool.quality_classifier" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.quality_classifier.compute_average_contrast">
<tt class="descclassname">vtool.quality_classifier.</tt><tt class="descname">compute_average_contrast</tt><big>(</big><em>img</em><big>)</big><a class="reference internal" href="_modules/vtool/quality_classifier.html#compute_average_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.compute_average_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">average_contrast</span> <span class="o">=</span> <span class="n">compute_average_contrast</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">average_contrast</span><span class="p">,</span> <span class="o">.</span><span class="mo">0075</span><span class="p">,</span> <span class="o">.</span><span class="mo">00</span><span class="mi">85</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.fourier_devtest">
<tt class="descclassname">vtool.quality_classifier.</tt><tt class="descname">fourier_devtest</tt><big>(</big><em>img</em><big>)</big><a class="reference internal" href="_modules/vtool/quality_classifier.html#fourier_devtest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.fourier_devtest" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.quality_classifier &#8211;test-fourier_devtest &#8211;show</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html">http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_transforms/py_fourier_transform/py_fourier_transform.html</a>
<a class="reference external" href="http://cns-alumni.bu.edu/~slehar/fourier/fourier.html">http://cns-alumni.bu.edu/~slehar/fourier/fourier.html</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.quality_classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;lena.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">,</span> <span class="n">grayscale</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magnitude_spectrum</span> <span class="o">=</span> <span class="n">fourier_devtest</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.quality_classifier.test_average_contrast">
<tt class="descclassname">vtool.quality_classifier.</tt><tt class="descname">test_average_contrast</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/quality_classifier.html#test_average_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.quality_classifier.test_average_contrast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.segmentation">
<span id="vtool-segmentation-module"></span><h2>vtool.segmentation module<a class="headerlink" href="#module-vtool.segmentation" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.segmentation.clean_mask">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">clean_mask</tt><big>(</big><em>mask</em>, <em>num_dilate=3</em>, <em>num_erode=3</em>, <em>window_frac=0.025</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#clean_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.clean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the mask
(num_erode, num_dilate) = (1, 1)
(w, h) = (10, 10)</p>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.demo_grabcut">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">demo_grabcut</tt><big>(</big><em>bgr_img</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#demo_grabcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.demo_grabcut" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>ndarray[uint8_t, ndim=2]</em>) &#8211; image data</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.segmentation &#8211;test-demo_grabcut &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.segmentation</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s">&#39;easy1.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bgr_img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_grabcut</span><span class="p">(</span><span class="n">bgr_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.fill_holes">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">fill_holes</tt><big>(</big><em>mask</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#fill_holes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.fill_holes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.grabcut">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">grabcut</tt><big>(</big><em>bgr_img</em>, <em>prior_mask</em>, <em>binary=True</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.grabcut" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Referencs:</dt>
<dd><a class="reference external" href="http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html">http://docs.opencv.org/trunk/doc/py_tutorials/py_imgproc/py_grabcut/py_grabcut.html</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.segmentation.grabcut2">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">grabcut2</tt><big>(</big><em>rgb_chip</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#grabcut2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.grabcut2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.mask_colored_img">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">mask_colored_img</tt><big>(</big><em>img_rgb</em>, <em>mask</em>, <em>encoding='bgr'</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#mask_colored_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.mask_colored_img" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.printDBG">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">printDBG</tt><big>(</big><em>msg</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#printDBG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.printDBG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.resize_img_and_bbox">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">resize_img_and_bbox</tt><big>(</big><em>img_fpath</em>, <em>bbox_</em>, <em>new_size=None</em>, <em>sqrt_area=400.0</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#resize_img_and_bbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.resize_img_and_bbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.segmentation.segment">
<tt class="descclassname">vtool.segmentation.</tt><tt class="descname">segment</tt><big>(</big><em>img_fpath</em>, <em>bbox_</em>, <em>new_size=None</em><big>)</big><a class="reference internal" href="_modules/vtool/segmentation.html#segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.segmentation.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs grabcut</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.spatial_verification">
<span id="vtool-spatial-verification-module"></span><h2>vtool.spatial_verification module<a class="headerlink" href="#module-vtool.spatial_verification" title="Permalink to this headline">¶</a></h2>
<p>Spatial verification of keypoint matches</p>
<dl class="docutils">
<dt>Notation::</dt>
<dd>1_m = img1_matches; 2_m = img2_matches
x and y are locations, invV is the elliptical shapes.
fx are the original feature indexes (used for making sure 1 keypoint isn&#8217;t assigned to 2)</dd>
<dt>Look Into::</dt>
<dd>Standard
skimage.transform
<a class="reference external" href="http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy">http://stackoverflow.com/questions/11462781/fast-2d-rigid-body-transformations-in-numpy-scipy</a>
skimage.transform.fast_homography(im, H)</dd>
</dl>
<dl class="function">
<dt id="vtool.spatial_verification.build_affine_lstsqrs_Mx6">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">build_affine_lstsqrs_Mx6</tt><big>(</big><em>xy1_mn</em>, <em>xy2_mn</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_affine_lstsqrs_Mx6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.build_affine_lstsqrs_Mx6" title="Permalink to this definition">¶</a></dt>
<dd><p>CURRENTLY NOT WORKING</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx6</span> <span class="o">=</span> <span class="n">build_affine_lstsqrs_Mx6</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">Mx6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore;</dt>
<dd>(U, S, V) = npl.svd(Mx6, full_matrices=True, compute_uv=True)
a = V[-6]  # Hack for Cython.wraparound(False)
a.reshape(2, 3)
A = np.vstack((a[0:3], a[3:6], (0, 0, 1)))</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.build_lstsqrs_Mx9">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">build_lstsqrs_Mx9</tt><big>(</big><em>xy1_mn</em>, <em>xy2_mn</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#build_lstsqrs_Mx9"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.build_lstsqrs_Mx9" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the M x 9 least squares matrix</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification &#8211;test-build_lstsqrs_Mx9</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mx9</span> <span class="o">=</span> <span class="n">build_lstsqrs_Mx9</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">Mx9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">Mx9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">f@2l62+2!ppow8yw</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><a class="reference external" href="http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findhomography">http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findhomography</a>
cv2.findHomography(xy1_mn.T, xy2_mn.T)
cv2.findHomography(xy1_mn.T, xy1_mn.T)</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf">http://dip.sun.ac.za/~stefan/TW793/attach/notes/homography_estimation.pdf</a>
<a class="reference external" href="http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf">http://szeliski.org/Book/drafts/SzeliskiBook_20100903_draft.pdf</a> Page 317
<a class="reference external" href="http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf">http://vision.ece.ucsb.edu/~zuliani/Research/RANSAC/docs/RANSAC4Dummies.pdf</a> page 53</p>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#CYTH_RETURNS np.ndarray[np.float64_t, ndim=2]
#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] xy1_mn
np.ndarray[np.float64_t, ndim=2] xy2_mn
np.ndarray[np.float64_t, ndim=1] x1_mn, y1_mn,  x2_mn, y2_mn
np.ndarray[np.float64_t, ndim=2] Mx9</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>Py_ssize_t num_pts
Py_ssize_t ix</dd>
</dl>
<p class="last">#endif</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.compute_affine">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">compute_affine</tt><big>(</big><em>xy1_mn</em>, <em>xy2_mn</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.compute_affine" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ndarray[shape=(3,3)]: A - affine matrix</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification &#8211;test-compute_affine</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_affine</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy1_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.compute_homog">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">compute_homog</tt><big>(</big><em>xy1_mn</em>, <em>xy2_mn</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#compute_homog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.compute_homog" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 6 degrees of freedom homography transformation
Computes homography from normalized (0 to 1) point correspondences
from 2 &#8211;&gt; 1
(database-&gt;query)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xy1_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; xy points in image1</li>
<li><strong>xy2_mn</strong> (<em>ndarray[ndim=2]</em>) &#8211; corresponding xy points in image 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ndarray[shape=(3,3)]: H - homography matrix</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy1_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy2_mn</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_xys</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">compute_homog</span><span class="p">(</span><span class="n">xy1_mn</span><span class="p">,</span> <span class="n">xy2_mn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = ut.hashstr(H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[  1.83e-03   2.85e-03  -7.11e-01]</span>
<span class="go"> [  2.82e-03   1.80e-03  -7.03e-01]</span>
<span class="go"> [  1.67e-05   1.68e-05  -5.53e-03]]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#CYTH_RETURNS np.ndarray[np.float64_t, ndim=2]
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] xy1_mn
np.ndarray[np.float64_t, ndim=2] xy2_mn</div></blockquote>
<p>#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] Mx9</div></blockquote>
<p class="last">#endif</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_affine_inliers">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">get_affine_inliers</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates inliers deterministically using elliptical shapes</p>
<p>Compute all transforms from kpts1 to kpts2 (enumerate all hypothesis)
We transform from chip1 -&gt; chip2
The determinants are squared keypoint scales</p>
<dl class="docutils">
<dt>FROM PERDOCH 2009::</dt>
<dd>H = inv(Aj).dot(Rj.T).dot(Ri).dot(Ai)
H = inv(Aj).dot(Ai)
The input invVs = perdoch.invA&#8217;s</dd>
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification &#8211;test-get_affine_inliers</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="o">.</span><span class="mo">00</span><span class="mi">9</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh_sqrd</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="n">ktool</span><span class="o">.</span><span class="n">KPTS_DTYPE</span><span class="p">(</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">get_affine_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">,</span> <span class="n">scale_thresh_sqrd</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">89kz8nh6p+66t!+u</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Cyth:</dt>
<dd><p class="first">#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] kpts1
np.ndarray[np.float64_t, ndim=2] kpts2
np.ndarray[np.int32_t, ndim=2] fm
np.float64_t xy_thresh_sqrd
np.float64_t scale_thresh_sqrd
np.float64_t ori_thresh</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>np.ndarray[np.float64_t, ndim=2] kpts1_m
np.ndarray[np.float64_t, ndim=2] kpts2_m
np.ndarray[np.float64_t, ndim=3] invVR1s_m
np.ndarray[np.float64_t, ndim=3] V1s_m
np.ndarray[np.float64_t, ndim=3] invVR2s_m
np.ndarray[np.float64_t, ndim=3] Aff_mats
np.ndarray[np.float64_t, ndim=2] xy2_m
np.ndarray[np.float64_t, ndim=1] det2_m
np.ndarray[np.float64_t, ndim=1] ori2_m
np.ndarray[np.float64_t, ndim=2] Aff
tuple tup
list inliers_and_errors_list
list errors_list</dd>
</dl>
<p class="last">#endif</p>
</dd>
<dt>Ignore::</dt>
<dd><p class="first">from vtool.spatial_verification import *  # NOQA
import vtool.tests.dummy as dummy
import vtool.keypoint as ktool
kpts1, kpts2 = dummy.get_dummy_kpts_pair((100, 100))
a = kpts1[fm.T[0]]
b = kpts1.take(fm.T[0])</p>
<p>align = fm.dtype.itemsize * fm.shape[1]
align2 = [fm.dtype.itemsize, fm.dtype.itemsize]
viewtype1 = np.dtype(np.void, align)
viewtype2 = np.dtype(np.int32, align2)
c = np.ascontiguousarray(fm).view(viewtype1)
fm_view = np.ascontiguousarray(fm).view(viewtype1)
qfx = fm.view(np.dtype(np.int32 np.int32.itemsize))
dfx = fm.view(np.dtype(np.int32, np.int32.itemsize))
d = np.ascontiguousarray(c).view(viewtype2)</p>
<p class="last">fm.view(np.dtype(np.void, align))
np.ascontiguousarray(fm).view(np.dtype((np.void, Z.dtype.itemsize * Z.shape[1])))</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_best_affine_inliers">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">get_best_affine_inliers</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh</em>, <em>ori_thresh</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_best_affine_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_best_affine_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests each hypothesis and returns only the best transformation and inliers</p>
<p>#if CYTH
#CYTH_PARAM_TYPES:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=2] kpts1
np.ndarray[np.float64_t, ndim=2] kpts2
np.ndarray[np.int32_t, ndim=2] fm
np.float64_t xy_thresh_sqrd
np.float64_t scale_thresh_sqrd
np.float64_t ori_thresh</div></blockquote>
<dl class="docutils">
<dt>cdef:</dt>
<dd>list aff_inliers_list
list aff_inliers
list Aff_mats
list aff_errors_list</dd>
</dl>
<p>#endif</p>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.get_homography_inliers">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">get_homography_inliers</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>aff_inliers</em>, <em>xy_thresh_sqrd</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#get_homography_inliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.get_homography_inliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of hypothesis inliers, computes a homography and refines inliers
returned homography maps image1 space into image2 space</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification &#8211;test-get_homography_inliers</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.keypoint</span> <span class="kn">as</span> <span class="nn">ktool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_kpts_pair</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">make_dummy_fm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh_sqrd</span> <span class="o">=</span> <span class="o">.</span><span class="mo">01</span> <span class="o">*</span> <span class="n">ktool</span><span class="o">.</span><span class="n">get_kpts_dlen_sqrd</span><span class="p">(</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homogtup</span> <span class="o">=</span> <span class="n">get_homography_inliers</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_inliers</span><span class="p">,</span> <span class="n">xy_thresh_sqrd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_inliers</span><span class="p">,</span> <span class="n">homog_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">homogtup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">homogtup</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">    np.array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=np.int32),</span>
<span class="go">    (np.array([   4.365,    5.284,    3.294,   13.049,  114.46 ,   48.971,</span>
<span class="go">                17.655,   25.825,    3.819], dtype=np.float64), None, None),</span>
<span class="go">    np.array([[  9.178e-01,  -4.824e-02,   7.212e+00],</span>
<span class="go">              [ -6.856e-03,   9.088e-01,   4.131e+00],</span>
<span class="go">              [ -1.213e-04,  -3.454e-04,   1.000e+00]], dtype=np.float64),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.spatially_verify_kpts">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">spatially_verify_kpts</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh=0.01</em>, <em>scale_thresh=2.0</em>, <em>ori_thresh=1.5707963267948966</em>, <em>dlen_sqrd2=None</em>, <em>min_nInliers=4</em>, <em>returnAff=False</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#spatially_verify_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.spatially_verify_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver function
Spatially validates feature matches</p>
<p>Returned homography maps image1 space into image2 space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kpts1</strong> (<em>ndarray[ndim=2]</em>) &#8211; all keypoints in image 1</li>
<li><strong>kpts2</strong> (<em>ndarray[ndim=2]</em>) &#8211; all keypoints in image 2</li>
<li><strong>fm</strong> (<em>ndarray[ndim=2]</em>) &#8211; matching keypoint indexes [..., (kp1x, kp2x), ...]</li>
<li><strong>xy_thresh</strong> (<em>float</em>) &#8211; spatial distance threshold under affine transform to be considered a match</li>
<li><strong>dlen_sqrd2</strong> (<em>float</em>) &#8211; diagonal length squared of image/chip 2</li>
<li><strong>min_nInliers</strong> (<em>int</em>) &#8211; default=4</li>
<li><strong>returnAff</strong> (<em>bool</em>) &#8211; returns best affine hypothesis as well</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(homog_inliers, homog_errors, H, aff_inliers, aff_errors, Aff) if success else None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.spatial_verification &#8211;test-spatially_verify_kpts &#8211;show
python -m vtool.spatial_verification &#8211;test-spatially_verify_kpts</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.spatial_verification</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool.tests.dummy</span> <span class="kn">as</span> <span class="nn">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">)</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">testdata_ratio_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy_thresh</span> <span class="o">=</span> <span class="o">.</span><span class="mo">01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dlen_sqrd2</span> <span class="o">=</span> <span class="mf">447271.015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_nInliers</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returnAff</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ori_thresh</span> <span class="o">=</span> <span class="mf">1.57</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_thresh</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">spatially_verify_kpts</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">xy_thresh</span><span class="p">,</span> <span class="n">scale_thresh</span><span class="p">,</span> <span class="n">ori_thresh</span><span class="p">,</span> <span class="n">dlen_sqrd2</span><span class="p">,</span> <span class="n">min_nInliers</span><span class="p">,</span> <span class="n">returnAff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;sver failed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_inliers</span><span class="p">,</span> <span class="n">homog_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_was_requested</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">homog_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span> <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">svtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#result = ut.list_str(svtup, precision=3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">tuple(numpy.ndarray, tuple(numpy.ndarray, NoneType, NoneType), numpy.ndarray, numpy.ndarray, tuple(numpy.ndarray*3), numpy.ndarray)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.spatial_verification.try_svd">
<tt class="descclassname">vtool.spatial_verification.</tt><tt class="descname">try_svd</tt><big>(</big><em>M</em><big>)</big><a class="reference internal" href="_modules/vtool/spatial_verification.html#try_svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.spatial_verification.try_svd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtool.sver_c_wrapper">
<span id="vtool-sver-c-wrapper-module"></span><h2>vtool.sver_c_wrapper module<a class="headerlink" href="#module-vtool.sver_c_wrapper" title="Permalink to this headline">¶</a></h2>
<p>wraps c implementations slower parts of spatial verification</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.sver_c_wrapper &#8211;rebuild-sver
python -m vtool.sver_c_wrapper &#8211;rebuild-sver &#8211;allexamples
python -m vtool.sver_c_wrapper &#8211;allexamples</dd>
</dl>
<dl class="function">
<dt id="vtool.sver_c_wrapper.assert_output_equal">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">assert_output_equal</tt><big>(</big><em>output1</em>, <em>output2</em>, <em>thresh=1e-08</em>, <em>nestpath=None</em>, <em>level=0</em>, <em>lbl1=''</em>, <em>lbl2=''</em><big>)</big><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#assert_output_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.assert_output_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>recursive equality checks</p>
</dd></dl>

<dl class="attribute">
<dt id="vtool.sver_c_wrapper.c_double_p">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">c_double_p</tt><a class="headerlink" href="#vtool.sver_c_wrapper.c_double_p" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <tt class="xref py py-class docutils literal"><span class="pre">LP_c_double</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.call_hello">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">call_hello</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#call_hello"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.call_hello" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.compare_implementations">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">compare_implementations</tt><big>(</big><em>func1</em>, <em>func2</em>, <em>args</em>, <em>show_output=False</em>, <em>lbl1=''</em>, <em>lbl2=''</em><big>)</big><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#compare_implementations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.compare_implementations" title="Permalink to this definition">¶</a></dt>
<dd><p>tests two different implementations of the same function</p>
</dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.errs_t">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">errs_t</tt><big>(</big><em>ndim</em><big>)</big><a class="headerlink" href="#vtool.sver_c_wrapper.errs_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.get_affine_inliers_cpp">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">get_affine_inliers_cpp</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><big>)</big><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#get_affine_inliers_cpp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.get_affine_inliers_cpp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.get_best_affine_inliers_cpp">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">get_best_affine_inliers_cpp</tt><big>(</big><em>kpts1</em>, <em>kpts2</em>, <em>fm</em>, <em>xy_thresh_sqrd</em>, <em>scale_thresh_sqrd</em>, <em>ori_thresh</em><big>)</big><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#get_best_affine_inliers_cpp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.get_best_affine_inliers_cpp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.inliers_t">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">inliers_t</tt><big>(</big><em>ndim</em><big>)</big><a class="headerlink" href="#vtool.sver_c_wrapper.inliers_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.mats_t">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">mats_t</tt><big>(</big><em>ndim</em><big>)</big><a class="headerlink" href="#vtool.sver_c_wrapper.mats_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.sver_c_wrapper.test_calling">
<tt class="descclassname">vtool.sver_c_wrapper.</tt><tt class="descname">test_calling</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/sver_c_wrapper.html#test_calling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.sver_c_wrapper.test_calling" title="Permalink to this definition">¶</a></dt>
<dd><p>Test to ensure cpp and python agree and that cpp is faster</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.sver_c_wrapper &#8211;test-test_calling
python -m vtool.sver_c_wrapper &#8211;test-test_calling &#8211;rebuild-sver
python -m vtool.sver_c_wrapper &#8211;test-test_calling &#8211;show
python -m vtool.sver_c_wrapper &#8211;test-test_calling &#8211;show &#8211;dummy
python -m vtool.sver_c_wrapper &#8211;test-test_calling &#8211;show &#8211;fname1=easy1.png &#8211;fname2=easy2.png
python -m vtool.sver_c_wrapper &#8211;test-test_calling &#8211;show &#8211;fname1=easy1.png &#8211;fname2=hard3.png
python -m vtool.sver_c_wrapper &#8211;test-test_calling &#8211;show &#8211;fname1=carl.jpg &#8211;fname2=hard3.png</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.sver_c_wrapper</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_calling</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>%timeit call_python_version(<a href="#id1"><span class="problematic" id="id2">*</span></a>args)
%timeit get_affine_inliers_cpp(<a href="#id3"><span class="problematic" id="id4">*</span></a>args)</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtool.test_constrained_matching">
<span id="vtool-test-constrained-matching-module"></span><h2>vtool.test_constrained_matching module<a class="headerlink" href="#module-vtool.test_constrained_matching" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="vtool.test_constrained_matching.SimpleMatcher">
<em class="property">class </em><tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">SimpleMatcher</tt><big>(</big><em>simp</em>, <em>testtup</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.load_data">
<tt class="descname">load_data</tt><big>(</big><em>simp</em>, <em>testtup</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.load_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.run_matching">
<tt class="descname">run_matching</tt><big>(</big><em>simp</em>, <em>testtup=None</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.run_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.run_matching" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.setstate_testdata">
<tt class="descname">setstate_testdata</tt><big>(</big><em>simp</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.setstate_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.setstate_testdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.start_new_viz">
<tt class="descname">start_new_viz</tt><big>(</big><em>simp</em>, <em>nRows</em>, <em>nCols</em>, <em>fnum=None</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.start_new_viz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.start_new_viz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize">
<tt class="descname">visualize</tt><big>(</big><em>simp</em>, <em>key</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize_coverage">
<tt class="descname">visualize_coverage</tt><big>(</big><em>simp</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize_coverage" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.test_constrained_matching &#8211;test-visualize_coverage &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span> <span class="o">=</span> <span class="n">SimpleMatcher</span><span class="p">(</span><span class="n">testdata_matcher</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span><span class="o">.</span><span class="n">run_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simp</span><span class="o">.</span><span class="n">visualize_coverage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize_matches">
<tt class="descname">visualize_matches</tt><big>(</big><em>simp</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize_matches" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.test_constrained_matching &#8211;test-visualize_matches &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span> <span class="o">=</span> <span class="n">SimpleMatcher</span><span class="p">(</span><span class="n">testdata_matcher</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span><span class="o">.</span><span class="n">run_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simp</span><span class="o">.</span><span class="n">visualize_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vtool.test_constrained_matching.SimpleMatcher.visualize_normalizers">
<tt class="descname">visualize_normalizers</tt><big>(</big><em>simp</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#SimpleMatcher.visualize_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.SimpleMatcher.visualize_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.test_constrained_matching &#8211;test-visualize_normalizers &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span> <span class="o">=</span> <span class="n">SimpleMatcher</span><span class="p">(</span><span class="n">testdata_matcher</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simp</span><span class="o">.</span><span class="n">run_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simp</span><span class="o">.</span><span class="n">visualize_normalizers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.make_custom_interactions">
<tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">make_custom_interactions</tt><big>(</big><em>simp_list</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#make_custom_interactions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.make_custom_interactions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.on_single_match_clicked">
<tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">on_single_match_clicked</tt><big>(</big><em>event</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#on_single_match_clicked"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.on_single_match_clicked" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.param_interaction">
<tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">param_interaction</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#param_interaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.param_interaction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.test_constrained_matching &#8211;test-param_interaction</dd>
</dl>
<p class="rubric">Notes</p>
<p>python -m vtool.test_constrained_matching &#8211;test-param_interaction
setparam normalizer_mode=nearby
setparam normalizer_mode=far
setparam ratio_thresh=.625
setparam ratio_thresh=.5</p>
<p>setparam ratio_thresh2=.625
normalizer_mode=plus</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testtup</span> <span class="o">=</span> <span class="n">param_interaction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">testtup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.show_example">
<tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">show_example</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#show_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.show_example" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m vtool.test_constrained_matching &#8211;test-show_example &#8211;show</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtool.test_constrained_matching</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.show_matches">
<tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">show_matches</tt><big>(</big><em>fm</em>, <em>fs</em>, <em>fnum=1</em>, <em>pnum=None</em>, <em>title=''</em>, <em>key=None</em>, <em>simp=None</em>, <em>cmap='hot'</em>, <em>draw_lines=True</em>, <em>**locals_</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#show_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.show_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="vtool.test_constrained_matching.testdata_matcher">
<tt class="descclassname">vtool.test_constrained_matching.</tt><tt class="descname">testdata_matcher</tt><big>(</big><em>fname1='easy1.png'</em>, <em>fname2='easy2.png'</em><big>)</big><a class="reference internal" href="_modules/vtool/test_constrained_matching.html#testdata_matcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.test_constrained_matching.testdata_matcher" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8221;
fname1 = &#8216;easy1.png&#8217;
fname2 = &#8216;hard3.png&#8217;</p>
<p>python -m vtool.test_constrained_matching &#8211;test-visualize_matches &#8211;show</p>
</dd></dl>

</div>
<div class="section" id="module-vtool.trig">
<span id="vtool-trig-module"></span><h2>vtool.trig module<a class="headerlink" href="#module-vtool.trig" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="vtool.trig.atan2">
<tt class="descclassname">vtool.trig.</tt><tt class="descname">atan2</tt><big>(</big><em>y</em>, <em>x</em><big>)</big><a class="reference internal" href="_modules/vtool/trig.html#atan2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.trig.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>does atan2 but returns from 0 to TAU
&gt;&gt;&gt; from vtool.trig import *  # NOQA
&gt;&gt;&gt; import utool
&gt;&gt;&gt; np.random.seed(0)
&gt;&gt;&gt; y = np.random.rand(1000).astype(np.float64)
&gt;&gt;&gt; x = np.random.rand(1000).astype(np.float64)
&gt;&gt;&gt; theta = atan2(y, x)
&gt;&gt;&gt; assert np.all(theta &gt;= 0)
&gt;&gt;&gt; assert np.all(theta &lt; 2 * np.pi)
&gt;&gt;&gt; print(utool.hashstr(theta))
go!su97%eo4qoyq7</p>
<p>#CYTH_INLINE
#if CYTH
cdef:</p>
<blockquote>
<div>np.ndarray[np.float64_t, ndim=1] y
np.ndarray[np.float64_t, ndim=1] x
np.ndarray[np.float64_t, ndim=1] theta</div></blockquote>
<p>#endif</p>
</dd></dl>

</div>
<div class="section" id="module-vtool">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtool" title="Permalink to this headline">¶</a></h2>
<p>VTool - Computer vision tools</p>
<dl class="function">
<dt id="vtool.reassign_submodule_attributes">
<tt class="descclassname">vtool.</tt><tt class="descname">reassign_submodule_attributes</tt><big>(</big><em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/vtool.html#reassign_submodule_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.reassign_submodule_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>why reloading all the modules doesnt do this I don&#8217;t know</p>
</dd></dl>

<dl class="function">
<dt id="vtool.reload_subs">
<tt class="descclassname">vtool.</tt><tt class="descname">reload_subs</tt><big>(</big><em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/vtool.html#reload_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vtool.reload_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads vtool and submodules</p>
</dd></dl>

<dl class="function">
<dt id="vtool.rrrr">
<tt class="descclassname">vtool.</tt><tt class="descname">rrrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#vtool.rrrr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads vtool and submodules</p>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vtool.tests.html" class="btn btn-neutral float-right" title="vtool.tests package"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to vtool’s documentation!"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jon Crall.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0.dev1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>